{
  "evalId": "eval-4az-2025-12-31T18:31:50",
  "results": {
    "version": 3,
    "timestamp": "2025-12-31T18:31:50.375Z",
    "prompts": [
      {
        "raw": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]",
        "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]",
        "id": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "provider": "GPT-OSS-20B (Primary)",
        "metrics": {
          "score": 5,
          "testPassCount": 5,
          "testFailCount": 3,
          "testErrorCount": 0,
          "assertPassCount": 10,
          "assertFailCount": 7,
          "totalLatencyMs": 11736,
          "tokenUsage": {
            "prompt": 7759,
            "completion": 8829,
            "cached": 0,
            "total": 16588,
            "numRequests": 8,
            "completionDetails": {
              "reasoning": 6923,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 0,
              "prompt": 0,
              "completion": 0,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0
        }
      },
      {
        "raw": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]",
        "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]",
        "id": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "provider": "GPT-OSS-120B (Larger)",
        "metrics": {
          "score": 7,
          "testPassCount": 7,
          "testFailCount": 1,
          "testErrorCount": 0,
          "assertPassCount": 15,
          "assertFailCount": 2,
          "totalLatencyMs": 15573,
          "tokenUsage": {
            "prompt": 7759,
            "completion": 5644,
            "cached": 0,
            "total": 13403,
            "numRequests": 8,
            "completionDetails": {
              "reasoning": 3707,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 0,
              "prompt": 0,
              "completion": 0,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0
        }
      },
      {
        "raw": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]",
        "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]",
        "id": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "provider": "Llama-3.3-70B (Fallback)",
        "metrics": {
          "score": 7,
          "testPassCount": 6,
          "testFailCount": 2,
          "testErrorCount": 0,
          "assertPassCount": 15,
          "assertFailCount": 2,
          "totalLatencyMs": 9740,
          "tokenUsage": {
            "prompt": 7501,
            "completion": 2284,
            "cached": 0,
            "total": 9785,
            "numRequests": 8,
            "completionDetails": {
              "reasoning": 0,
              "acceptedPrediction": 0,
              "rejectedPrediction": 0
            },
            "assertions": {
              "total": 0,
              "prompt": 0,
              "completion": 0,
              "cached": 0,
              "numRequests": 0,
              "completionDetails": {
                "reasoning": 0,
                "acceptedPrediction": 0,
                "rejectedPrediction": 0
              }
            }
          },
          "namedScores": {},
          "namedScoresCount": {},
          "cost": 0
        }
      }
    ],
    "results": [
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected non-whitespace character after JSON at position 805 (line 13 column 1)\nStack Trace: SyntaxError: Unexpected non-whitespace character after JSON at position 805 (line 13 column 1)\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:32)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:198)\n    at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('cycle') || h.includes('slow') || h.includes('135') || h.includes('time') || h.includes('ai'); })()",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "Custom function threw error: Unexpected non-whitespace character after JSON at position 805 (line 13 column 1)\nStack Trace: SyntaxError: Unexpected non-whitespace character after JSON at position 805 (line 13 column 1)\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:32)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:198)\n    at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('cycle') || h.includes('slow') || h.includes('135') || h.includes('time') || h.includes('ai'); })()",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Expected output to be valid JSON",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected non-whitespace character after JSON at position 805 (line 13 column 1)\nStack Trace: SyntaxError: Unexpected non-whitespace character after JSON at position 805 (line 13 column 1)\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:32)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:122)\n    at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n(() => { const r = JSON.parse(output); return !!(r.headline && r.detail && r.recommendation && r.metric_cards); })()",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); return !!(r.headline && r.detail && r.recommendation && r.metric_cards); })()",
                "description": "Has all required fields"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected non-whitespace character after JSON at position 805 (line 13 column 1)\nStack Trace: SyntaxError: Unexpected non-whitespace character after JSON at position 805 (line 13 column 1)\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:32)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:198)\n    at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('cycle') || h.includes('slow') || h.includes('135') || h.includes('time') || h.includes('ai'); })()",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('cycle') || h.includes('slow') || h.includes('135') || h.includes('time') || h.includes('ai'); })()",
                "description": "Headline mentions cycle time, slowdown, or AI impact"
              }
            }
          ]
        },
        "id": "10418b3d-dde5-4238-8ae9-e93e10c03170",
        "latencyMs": 1746,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Antiwork\\n\\n## Period: 2025-11-24 to 2025-12-24 (30 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 123 PRs merged\\n- Previous period: 98 PRs merged\\n- Change: 25.5%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 169.4 hours\\n- Previous period: 71.8 hours\\n- Change: 135.8% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 72.5 hours\\n- Previous period: 22.2 hours\\n- Change: 226.5% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 1 (0.8% of merged PRs)\\n- Hotfixes: 0 (0.0% of merged PRs)\\n- Average review rounds: 0.8\\n- Large PRs (>500 lines): 17.9%\\n\\n## Team Health\\n\\n- Active contributors: 25\\n- Top contributor share: 17.1% of PRs\\n- Work concentration: Healthy distribution\\n- Avg reviews per reviewer: 19.9\\n- Max reviews by single reviewer: 72\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 42 (34.1% adoption)\\n- Non-AI PRs: 81\\n- AI PR avg cycle time: 214.6 hours\\n- Non-AI PR avg cycle time: 145.9 hours\\n- AI HURTS: AI PRs are 47.1% SLOWER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 0,
        "provider": {
          "id": "groq:openai/gpt-oss-20b",
          "label": "GPT-OSS-20B (Primary)"
        },
        "response": {
          "output": "{\n  \"headline\": \"Cycle time has slowed dramatically.\",\n  \"detail\": \"While throughput rose 25.5% to 123 PRs merged, cycle time jumped 135.8% to 169.4 hours, indicating a significant slowdown in the merge process. AI-assisted PRs are 47.1% slower than non-AI PRs, contributing to the overall delay. The revert rate remains low at 0.8%, so quality is not yet a concern.\",\n  \"recommendation\": \"Implement a review workflow automation that limits review time to 48 hours and provides automated feedback to reduce cycle time.\",\n  \"metric_cards\": [\n    {\"label\":\"Throughput\",\"value\":\"+25.5%\",\"trend\":\"positive\"},\n    {\"label\":\"Cycle Time\",\"value\":\"+135.8%\",\"trend\":\"negative\"},\n    {\"label\":\"AI Adoption\",\"value\":\"34.1%\",\"trend\":\"neutral\"},\n    {\"label\":\"Quality\",\"value\":\"0.8% reverts\",\"trend\":\"neutral\"}\n  ]\n}\n\nCheck priority: headline starts with \"Cycle time\". Good.\n\nNow ensure JSON is valid. No markdown.\n\n{\n  \"headline\": \"Cycle time has slowed dramatically.\",\n  \"detail\": \"While throughput rose 25.5% to 123 PRs merged, cycle time jumped 135.8% to 169.4 hours, indicating a significant slowdown in the merge process. AI‑assisted PRs are 47.1% slower than non‑AI PRs, contributing to the overall delay. The revert rate remains low at 0.8%, so quality is not yet a concern.\",\n  \"recommendation\": \"Implement a review workflow automation that limits review time to 48 hours and provides automated feedback to reduce cycle time.\",\n  \"metric_cards\": [\n    {\"label\":\"Throughput\",\"value\":\"+25.5%\",\"trend\":\"positive\"},\n    {\"label\":\"Cycle Time\",\"value\":\"+135.8%\",\"trend\":\"negative\"},\n    {\"label\":\"AI Adoption\",\"value\":\"34.1%\",\"trend\":\"neutral\"},\n    {\"label\":\"Quality\",\"value\":\"0.8% reverts\",\"trend\":\"neutral\"}\n  ]\n}",
          "tokenUsage": {
            "total": 2282,
            "prompt": 972,
            "completion": 1310,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 1090
            }
          },
          "cached": false,
          "latencyMs": 1742,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "[velocity_bad] Cycle time regression - Real Antiwork data",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Antiwork\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 123 PRs merged\n- Previous period: 98 PRs merged\n- Change: 25.5%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 169.4 hours\n- Previous period: 71.8 hours\n- Change: 135.8% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 72.5 hours\n- Previous period: 22.2 hours\n- Change: 226.5% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 1 (0.8% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 0.8\n- Large PRs (>500 lines): 17.9%\n\n## Team Health\n\n- Active contributors: 25\n- Top contributor share: 17.1% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 19.9\n- Max reviews by single reviewer: 72\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 42 (34.1% adoption)\n- Non-AI PRs: 81\n- AI PR avg cycle time: 214.6 hours\n- Non-AI PR avg cycle time: 145.9 hours\n- AI HURTS: AI PRs are 47.1% SLOWER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); return !!(r.headline && r.detail && r.recommendation && r.metric_cards); })()",
              "description": "Has all required fields"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('cycle') || h.includes('slow') || h.includes('135') || h.includes('time') || h.includes('ai'); })()",
              "description": "Headline mentions cycle time, slowdown, or AI impact"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 0,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Antiwork\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 123 PRs merged\n- Previous period: 98 PRs merged\n- Change: 25.5%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 169.4 hours\n- Previous period: 71.8 hours\n- Change: 135.8% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 72.5 hours\n- Previous period: 22.2 hours\n- Change: 226.5% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 1 (0.8% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 0.8\n- Large PRs (>500 lines): 17.9%\n\n## Team Health\n\n- Active contributors: 25\n- Top contributor share: 17.1% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 19.9\n- Max reviews by single reviewer: 72\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 42 (34.1% adoption)\n- Non-AI PRs: 81\n- AI PR avg cycle time: 214.6 hours\n- Non-AI PR avg cycle time: 145.9 hours\n- AI HURTS: AI PRs are 47.1% SLOWER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); return !!(r.headline && r.detail && r.recommendation && r.metric_cards); })()",
                "description": "Has all required fields"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('cycle') || h.includes('slow') || h.includes('135') || h.includes('time') || h.includes('ai'); })()",
                "description": "Headline mentions cycle time, slowdown, or AI impact"
              }
            }
          ]
        },
        "id": "5dbb831e-665a-4cce-a45b-e4a04eb970f8",
        "latencyMs": 1719,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Antiwork\\n\\n## Period: 2025-11-24 to 2025-12-24 (30 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 123 PRs merged\\n- Previous period: 98 PRs merged\\n- Change: 25.5%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 169.4 hours\\n- Previous period: 71.8 hours\\n- Change: 135.8% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 72.5 hours\\n- Previous period: 22.2 hours\\n- Change: 226.5% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 1 (0.8% of merged PRs)\\n- Hotfixes: 0 (0.0% of merged PRs)\\n- Average review rounds: 0.8\\n- Large PRs (>500 lines): 17.9%\\n\\n## Team Health\\n\\n- Active contributors: 25\\n- Top contributor share: 17.1% of PRs\\n- Work concentration: Healthy distribution\\n- Avg reviews per reviewer: 19.9\\n- Max reviews by single reviewer: 72\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 42 (34.1% adoption)\\n- Non-AI PRs: 81\\n- AI PR avg cycle time: 214.6 hours\\n- Non-AI PR avg cycle time: 145.9 hours\\n- AI HURTS: AI PRs are 47.1% SLOWER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 2,
        "provider": {
          "id": "groq:llama-3.3-70b-versatile",
          "label": "Llama-3.3-70B (Fallback)"
        },
        "response": {
          "output": "{\n  \"headline\": \"The adoption of AI-assisted PRs has significantly impacted velocity, with AI PRs being 47.1% slower than non-AI PRs, leading to a major slowdown in cycle time. This slowdown is a significant concern that needs immediate attention.\",\n  \"detail\": \"The current period saw a 25.5% increase in throughput, with 123 PRs merged, but this gain is overshadowed by the substantial increase in cycle time, which rose by 135.8%. The average cycle time for AI-assisted PRs was 214.6 hours, compared to 145.9 hours for non-AI PRs, resulting in AI PRs being 47.1% slower. This slowdown has major implications for the team's overall productivity and efficiency.\",\n  \"recommendation\": \"Conduct a thorough review of the AI-assisted PR process to identify areas for optimization and improvement, with the goal of reducing the cycle time difference between AI and non-AI PRs.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25.5%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"+135.8%\", \"trend\": \"negative\"},\n    {\"label\": \"AI Adoption\", \"value\": \"34.1%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"0.8% reverts\", \"trend\": \"positive\"}\n  ]\n}",
          "tokenUsage": {
            "total": 1250,
            "prompt": 939,
            "completion": 311,
            "numRequests": 1
          },
          "cached": false,
          "latencyMs": 1710,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 1,
        "success": true,
        "testCase": {
          "description": "[velocity_bad] Cycle time regression - Real Antiwork data",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Antiwork\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 123 PRs merged\n- Previous period: 98 PRs merged\n- Change: 25.5%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 169.4 hours\n- Previous period: 71.8 hours\n- Change: 135.8% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 72.5 hours\n- Previous period: 22.2 hours\n- Change: 226.5% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 1 (0.8% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 0.8\n- Large PRs (>500 lines): 17.9%\n\n## Team Health\n\n- Active contributors: 25\n- Top contributor share: 17.1% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 19.9\n- Max reviews by single reviewer: 72\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 42 (34.1% adoption)\n- Non-AI PRs: 81\n- AI PR avg cycle time: 214.6 hours\n- Non-AI PR avg cycle time: 145.9 hours\n- AI HURTS: AI PRs are 47.1% SLOWER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); return !!(r.headline && r.detail && r.recommendation && r.metric_cards); })()",
              "description": "Has all required fields"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('cycle') || h.includes('slow') || h.includes('135') || h.includes('time') || h.includes('ai'); })()",
              "description": "Headline mentions cycle time, slowdown, or AI impact"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 0,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Antiwork\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 123 PRs merged\n- Previous period: 98 PRs merged\n- Change: 25.5%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 169.4 hours\n- Previous period: 71.8 hours\n- Change: 135.8% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 72.5 hours\n- Previous period: 22.2 hours\n- Change: 226.5% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 1 (0.8% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 0.8\n- Large PRs (>500 lines): 17.9%\n\n## Team Health\n\n- Active contributors: 25\n- Top contributor share: 17.1% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 19.9\n- Max reviews by single reviewer: 72\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 42 (34.1% adoption)\n- Non-AI PRs: 81\n- AI PR avg cycle time: 214.6 hours\n- Non-AI PR avg cycle time: 145.9 hours\n- AI HURTS: AI PRs are 47.1% SLOWER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); return !!(r.headline && r.detail && r.recommendation && r.metric_cards); })()",
                "description": "Has all required fields"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('cycle') || h.includes('slow') || h.includes('135') || h.includes('time') || h.includes('ai'); })()",
                "description": "Headline mentions cycle time, slowdown, or AI impact"
              }
            }
          ]
        },
        "id": "e965c610-6c63-400b-8d28-8a1697d0f643",
        "latencyMs": 1736,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Antiwork\\n\\n## Period: 2025-11-24 to 2025-12-24 (30 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 123 PRs merged\\n- Previous period: 98 PRs merged\\n- Change: 25.5%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 169.4 hours\\n- Previous period: 71.8 hours\\n- Change: 135.8% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 72.5 hours\\n- Previous period: 22.2 hours\\n- Change: 226.5% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 1 (0.8% of merged PRs)\\n- Hotfixes: 0 (0.0% of merged PRs)\\n- Average review rounds: 0.8\\n- Large PRs (>500 lines): 17.9%\\n\\n## Team Health\\n\\n- Active contributors: 25\\n- Top contributor share: 17.1% of PRs\\n- Work concentration: Healthy distribution\\n- Avg reviews per reviewer: 19.9\\n- Max reviews by single reviewer: 72\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 42 (34.1% adoption)\\n- Non-AI PRs: 81\\n- AI PR avg cycle time: 214.6 hours\\n- Non-AI PR avg cycle time: 145.9 hours\\n- AI HURTS: AI PRs are 47.1% SLOWER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 1,
        "provider": {
          "id": "groq:openai/gpt-oss-120b",
          "label": "GPT-OSS-120B (Larger)"
        },
        "response": {
          "output": "{\n  \"headline\": \"Cycle time has surged 136%, indicating a severe slowdown in PR delivery.\",\n  \"detail\": \"While throughput rose 25% to 123 merged PRs, the average cycle time more than doubled from 71.8 to 169.4 hours, dramatically extending delivery timelines. AI-assisted PRs, representing 34% of work, are 47% slower than non‑AI PRs, contributing to the slowdown. Quality remains strong with only 0.8% reverts.\",\n  \"recommendation\": \"Conduct a focused root‑cause analysis on the increased cycle time, starting with AI‑generated PRs, and implement stricter size limits and faster review turn‑arounds for those PRs.\",\n  \"metric_cards\": [\n    {\n      \"label\": \"Throughput\",\n      \"value\": \"+25%\",\n      \"trend\": \"positive\"\n    },\n    {\n      \"label\": \"Cycle Time\",\n      \"value\": \"+136%\",\n      \"trend\": \"negative\"\n    },\n    {\n      \"label\": \"AI Adoption\",\n      \"value\": \"34%\",\n      \"trend\": \"neutral\"\n    },\n    {\n      \"label\": \"Quality\",\n      \"value\": \"0.8% reverts\",\n      \"trend\": \"positive\"\n    }\n  ]\n}",
          "tokenUsage": {
            "total": 1658,
            "prompt": 972,
            "completion": 686,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 410
            }
          },
          "cached": false,
          "latencyMs": 1712,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 1,
        "success": true,
        "testCase": {
          "description": "[velocity_bad] Cycle time regression - Real Antiwork data",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Antiwork\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 123 PRs merged\n- Previous period: 98 PRs merged\n- Change: 25.5%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 169.4 hours\n- Previous period: 71.8 hours\n- Change: 135.8% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 72.5 hours\n- Previous period: 22.2 hours\n- Change: 226.5% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 1 (0.8% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 0.8\n- Large PRs (>500 lines): 17.9%\n\n## Team Health\n\n- Active contributors: 25\n- Top contributor share: 17.1% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 19.9\n- Max reviews by single reviewer: 72\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 42 (34.1% adoption)\n- Non-AI PRs: 81\n- AI PR avg cycle time: 214.6 hours\n- Non-AI PR avg cycle time: 145.9 hours\n- AI HURTS: AI PRs are 47.1% SLOWER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); return !!(r.headline && r.detail && r.recommendation && r.metric_cards); })()",
              "description": "Has all required fields"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('cycle') || h.includes('slow') || h.includes('135') || h.includes('time') || h.includes('ai'); })()",
              "description": "Headline mentions cycle time, slowdown, or AI impact"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 0,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Antiwork\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 123 PRs merged\n- Previous period: 98 PRs merged\n- Change: 25.5%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 169.4 hours\n- Previous period: 71.8 hours\n- Change: 135.8% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 72.5 hours\n- Previous period: 22.2 hours\n- Change: 226.5% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 1 (0.8% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 0.8\n- Large PRs (>500 lines): 17.9%\n\n## Team Health\n\n- Active contributors: 25\n- Top contributor share: 17.1% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 19.9\n- Max reviews by single reviewer: 72\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 42 (34.1% adoption)\n- Non-AI PRs: 81\n- AI PR avg cycle time: 214.6 hours\n- Non-AI PR avg cycle time: 145.9 hours\n- AI HURTS: AI PRs are 47.1% SLOWER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function returned false\n(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('12') || h.includes('hotfix'); })()",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function returned false\n(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('12') || h.includes('hotfix'); })()",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function returned false\n(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('12') || h.includes('hotfix'); })()",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('12') || h.includes('hotfix'); })()",
                "description": "Headline mentions reverts or quality (priority #1)"
              }
            }
          ]
        },
        "id": "1fcab7bb-3953-454d-b990-73b44859d0d3",
        "latencyMs": 882,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Engineering\\n\\n## Period: 2025-11-24 to 2025-12-24 (30 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 100 PRs merged\\n- Previous period: 90 PRs merged\\n- Change: 11.1%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 20.0 hours\\n- Previous period: 22.0 hours\\n- Change: -9.1% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 4.0 hours\\n- Previous period: 5.0 hours\\n- Change: -20.0% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 12 (12.0% of merged PRs)\\n- Hotfixes: 5 (5.0% of merged PRs)\\n- Average review rounds: 1.8\\n- Large PRs (>500 lines): 30.0%\\n\\n## Team Health\\n\\n- Active contributors: 15\\n- Top contributor share: 18.0% of PRs\\n- Work concentration: Healthy distribution\\n- Avg reviews per reviewer: 7.0\\n- Max reviews by single reviewer: 20\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 40 (40.0% adoption)\\n- Non-AI PRs: 60\\n- AI PR avg cycle time: 19.0 hours\\n- Non-AI PR avg cycle time: 21.0 hours\\n- AI HELPS: AI PRs are 9.5% FASTER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 2,
        "provider": {
          "id": "groq:llama-3.3-70b-versatile",
          "label": "Llama-3.3-70B (Fallback)"
        },
        "response": {
          "output": "{\n  \"headline\": \"The team has achieved a significant reduction in cycle time, with AI-assisted PRs being 9.5% faster than non-AI PRs, and a notable increase in throughput of 11.1%.\",\n  \"detail\": \"The current period saw 100 PRs merged, with a cycle time of 20 hours, which is a 9.1% decrease from the previous period. However, the revert rate of 12% is a concern and needs attention. The AI adoption rate of 40% is also significant, and its positive impact on cycle time is a promising trend.\",\n  \"recommendation\": \"Investigate and address the root causes of the high revert rate to improve overall quality and reduce waste.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+11.1%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-9.1%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"40.0%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"12.0% reverts\", \"trend\": \"warning\"}\n  ]\n}",
          "tokenUsage": {
            "total": 1195,
            "prompt": 937,
            "completion": 258,
            "numRequests": 1
          },
          "cached": false,
          "latencyMs": 879,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "description": "[quality_issue] High revert rate - Quality crisis priority #1",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 100 PRs merged\n- Previous period: 90 PRs merged\n- Change: 11.1%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 20.0 hours\n- Previous period: 22.0 hours\n- Change: -9.1% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 4.0 hours\n- Previous period: 5.0 hours\n- Change: -20.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 12 (12.0% of merged PRs)\n- Hotfixes: 5 (5.0% of merged PRs)\n- Average review rounds: 1.8\n- Large PRs (>500 lines): 30.0%\n\n## Team Health\n\n- Active contributors: 15\n- Top contributor share: 18.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 7.0\n- Max reviews by single reviewer: 20\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 40 (40.0% adoption)\n- Non-AI PRs: 60\n- AI PR avg cycle time: 19.0 hours\n- Non-AI PR avg cycle time: 21.0 hours\n- AI HELPS: AI PRs are 9.5% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('12') || h.includes('hotfix'); })()",
              "description": "Headline mentions reverts or quality (priority #1)"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 1,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 100 PRs merged\n- Previous period: 90 PRs merged\n- Change: 11.1%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 20.0 hours\n- Previous period: 22.0 hours\n- Change: -9.1% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 4.0 hours\n- Previous period: 5.0 hours\n- Change: -20.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 12 (12.0% of merged PRs)\n- Hotfixes: 5 (5.0% of merged PRs)\n- Average review rounds: 1.8\n- Large PRs (>500 lines): 30.0%\n\n## Team Health\n\n- Active contributors: 15\n- Top contributor share: 18.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 7.0\n- Max reviews by single reviewer: 20\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 40 (40.0% adoption)\n- Non-AI PRs: 60\n- AI PR avg cycle time: 19.0 hours\n- Non-AI PR avg cycle time: 21.0 hours\n- AI HELPS: AI PRs are 9.5% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected non-whitespace character after JSON at position 900 (line 13 column 1)\nStack Trace: SyntaxError: Unexpected non-whitespace character after JSON at position 900 (line 13 column 1)\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:32)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:183)\n    at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('12') || h.includes('hotfix'); })()",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "Custom function threw error: Unexpected non-whitespace character after JSON at position 900 (line 13 column 1)\nStack Trace: SyntaxError: Unexpected non-whitespace character after JSON at position 900 (line 13 column 1)\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:32)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:183)\n    at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('12') || h.includes('hotfix'); })()",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Expected output to be valid JSON",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected non-whitespace character after JSON at position 900 (line 13 column 1)\nStack Trace: SyntaxError: Unexpected non-whitespace character after JSON at position 900 (line 13 column 1)\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:32)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:183)\n    at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('12') || h.includes('hotfix'); })()",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('12') || h.includes('hotfix'); })()",
                "description": "Headline mentions reverts or quality (priority #1)"
              }
            }
          ]
        },
        "id": "b92caeb2-80af-4abe-badb-becd1cba124f",
        "latencyMs": 1225,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Engineering\\n\\n## Period: 2025-11-24 to 2025-12-24 (30 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 100 PRs merged\\n- Previous period: 90 PRs merged\\n- Change: 11.1%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 20.0 hours\\n- Previous period: 22.0 hours\\n- Change: -9.1% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 4.0 hours\\n- Previous period: 5.0 hours\\n- Change: -20.0% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 12 (12.0% of merged PRs)\\n- Hotfixes: 5 (5.0% of merged PRs)\\n- Average review rounds: 1.8\\n- Large PRs (>500 lines): 30.0%\\n\\n## Team Health\\n\\n- Active contributors: 15\\n- Top contributor share: 18.0% of PRs\\n- Work concentration: Healthy distribution\\n- Avg reviews per reviewer: 7.0\\n- Max reviews by single reviewer: 20\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 40 (40.0% adoption)\\n- Non-AI PRs: 60\\n- AI PR avg cycle time: 19.0 hours\\n- Non-AI PR avg cycle time: 21.0 hours\\n- AI HELPS: AI PRs are 9.5% FASTER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 0,
        "provider": {
          "id": "groq:openai/gpt-oss-20b",
          "label": "GPT-OSS-20B (Primary)"
        },
        "response": {
          "output": "{\n  \"headline\": \"Reverts spike to 12% signals a quality crisis.\",\n  \"detail\": \"The revert rate has climbed to 12% of merged PRs, exceeding the 8% threshold and indicating a growing quality issue. Despite a 9.1% reduction in cycle time and a 11.1% increase in throughput, the high revert rate and 5% hotfixes suggest that many changes are still breaking functionality. AI-assisted PRs are 9.5% faster, but the quality problems persist across both AI and non-AI PRs.\",\n  \"recommendation\": \"Introduce mandatory automated linting and unit‑test coverage checks before PR merge to reduce the revert rate.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+11.1%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-9.1%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"40%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"12% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nCheck priority: yes quality crisis. Good.\n\nReturn JSON.\n\n{\n  \"headline\": \"Reverts spike to 12% signals a quality crisis.\",\n  \"detail\": \"The revert rate has climbed to 12% of merged PRs, exceeding the 8% threshold and indicating a growing quality issue. Despite a 9.1% reduction in cycle time and a 11.1% increase in throughput, the high revert rate and 5% hotfixes suggest that many changes are still breaking functionality. AI-assisted PRs are 9.5% faster, but the quality problems persist across both AI and non‑AI PRs.\",\n  \"recommendation\": \"Introduce mandatory automated linting and unit‑test coverage checks before PR merge to reduce the revert rate.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+11.1%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-9.1%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"40%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"12% reverts\", \"trend\": \"warning\"}\n  ]\n}",
          "tokenUsage": {
            "total": 1915,
            "prompt": 969,
            "completion": 946,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 697
            }
          },
          "cached": false,
          "latencyMs": 1215,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "[quality_issue] High revert rate - Quality crisis priority #1",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 100 PRs merged\n- Previous period: 90 PRs merged\n- Change: 11.1%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 20.0 hours\n- Previous period: 22.0 hours\n- Change: -9.1% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 4.0 hours\n- Previous period: 5.0 hours\n- Change: -20.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 12 (12.0% of merged PRs)\n- Hotfixes: 5 (5.0% of merged PRs)\n- Average review rounds: 1.8\n- Large PRs (>500 lines): 30.0%\n\n## Team Health\n\n- Active contributors: 15\n- Top contributor share: 18.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 7.0\n- Max reviews by single reviewer: 20\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 40 (40.0% adoption)\n- Non-AI PRs: 60\n- AI PR avg cycle time: 19.0 hours\n- Non-AI PR avg cycle time: 21.0 hours\n- AI HELPS: AI PRs are 9.5% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('12') || h.includes('hotfix'); })()",
              "description": "Headline mentions reverts or quality (priority #1)"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 1,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 100 PRs merged\n- Previous period: 90 PRs merged\n- Change: 11.1%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 20.0 hours\n- Previous period: 22.0 hours\n- Change: -9.1% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 4.0 hours\n- Previous period: 5.0 hours\n- Change: -20.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 12 (12.0% of merged PRs)\n- Hotfixes: 5 (5.0% of merged PRs)\n- Average review rounds: 1.8\n- Large PRs (>500 lines): 30.0%\n\n## Team Health\n\n- Active contributors: 15\n- Top contributor share: 18.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 7.0\n- Max reviews by single reviewer: 20\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 40 (40.0% adoption)\n- Non-AI PRs: 60\n- AI PR avg cycle time: 19.0 hours\n- Non-AI PR avg cycle time: 21.0 hours\n- AI HELPS: AI PRs are 9.5% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('12') || h.includes('hotfix'); })()",
                "description": "Headline mentions reverts or quality (priority #1)"
              }
            }
          ]
        },
        "id": "3d4718a2-5fab-4b7d-b889-3e28bd92e68b",
        "latencyMs": 1208,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Engineering\\n\\n## Period: 2025-11-24 to 2025-12-24 (30 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 100 PRs merged\\n- Previous period: 90 PRs merged\\n- Change: 11.1%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 20.0 hours\\n- Previous period: 22.0 hours\\n- Change: -9.1% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 4.0 hours\\n- Previous period: 5.0 hours\\n- Change: -20.0% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 12 (12.0% of merged PRs)\\n- Hotfixes: 5 (5.0% of merged PRs)\\n- Average review rounds: 1.8\\n- Large PRs (>500 lines): 30.0%\\n\\n## Team Health\\n\\n- Active contributors: 15\\n- Top contributor share: 18.0% of PRs\\n- Work concentration: Healthy distribution\\n- Avg reviews per reviewer: 7.0\\n- Max reviews by single reviewer: 20\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 40 (40.0% adoption)\\n- Non-AI PRs: 60\\n- AI PR avg cycle time: 19.0 hours\\n- Non-AI PR avg cycle time: 21.0 hours\\n- AI HELPS: AI PRs are 9.5% FASTER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 1,
        "provider": {
          "id": "groq:openai/gpt-oss-120b",
          "label": "GPT-OSS-120B (Larger)"
        },
        "response": {
          "output": "{\n  \"headline\": \"Revert rate at 12% signals a quality crisis.\",\n  \"detail\": \"Twelve percent of merged PRs were reverted, exceeding the 8% warning threshold and indicating stability issues. While throughput rose modestly to 100 PRs (+11%) and cycle time improved by 9% (now 20h), the high revert rate threatens overall product reliability. AI adoption is at 40% and AI‑assisted PRs are 9.5% faster, but quality concerns outweigh these gains.\",\n  \"recommendation\": \"Implement a mandatory post‑merge validation checklist and increase peer‑review depth for high‑risk PRs to reduce reverts.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+11%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-9%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"40%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"12% reverts\", \"trend\": \"warning\"}\n  ]\n}",
          "tokenUsage": {
            "total": 1443,
            "prompt": 969,
            "completion": 474,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 233
            }
          },
          "cached": false,
          "latencyMs": 1206,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 1,
        "success": true,
        "testCase": {
          "description": "[quality_issue] High revert rate - Quality crisis priority #1",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 100 PRs merged\n- Previous period: 90 PRs merged\n- Change: 11.1%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 20.0 hours\n- Previous period: 22.0 hours\n- Change: -9.1% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 4.0 hours\n- Previous period: 5.0 hours\n- Change: -20.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 12 (12.0% of merged PRs)\n- Hotfixes: 5 (5.0% of merged PRs)\n- Average review rounds: 1.8\n- Large PRs (>500 lines): 30.0%\n\n## Team Health\n\n- Active contributors: 15\n- Top contributor share: 18.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 7.0\n- Max reviews by single reviewer: 20\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 40 (40.0% adoption)\n- Non-AI PRs: 60\n- AI PR avg cycle time: 19.0 hours\n- Non-AI PR avg cycle time: 21.0 hours\n- AI HELPS: AI PRs are 9.5% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('12') || h.includes('hotfix'); })()",
              "description": "Headline mentions reverts or quality (priority #1)"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 1,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 100 PRs merged\n- Previous period: 90 PRs merged\n- Change: 11.1%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 20.0 hours\n- Previous period: 22.0 hours\n- Change: -9.1% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 4.0 hours\n- Previous period: 5.0 hours\n- Change: -20.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 12 (12.0% of merged PRs)\n- Hotfixes: 5 (5.0% of merged PRs)\n- Average review rounds: 1.8\n- Large PRs (>500 lines): 30.0%\n\n## Team Health\n\n- Active contributors: 15\n- Top contributor share: 18.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 7.0\n- Max reviews by single reviewer: 20\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 40 (40.0% adoption)\n- Non-AI PRs: 60\n- AI PR avg cycle time: 19.0 hours\n- Non-AI PR avg cycle time: 21.0 hours\n- AI HELPS: AI PRs are 9.5% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected non-whitespace character after JSON at position 867 (line 13 column 1)\nStack Trace: SyntaxError: Unexpected non-whitespace character after JSON at position 867 (line 13 column 1)\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:32)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:269)\n    at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('ai') && (h.includes('fast') || h.includes('boost') || h.includes('improv') || h.includes('help') || h.includes('46') || h.includes('70') || h.includes('velocity')); })()",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "Custom function threw error: Unexpected non-whitespace character after JSON at position 867 (line 13 column 1)\nStack Trace: SyntaxError: Unexpected non-whitespace character after JSON at position 867 (line 13 column 1)\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:32)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:269)\n    at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('ai') && (h.includes('fast') || h.includes('boost') || h.includes('improv') || h.includes('help') || h.includes('46') || h.includes('70') || h.includes('velocity')); })()",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Expected output to be valid JSON",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected non-whitespace character after JSON at position 867 (line 13 column 1)\nStack Trace: SyntaxError: Unexpected non-whitespace character after JSON at position 867 (line 13 column 1)\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:32)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:269)\n    at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('ai') && (h.includes('fast') || h.includes('boost') || h.includes('improv') || h.includes('help') || h.includes('46') || h.includes('70') || h.includes('velocity')); })()",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('ai') && (h.includes('fast') || h.includes('boost') || h.includes('improv') || h.includes('help') || h.includes('46') || h.includes('70') || h.includes('velocity')); })()",
                "description": "Headline mentions AI with positive impact"
              }
            }
          ]
        },
        "id": "b5cc0d9e-37df-48fa-befa-267be7322e1c",
        "latencyMs": 3586,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Engineering\\n\\n## Period: 2025-11-24 to 2025-12-24 (30 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 80 PRs merged\\n- Previous period: 70 PRs merged\\n- Change: 14.3%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 18.0 hours\\n- Previous period: 28.0 hours\\n- Change: -35.7% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 3.0 hours\\n- Previous period: 6.0 hours\\n- Change: -50.0% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 1 (1.3% of merged PRs)\\n- Hotfixes: 0 (0.0% of merged PRs)\\n- Average review rounds: 1.1\\n- Large PRs (>500 lines): 10.0%\\n\\n## Team Health\\n\\n- Active contributors: 12\\n- Top contributor share: 20.0% of PRs\\n- Work concentration: Healthy distribution\\n- Avg reviews per reviewer: 8.0\\n- Max reviews by single reviewer: 15\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 56 (70.0% adoption)\\n- Non-AI PRs: 24\\n- AI PR avg cycle time: 14.0 hours\\n- Non-AI PR avg cycle time: 26.0 hours\\n- AI HELPS: AI PRs are 46.2% FASTER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 1,
        "provider": {
          "id": "groq:openai/gpt-oss-120b",
          "label": "GPT-OSS-120B (Larger)"
        },
        "response": {
          "output": "{\n  \"headline\": \"AI assistance is dramatically accelerating delivery, cutting cycle time by 46% and boosting overall velocity.\",\n  \"detail\": \"With 70% of PRs generated by AI, the average cycle time dropped 35.7% to 18 hours, and AI‑assisted PRs are 46.2% faster than non‑AI PRs. Throughput rose 14.3% to 80 merged PRs, while quality remains strong with only 1.3% reverts. The faster review times (‑50%) further indicate efficiency gains from AI.\",\n  \"recommendation\": \"Increase AI adoption to target at least 85% of PRs while maintaining current review standards.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+14.3%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-35.7%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"70%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"1.3% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nMake sure JSON is valid, no trailing commas.\n\n{\n  \"headline\": \"AI assistance is dramatically accelerating delivery, cutting cycle time by 46% and boosting overall velocity.\",\n  \"detail\": \"With 70% of PRs generated by AI, the average cycle time dropped 35.7% to 18 hours, and AI‑assisted PRs are 46.2% faster than non‑AI PRs. Throughput rose 14.3% to 80 merged PRs, while quality remains strong with only 1.3% reverts. The faster review times (‑50%) further indicate efficiency gains from AI.\",\n  \"recommendation\": \"Increase AI adoption to target at least 85% of PRs while maintaining current review standards.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+14.3%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-35.7%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"70%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"1.3% reverts\", \"trend\": \"warning\"}\n  ]\n}",
          "tokenUsage": {
            "total": 1886,
            "prompt": 969,
            "completion": 917,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 665
            }
          },
          "cached": false,
          "latencyMs": 3583,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "[ai_positive] AI-assisted PRs are faster - Lead with AI impact",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 80 PRs merged\n- Previous period: 70 PRs merged\n- Change: 14.3%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 18.0 hours\n- Previous period: 28.0 hours\n- Change: -35.7% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 3.0 hours\n- Previous period: 6.0 hours\n- Change: -50.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 1 (1.3% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.1\n- Large PRs (>500 lines): 10.0%\n\n## Team Health\n\n- Active contributors: 12\n- Top contributor share: 20.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 8.0\n- Max reviews by single reviewer: 15\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 56 (70.0% adoption)\n- Non-AI PRs: 24\n- AI PR avg cycle time: 14.0 hours\n- Non-AI PR avg cycle time: 26.0 hours\n- AI HELPS: AI PRs are 46.2% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('ai') && (h.includes('fast') || h.includes('boost') || h.includes('improv') || h.includes('help') || h.includes('46') || h.includes('70') || h.includes('velocity')); })()",
              "description": "Headline mentions AI with positive impact"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 2,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 80 PRs merged\n- Previous period: 70 PRs merged\n- Change: 14.3%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 18.0 hours\n- Previous period: 28.0 hours\n- Change: -35.7% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 3.0 hours\n- Previous period: 6.0 hours\n- Change: -50.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 1 (1.3% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.1\n- Large PRs (>500 lines): 10.0%\n\n## Team Health\n\n- Active contributors: 12\n- Top contributor share: 20.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 8.0\n- Max reviews by single reviewer: 15\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 56 (70.0% adoption)\n- Non-AI PRs: 24\n- AI PR avg cycle time: 14.0 hours\n- Non-AI PR avg cycle time: 26.0 hours\n- AI HELPS: AI PRs are 46.2% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('ai') && (h.includes('fast') || h.includes('boost') || h.includes('improv') || h.includes('help') || h.includes('46') || h.includes('70') || h.includes('velocity')); })()",
                "description": "Headline mentions AI with positive impact"
              }
            }
          ]
        },
        "id": "f4e64974-9573-43fb-983c-468ec7bffa0e",
        "latencyMs": 1268,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Engineering\\n\\n## Period: 2025-11-24 to 2025-12-24 (30 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 80 PRs merged\\n- Previous period: 70 PRs merged\\n- Change: 14.3%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 18.0 hours\\n- Previous period: 28.0 hours\\n- Change: -35.7% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 3.0 hours\\n- Previous period: 6.0 hours\\n- Change: -50.0% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 1 (1.3% of merged PRs)\\n- Hotfixes: 0 (0.0% of merged PRs)\\n- Average review rounds: 1.1\\n- Large PRs (>500 lines): 10.0%\\n\\n## Team Health\\n\\n- Active contributors: 12\\n- Top contributor share: 20.0% of PRs\\n- Work concentration: Healthy distribution\\n- Avg reviews per reviewer: 8.0\\n- Max reviews by single reviewer: 15\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 56 (70.0% adoption)\\n- Non-AI PRs: 24\\n- AI PR avg cycle time: 14.0 hours\\n- Non-AI PR avg cycle time: 26.0 hours\\n- AI HELPS: AI PRs are 46.2% FASTER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 0,
        "provider": {
          "id": "groq:openai/gpt-oss-20b",
          "label": "GPT-OSS-20B (Primary)"
        },
        "response": {
          "output": "{\n  \"headline\": \"AI adoption boosts velocity: AI-assisted PRs are 46% faster\",\n  \"detail\": \"Throughput rose 14.3% to 80 PRs merged, while overall cycle time dropped 35.7% to 18 hours. With 70% of PRs AI-assisted, the average cycle time for AI PRs is 14 hours versus 26 hours for non-AI PRs, driving a 46% speedup. Revert rate remains low at 1.3%, indicating quality is not compromised.\",\n  \"recommendation\": \"Expand AI-assisted PR tooling and training to sustain high adoption and velocity gains while monitoring quality metrics.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+14.3%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-35.7%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"70%\", \"trend\": \"positive\"},\n    {\"label\": \"Quality\", \"value\": \"1.3% reverts\", \"trend\": \"positive\"}\n  ]\n}",
          "tokenUsage": {
            "total": 1817,
            "prompt": 969,
            "completion": 848,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 603
            }
          },
          "cached": false,
          "latencyMs": 1265,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 1,
        "success": true,
        "testCase": {
          "description": "[ai_positive] AI-assisted PRs are faster - Lead with AI impact",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 80 PRs merged\n- Previous period: 70 PRs merged\n- Change: 14.3%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 18.0 hours\n- Previous period: 28.0 hours\n- Change: -35.7% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 3.0 hours\n- Previous period: 6.0 hours\n- Change: -50.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 1 (1.3% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.1\n- Large PRs (>500 lines): 10.0%\n\n## Team Health\n\n- Active contributors: 12\n- Top contributor share: 20.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 8.0\n- Max reviews by single reviewer: 15\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 56 (70.0% adoption)\n- Non-AI PRs: 24\n- AI PR avg cycle time: 14.0 hours\n- Non-AI PR avg cycle time: 26.0 hours\n- AI HELPS: AI PRs are 46.2% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('ai') && (h.includes('fast') || h.includes('boost') || h.includes('improv') || h.includes('help') || h.includes('46') || h.includes('70') || h.includes('velocity')); })()",
              "description": "Headline mentions AI with positive impact"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 2,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 80 PRs merged\n- Previous period: 70 PRs merged\n- Change: 14.3%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 18.0 hours\n- Previous period: 28.0 hours\n- Change: -35.7% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 3.0 hours\n- Previous period: 6.0 hours\n- Change: -50.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 1 (1.3% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.1\n- Large PRs (>500 lines): 10.0%\n\n## Team Health\n\n- Active contributors: 12\n- Top contributor share: 20.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 8.0\n- Max reviews by single reviewer: 15\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 56 (70.0% adoption)\n- Non-AI PRs: 24\n- AI PR avg cycle time: 14.0 hours\n- Non-AI PR avg cycle time: 26.0 hours\n- AI HELPS: AI PRs are 46.2% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('ai') && (h.includes('fast') || h.includes('boost') || h.includes('improv') || h.includes('help') || h.includes('46') || h.includes('70') || h.includes('velocity')); })()",
                "description": "Headline mentions AI with positive impact"
              }
            }
          ]
        },
        "id": "fc61d200-54d3-4c17-8e1a-f499870ec00b",
        "latencyMs": 1006,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Engineering\\n\\n## Period: 2025-11-24 to 2025-12-24 (30 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 80 PRs merged\\n- Previous period: 70 PRs merged\\n- Change: 14.3%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 18.0 hours\\n- Previous period: 28.0 hours\\n- Change: -35.7% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 3.0 hours\\n- Previous period: 6.0 hours\\n- Change: -50.0% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 1 (1.3% of merged PRs)\\n- Hotfixes: 0 (0.0% of merged PRs)\\n- Average review rounds: 1.1\\n- Large PRs (>500 lines): 10.0%\\n\\n## Team Health\\n\\n- Active contributors: 12\\n- Top contributor share: 20.0% of PRs\\n- Work concentration: Healthy distribution\\n- Avg reviews per reviewer: 8.0\\n- Max reviews by single reviewer: 15\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 56 (70.0% adoption)\\n- Non-AI PRs: 24\\n- AI PR avg cycle time: 14.0 hours\\n- Non-AI PR avg cycle time: 26.0 hours\\n- AI HELPS: AI PRs are 46.2% FASTER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 2,
        "provider": {
          "id": "groq:llama-3.3-70b-versatile",
          "label": "Llama-3.3-70B (Fallback)"
        },
        "response": {
          "output": "{\n  \"headline\": \"AI adoption has significantly improved velocity, with AI-assisted PRs being 46.2% faster than non-AI PRs, leading to a notable increase in overall throughput and decrease in cycle time.\",\n  \"detail\": \"The current period saw a 14.3% increase in throughput, with 80 PRs merged, and a 35.7% decrease in cycle time, with an average of 18.0 hours from PR open to merge. The adoption of AI-assisted PRs, at 70.0%, has been a key driver of this improvement, with AI PRs averaging 14.0 hours to merge compared to 26.0 hours for non-AI PRs. This has resulted in a healthier and more efficient development process.\",\n  \"recommendation\": \"Continue to invest in AI-assisted tools and processes to further improve velocity and efficiency, and explore opportunities to expand AI adoption to other areas of the development workflow.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+14.3%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-35.7%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"70.0%\", \"trend\": \"positive\"},\n    {\"label\": \"Quality\", \"value\": \"1.3% reverts\", \"trend\": \"neutral\"}\n  ]\n}",
          "tokenUsage": {
            "total": 1241,
            "prompt": 937,
            "completion": 304,
            "numRequests": 1
          },
          "cached": false,
          "latencyMs": 1004,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 1,
        "success": true,
        "testCase": {
          "description": "[ai_positive] AI-assisted PRs are faster - Lead with AI impact",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 80 PRs merged\n- Previous period: 70 PRs merged\n- Change: 14.3%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 18.0 hours\n- Previous period: 28.0 hours\n- Change: -35.7% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 3.0 hours\n- Previous period: 6.0 hours\n- Change: -50.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 1 (1.3% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.1\n- Large PRs (>500 lines): 10.0%\n\n## Team Health\n\n- Active contributors: 12\n- Top contributor share: 20.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 8.0\n- Max reviews by single reviewer: 15\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 56 (70.0% adoption)\n- Non-AI PRs: 24\n- AI PR avg cycle time: 14.0 hours\n- Non-AI PR avg cycle time: 26.0 hours\n- AI HELPS: AI PRs are 46.2% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('ai') && (h.includes('fast') || h.includes('boost') || h.includes('improv') || h.includes('help') || h.includes('46') || h.includes('70') || h.includes('velocity')); })()",
              "description": "Headline mentions AI with positive impact"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 2,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 80 PRs merged\n- Previous period: 70 PRs merged\n- Change: 14.3%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 18.0 hours\n- Previous period: 28.0 hours\n- Change: -35.7% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 3.0 hours\n- Previous period: 6.0 hours\n- Change: -50.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 1 (1.3% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.1\n- Large PRs (>500 lines): 10.0%\n\n## Team Health\n\n- Active contributors: 12\n- Top contributor share: 20.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 8.0\n- Max reviews by single reviewer: 15\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 56 (70.0% adoption)\n- Non-AI PRs: 24\n- AI PR avg cycle time: 14.0 hours\n- Non-AI PR avg cycle time: 26.0 hours\n- AI HELPS: AI PRs are 46.2% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('ai') && (h.includes('slow') || h.includes('100') || h.includes('longer') || h.includes('hurt') || h.includes('twice') || h.includes('double') || h.includes('impact')); })()",
                "description": "Headline mentions AI with negative impact"
              }
            }
          ]
        },
        "id": "15da91ff-3d0b-4e12-9c8f-f30d9c983d23",
        "latencyMs": 1806,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Engineering\\n\\n## Period: 2025-11-24 to 2025-12-24 (30 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 60 PRs merged\\n- Previous period: 55 PRs merged\\n- Change: 9.1%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 40.0 hours\\n- Previous period: 30.0 hours\\n- Change: 33.3% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 12.0 hours\\n- Previous period: 8.0 hours\\n- Change: 50.0% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 3 (5.0% of merged PRs)\\n- Hotfixes: 1 (1.7% of merged PRs)\\n- Average review rounds: 2.5\\n- Large PRs (>500 lines): 25.0%\\n\\n## Team Health\\n\\n- Active contributors: 10\\n- Top contributor share: 22.0% of PRs\\n- Work concentration: Healthy distribution\\n- Avg reviews per reviewer: 6.0\\n- Max reviews by single reviewer: 18\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 42 (70.0% adoption)\\n- Non-AI PRs: 18\\n- AI PR avg cycle time: 48.0 hours\\n- Non-AI PR avg cycle time: 24.0 hours\\n- AI HURTS: AI PRs are 100.0% SLOWER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 0,
        "provider": {
          "id": "groq:openai/gpt-oss-20b",
          "label": "GPT-OSS-20B (Primary)"
        },
        "response": {
          "output": "{\n  \"headline\": \"AI-assisted PRs are 100% slower, impacting velocity.\",\n  \"detail\": \"AI adoption is high at 70%, yet AI-assisted pull requests take twice as long to merge compared to non-AI PRs, driving overall cycle time up by 33.3%. Despite the slowdown, throughput has modestly increased by 9.1%, and the revert rate remains at 5%, below the 8% threshold.\",\n  \"recommendation\": \"Introduce a dedicated AI review checklist to reduce cycle time for AI-assisted PRs.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+9.1%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"+33.3%\", \"trend\": \"negative\"},\n    {\"label\": \"AI Adoption\", \"value\": \"70%\", \"trend\": \"positive\"},\n    {\"label\": \"Quality\", \"value\": \"5% reverts\", \"trend\": \"neutral\"}\n  ]\n}",
          "tokenUsage": {
            "total": 2313,
            "prompt": 971,
            "completion": 1342,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 1123
            }
          },
          "cached": false,
          "latencyMs": 1801,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 1,
        "success": true,
        "testCase": {
          "description": "[ai_negative] AI-assisted PRs are slower - Flag concern",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 60 PRs merged\n- Previous period: 55 PRs merged\n- Change: 9.1%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 40.0 hours\n- Previous period: 30.0 hours\n- Change: 33.3% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 12.0 hours\n- Previous period: 8.0 hours\n- Change: 50.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 3 (5.0% of merged PRs)\n- Hotfixes: 1 (1.7% of merged PRs)\n- Average review rounds: 2.5\n- Large PRs (>500 lines): 25.0%\n\n## Team Health\n\n- Active contributors: 10\n- Top contributor share: 22.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 6.0\n- Max reviews by single reviewer: 18\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 42 (70.0% adoption)\n- Non-AI PRs: 18\n- AI PR avg cycle time: 48.0 hours\n- Non-AI PR avg cycle time: 24.0 hours\n- AI HURTS: AI PRs are 100.0% SLOWER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('ai') && (h.includes('slow') || h.includes('100') || h.includes('longer') || h.includes('hurt') || h.includes('twice') || h.includes('double') || h.includes('impact')); })()",
              "description": "Headline mentions AI with negative impact"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 3,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 60 PRs merged\n- Previous period: 55 PRs merged\n- Change: 9.1%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 40.0 hours\n- Previous period: 30.0 hours\n- Change: 33.3% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 12.0 hours\n- Previous period: 8.0 hours\n- Change: 50.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 3 (5.0% of merged PRs)\n- Hotfixes: 1 (1.7% of merged PRs)\n- Average review rounds: 2.5\n- Large PRs (>500 lines): 25.0%\n\n## Team Health\n\n- Active contributors: 10\n- Top contributor share: 22.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 6.0\n- Max reviews by single reviewer: 18\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 42 (70.0% adoption)\n- Non-AI PRs: 18\n- AI PR avg cycle time: 48.0 hours\n- Non-AI PR avg cycle time: 24.0 hours\n- AI HURTS: AI PRs are 100.0% SLOWER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('ai') && (h.includes('slow') || h.includes('100') || h.includes('longer') || h.includes('hurt') || h.includes('twice') || h.includes('double') || h.includes('impact')); })()",
                "description": "Headline mentions AI with negative impact"
              }
            }
          ]
        },
        "id": "4a604709-db35-4d47-85b6-d6e15e133457",
        "latencyMs": 1923,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Engineering\\n\\n## Period: 2025-11-24 to 2025-12-24 (30 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 60 PRs merged\\n- Previous period: 55 PRs merged\\n- Change: 9.1%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 40.0 hours\\n- Previous period: 30.0 hours\\n- Change: 33.3% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 12.0 hours\\n- Previous period: 8.0 hours\\n- Change: 50.0% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 3 (5.0% of merged PRs)\\n- Hotfixes: 1 (1.7% of merged PRs)\\n- Average review rounds: 2.5\\n- Large PRs (>500 lines): 25.0%\\n\\n## Team Health\\n\\n- Active contributors: 10\\n- Top contributor share: 22.0% of PRs\\n- Work concentration: Healthy distribution\\n- Avg reviews per reviewer: 6.0\\n- Max reviews by single reviewer: 18\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 42 (70.0% adoption)\\n- Non-AI PRs: 18\\n- AI PR avg cycle time: 48.0 hours\\n- Non-AI PR avg cycle time: 24.0 hours\\n- AI HURTS: AI PRs are 100.0% SLOWER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 1,
        "provider": {
          "id": "groq:openai/gpt-oss-120b",
          "label": "GPT-OSS-120B (Larger)"
        },
        "response": {
          "output": "{\n  \"headline\": \"AI adoption is causing a 100% slowdown in PR cycle time, eroding velocity gains.\",\n  \"detail\": \"Throughput rose modestly 9% to 60 merged PRs, but overall cycle time increased 33% to 40 hours. With 70% AI adoption, AI‑assisted PRs take twice as long as non‑AI PRs, offsetting the throughput improvement. Revert rate is 5%, below the crisis threshold.\",\n  \"recommendation\": \"Limit AI‑generated changes to a pilot group of PRs and track their cycle time, or improve AI tooling to reduce its latency before broader rollout.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+9%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"+33%\", \"trend\": \"negative\"},\n    {\"label\": \"AI Adoption\", \"value\": \"70%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"5% reverts\", \"trend\": \"warning\"}\n  ]\n}",
          "tokenUsage": {
            "total": 1731,
            "prompt": 971,
            "completion": 760,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 524
            }
          },
          "cached": false,
          "latencyMs": 1920,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 1,
        "success": true,
        "testCase": {
          "description": "[ai_negative] AI-assisted PRs are slower - Flag concern",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 60 PRs merged\n- Previous period: 55 PRs merged\n- Change: 9.1%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 40.0 hours\n- Previous period: 30.0 hours\n- Change: 33.3% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 12.0 hours\n- Previous period: 8.0 hours\n- Change: 50.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 3 (5.0% of merged PRs)\n- Hotfixes: 1 (1.7% of merged PRs)\n- Average review rounds: 2.5\n- Large PRs (>500 lines): 25.0%\n\n## Team Health\n\n- Active contributors: 10\n- Top contributor share: 22.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 6.0\n- Max reviews by single reviewer: 18\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 42 (70.0% adoption)\n- Non-AI PRs: 18\n- AI PR avg cycle time: 48.0 hours\n- Non-AI PR avg cycle time: 24.0 hours\n- AI HURTS: AI PRs are 100.0% SLOWER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('ai') && (h.includes('slow') || h.includes('100') || h.includes('longer') || h.includes('hurt') || h.includes('twice') || h.includes('double') || h.includes('impact')); })()",
              "description": "Headline mentions AI with negative impact"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 3,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 60 PRs merged\n- Previous period: 55 PRs merged\n- Change: 9.1%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 40.0 hours\n- Previous period: 30.0 hours\n- Change: 33.3% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 12.0 hours\n- Previous period: 8.0 hours\n- Change: 50.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 3 (5.0% of merged PRs)\n- Hotfixes: 1 (1.7% of merged PRs)\n- Average review rounds: 2.5\n- Large PRs (>500 lines): 25.0%\n\n## Team Health\n\n- Active contributors: 10\n- Top contributor share: 22.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 6.0\n- Max reviews by single reviewer: 18\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 42 (70.0% adoption)\n- Non-AI PRs: 18\n- AI PR avg cycle time: 48.0 hours\n- Non-AI PR avg cycle time: 24.0 hours\n- AI HURTS: AI PRs are 100.0% SLOWER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('ai') && (h.includes('slow') || h.includes('100') || h.includes('longer') || h.includes('hurt') || h.includes('twice') || h.includes('double') || h.includes('impact')); })()",
                "description": "Headline mentions AI with negative impact"
              }
            }
          ]
        },
        "id": "c3a24de0-3ad5-4af1-a3d2-1070ac533947",
        "latencyMs": 1282,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Engineering\\n\\n## Period: 2025-11-24 to 2025-12-24 (30 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 60 PRs merged\\n- Previous period: 55 PRs merged\\n- Change: 9.1%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 40.0 hours\\n- Previous period: 30.0 hours\\n- Change: 33.3% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 12.0 hours\\n- Previous period: 8.0 hours\\n- Change: 50.0% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 3 (5.0% of merged PRs)\\n- Hotfixes: 1 (1.7% of merged PRs)\\n- Average review rounds: 2.5\\n- Large PRs (>500 lines): 25.0%\\n\\n## Team Health\\n\\n- Active contributors: 10\\n- Top contributor share: 22.0% of PRs\\n- Work concentration: Healthy distribution\\n- Avg reviews per reviewer: 6.0\\n- Max reviews by single reviewer: 18\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 42 (70.0% adoption)\\n- Non-AI PRs: 18\\n- AI PR avg cycle time: 48.0 hours\\n- Non-AI PR avg cycle time: 24.0 hours\\n- AI HURTS: AI PRs are 100.0% SLOWER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 2,
        "provider": {
          "id": "groq:llama-3.3-70b-versatile",
          "label": "Llama-3.3-70B (Fallback)"
        },
        "response": {
          "output": "{\n  \"headline\": \"AI-assisted PRs are significantly slowing down the development process, with AI PRs taking 100% longer than non-AI PRs to complete, despite high AI adoption rates of 70%.\",\n  \"detail\": \"The current period saw a 9.1% increase in throughput, with 60 PRs merged, and a 33.3% increase in cycle time, which is a negative trend. However, the significant slowdown in AI-assisted PRs is a major concern, as it outweighs the benefits of increased throughput. The quality metrics show a relatively low revert rate of 5%, but this may be impacted by the slower AI-assisted PRs.\",\n  \"recommendation\": \"Investigate and optimize the AI-assisted PR process to reduce cycle times and improve overall development efficiency.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+9.1%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"+33.3%\", \"trend\": \"negative\"},\n    {\"label\": \"AI Adoption\", \"value\": \"70%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"5% reverts\", \"trend\": \"warning\"}\n  ]\n}",
          "tokenUsage": {
            "total": 1208,
            "prompt": 938,
            "completion": 270,
            "numRequests": 1
          },
          "cached": false,
          "latencyMs": 1279,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 1,
        "success": true,
        "testCase": {
          "description": "[ai_negative] AI-assisted PRs are slower - Flag concern",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 60 PRs merged\n- Previous period: 55 PRs merged\n- Change: 9.1%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 40.0 hours\n- Previous period: 30.0 hours\n- Change: 33.3% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 12.0 hours\n- Previous period: 8.0 hours\n- Change: 50.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 3 (5.0% of merged PRs)\n- Hotfixes: 1 (1.7% of merged PRs)\n- Average review rounds: 2.5\n- Large PRs (>500 lines): 25.0%\n\n## Team Health\n\n- Active contributors: 10\n- Top contributor share: 22.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 6.0\n- Max reviews by single reviewer: 18\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 42 (70.0% adoption)\n- Non-AI PRs: 18\n- AI PR avg cycle time: 48.0 hours\n- Non-AI PR avg cycle time: 24.0 hours\n- AI HURTS: AI PRs are 100.0% SLOWER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('ai') && (h.includes('slow') || h.includes('100') || h.includes('longer') || h.includes('hurt') || h.includes('twice') || h.includes('double') || h.includes('impact')); })()",
              "description": "Headline mentions AI with negative impact"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 3,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 60 PRs merged\n- Previous period: 55 PRs merged\n- Change: 9.1%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 40.0 hours\n- Previous period: 30.0 hours\n- Change: 33.3% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 12.0 hours\n- Previous period: 8.0 hours\n- Change: 50.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 3 (5.0% of merged PRs)\n- Hotfixes: 1 (1.7% of merged PRs)\n- Average review rounds: 2.5\n- Large PRs (>500 lines): 25.0%\n\n## Team Health\n\n- Active contributors: 10\n- Top contributor share: 22.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 6.0\n- Max reviews by single reviewer: 18\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 42 (70.0% adoption)\n- Non-AI PRs: 18\n- AI PR avg cycle time: 48.0 hours\n- Non-AI PR avg cycle time: 24.0 hours\n- AI HURTS: AI PRs are 100.0% SLOWER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "error": "Custom function threw error: Unexpected non-whitespace character after JSON at position 481 (line 13 column 1)\nStack Trace: SyntaxError: Unexpected non-whitespace character after JSON at position 481 (line 13 column 1)\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:32)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:289)\n    at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('concentration') || h.includes('65') || h.includes('contributor') || h.includes('bus') || h.includes('risk') || h.includes('one person') || h.includes('single') || h.includes('depend'); })()",
        "gradingResult": {
          "pass": false,
          "score": 0,
          "reason": "Custom function threw error: Unexpected non-whitespace character after JSON at position 481 (line 13 column 1)\nStack Trace: SyntaxError: Unexpected non-whitespace character after JSON at position 481 (line 13 column 1)\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:32)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:289)\n    at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('concentration') || h.includes('65') || h.includes('contributor') || h.includes('bus') || h.includes('risk') || h.includes('one person') || h.includes('single') || h.includes('depend'); })()",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": false,
              "score": 0,
              "reason": "Expected output to be valid JSON",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function threw error: Unexpected non-whitespace character after JSON at position 481 (line 13 column 1)\nStack Trace: SyntaxError: Unexpected non-whitespace character after JSON at position 481 (line 13 column 1)\n    at JSON.parse (<anonymous>)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:32)\n    at eval (eval at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:34), <anonymous>:3:289)\n    at handleJavascript (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:1327:92)\n    at runAssertion (file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2741:24)\n    at file:///Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/promptfoo/dist/src/evaluator-DUa6jTyI.js:2784:24\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:151:38\n    at replenish (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:447:21)\n    at /Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:452:13\n    at Object.eachOfLimit (/Users/yanchuk/.npm/_npx/1ddbeaccabfe00a4/node_modules/async/dist/async.js:478:36)\n(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('concentration') || h.includes('65') || h.includes('contributor') || h.includes('bus') || h.includes('risk') || h.includes('one person') || h.includes('single') || h.includes('depend'); })()",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('concentration') || h.includes('65') || h.includes('contributor') || h.includes('bus') || h.includes('risk') || h.includes('one person') || h.includes('single') || h.includes('depend'); })()",
                "description": "Headline mentions work concentration or risk"
              }
            }
          ]
        },
        "id": "9e2e60a8-a1ca-4284-80bb-aaff03eef24b",
        "latencyMs": 1562,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Engineering\\n\\n## Period: 2025-11-24 to 2025-12-24 (30 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 40 PRs merged\\n- Previous period: 35 PRs merged\\n- Change: 14.3%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 24.0 hours\\n- Previous period: 26.0 hours\\n- Change: -7.7% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 6.0 hours\\n- Previous period: 8.0 hours\\n- Change: -25.0% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 0 (0.0% of merged PRs)\\n- Hotfixes: 0 (0.0% of merged PRs)\\n- Average review rounds: 1.0\\n- Large PRs (>500 lines): 12.0%\\n\\n## Team Health\\n\\n- Active contributors: 5\\n- Top contributor share: 65.0% of PRs\\n- Work concentration: High risk\\n- Avg reviews per reviewer: 8.0\\n- Max reviews by single reviewer: 20\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 10 (25.0% adoption)\\n- Non-AI PRs: 30\\n- AI PR avg cycle time: 22.0 hours\\n- Non-AI PR avg cycle time: 25.0 hours\\n- AI HELPS: AI PRs are 12.0% FASTER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 0,
        "provider": {
          "id": "groq:openai/gpt-oss-20b",
          "label": "GPT-OSS-20B (Primary)"
        },
        "response": {
          "output": "{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nSo we need to produce similar but with our values.\n\nThus:\n\nheadline: \"High work concentration risk: 65% of PRs merged by a single contributor.\"\n\ndetail: 2-3 sentences: \"Throughput rose 14.3% to 40 PRs, and cycle time improved by 7.7% to 24 hours, indicating a more efficient flow. AI-assisted PRs, while only 25% of the total, are 12% faster than non-AI PRs, showing early benefits of AI tooling. However, zero reverts and hotfixes are positive, but the heavy reliance on one contributor poses a bus factor risk.\"\n\nrecommendation: \"Introduce code ownership rotation and encourage additional contributors to take on merge responsibilities to spread workload and mitigate bus factor risk.\"\n\nmetric_cards:\n\nThroughput: \"+14.3%\" trend \"positive\"\n\nCycle Time: \"-7.7%\" trend \"positive\"\n\nAI Adoption: \"25%\" trend \"neutral\"\n\nQuality: \"0% reverts\" trend \"positive\"\n\nCheck that trend for quality is \"positive\" because it's good.\n\nReturn JSON only. No markdown. Ensure proper JSON. Let's craft.\n\n\n\n{\n  \"headline\": \"High work concentration risk: 65% of PRs merged by a single contributor.\",\n  \"detail\": \"Throughput rose 14.3% to 40 PRs, and cycle time improved by 7.7% to 24 hours, indicating a more efficient flow. AI-assisted PRs, while only 25% of the total, are 12% faster than non-AI PRs, showing early benefits of AI tooling. Zero reverts and hotfixes are positive, but the heavy reliance on one contributor poses a bus factor risk.\",\n  \"recommendation\": \"Introduce code ownership rotation and encourage additional contributors to take on merge responsibilities to spread workload and mitigate bus factor risk.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+14.3%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-7.7%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"25%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"0% reverts\", \"trend\": \"positive\"}\n  ]\n}",
          "tokenUsage": {
            "total": 2206,
            "prompt": 969,
            "completion": 1237,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 986
            }
          },
          "cached": false,
          "latencyMs": 1558,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 0,
        "success": false,
        "testCase": {
          "description": "[team_health] Bus factor risk - Work concentrated on one person",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 40 PRs merged\n- Previous period: 35 PRs merged\n- Change: 14.3%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 24.0 hours\n- Previous period: 26.0 hours\n- Change: -7.7% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 6.0 hours\n- Previous period: 8.0 hours\n- Change: -25.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 0 (0.0% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.0\n- Large PRs (>500 lines): 12.0%\n\n## Team Health\n\n- Active contributors: 5\n- Top contributor share: 65.0% of PRs\n- Work concentration: High risk\n- Avg reviews per reviewer: 8.0\n- Max reviews by single reviewer: 20\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 10 (25.0% adoption)\n- Non-AI PRs: 30\n- AI PR avg cycle time: 22.0 hours\n- Non-AI PR avg cycle time: 25.0 hours\n- AI HELPS: AI PRs are 12.0% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('concentration') || h.includes('65') || h.includes('contributor') || h.includes('bus') || h.includes('risk') || h.includes('one person') || h.includes('single') || h.includes('depend'); })()",
              "description": "Headline mentions work concentration or risk"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 4,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 40 PRs merged\n- Previous period: 35 PRs merged\n- Change: 14.3%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 24.0 hours\n- Previous period: 26.0 hours\n- Change: -7.7% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 6.0 hours\n- Previous period: 8.0 hours\n- Change: -25.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 0 (0.0% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.0\n- Large PRs (>500 lines): 12.0%\n\n## Team Health\n\n- Active contributors: 5\n- Top contributor share: 65.0% of PRs\n- Work concentration: High risk\n- Avg reviews per reviewer: 8.0\n- Max reviews by single reviewer: 20\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 10 (25.0% adoption)\n- Non-AI PRs: 30\n- AI PR avg cycle time: 22.0 hours\n- Non-AI PR avg cycle time: 25.0 hours\n- AI HELPS: AI PRs are 12.0% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "error": "Custom function returned false\n(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('concentration') || h.includes('65') || h.includes('contributor') || h.includes('bus') || h.includes('risk') || h.includes('one person') || h.includes('single') || h.includes('depend'); })()",
        "gradingResult": {
          "pass": false,
          "score": 0.5,
          "reason": "Custom function returned false\n(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('concentration') || h.includes('65') || h.includes('contributor') || h.includes('bus') || h.includes('risk') || h.includes('one person') || h.includes('single') || h.includes('depend'); })()",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": false,
              "score": 0,
              "reason": "Custom function returned false\n(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('concentration') || h.includes('65') || h.includes('contributor') || h.includes('bus') || h.includes('risk') || h.includes('one person') || h.includes('single') || h.includes('depend'); })()",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('concentration') || h.includes('65') || h.includes('contributor') || h.includes('bus') || h.includes('risk') || h.includes('one person') || h.includes('single') || h.includes('depend'); })()",
                "description": "Headline mentions work concentration or risk"
              }
            }
          ]
        },
        "id": "5dacf42e-efc0-4768-a683-d8009bf4ff7e",
        "latencyMs": 2043,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Engineering\\n\\n## Period: 2025-11-24 to 2025-12-24 (30 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 40 PRs merged\\n- Previous period: 35 PRs merged\\n- Change: 14.3%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 24.0 hours\\n- Previous period: 26.0 hours\\n- Change: -7.7% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 6.0 hours\\n- Previous period: 8.0 hours\\n- Change: -25.0% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 0 (0.0% of merged PRs)\\n- Hotfixes: 0 (0.0% of merged PRs)\\n- Average review rounds: 1.0\\n- Large PRs (>500 lines): 12.0%\\n\\n## Team Health\\n\\n- Active contributors: 5\\n- Top contributor share: 65.0% of PRs\\n- Work concentration: High risk\\n- Avg reviews per reviewer: 8.0\\n- Max reviews by single reviewer: 20\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 10 (25.0% adoption)\\n- Non-AI PRs: 30\\n- AI PR avg cycle time: 22.0 hours\\n- Non-AI PR avg cycle time: 25.0 hours\\n- AI HELPS: AI PRs are 12.0% FASTER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 2,
        "provider": {
          "id": "groq:llama-3.3-70b-versatile",
          "label": "Llama-3.3-70B (Fallback)"
        },
        "response": {
          "output": "{\n  \"headline\": \"The team has achieved a significant improvement in cycle time, with AI-assisted PRs being 12% faster than non-AI PRs, and a notable increase in throughput of 14.3%.\",\n  \"detail\": \"The current period has seen 40 PRs merged, with a cycle time of 24 hours, which is a 7.7% decrease from the previous period. The adoption of AI has reached 25%, and it has had a positive impact on cycle time, with AI-assisted PRs being 12% faster than non-AI PRs. However, the team's work concentration is at high risk due to the top contributor's significant share of PRs.\",\n  \"recommendation\": \"Implement a contributor diversification strategy to reduce the team's reliance on a single top contributor and mitigate the high risk of work concentration.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+14.3%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-7.7%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"25%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"0% reverts\", \"trend\": \"positive\"}\n  ]\n}",
          "tokenUsage": {
            "total": 1217,
            "prompt": 937,
            "completion": 280,
            "numRequests": 1
          },
          "cached": false,
          "latencyMs": 2041,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 0.5,
        "success": false,
        "testCase": {
          "description": "[team_health] Bus factor risk - Work concentrated on one person",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 40 PRs merged\n- Previous period: 35 PRs merged\n- Change: 14.3%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 24.0 hours\n- Previous period: 26.0 hours\n- Change: -7.7% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 6.0 hours\n- Previous period: 8.0 hours\n- Change: -25.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 0 (0.0% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.0\n- Large PRs (>500 lines): 12.0%\n\n## Team Health\n\n- Active contributors: 5\n- Top contributor share: 65.0% of PRs\n- Work concentration: High risk\n- Avg reviews per reviewer: 8.0\n- Max reviews by single reviewer: 20\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 10 (25.0% adoption)\n- Non-AI PRs: 30\n- AI PR avg cycle time: 22.0 hours\n- Non-AI PR avg cycle time: 25.0 hours\n- AI HELPS: AI PRs are 12.0% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('concentration') || h.includes('65') || h.includes('contributor') || h.includes('bus') || h.includes('risk') || h.includes('one person') || h.includes('single') || h.includes('depend'); })()",
              "description": "Headline mentions work concentration or risk"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 4,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 40 PRs merged\n- Previous period: 35 PRs merged\n- Change: 14.3%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 24.0 hours\n- Previous period: 26.0 hours\n- Change: -7.7% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 6.0 hours\n- Previous period: 8.0 hours\n- Change: -25.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 0 (0.0% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.0\n- Large PRs (>500 lines): 12.0%\n\n## Team Health\n\n- Active contributors: 5\n- Top contributor share: 65.0% of PRs\n- Work concentration: High risk\n- Avg reviews per reviewer: 8.0\n- Max reviews by single reviewer: 20\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 10 (25.0% adoption)\n- Non-AI PRs: 30\n- AI PR avg cycle time: 22.0 hours\n- Non-AI PR avg cycle time: 25.0 hours\n- AI HELPS: AI PRs are 12.0% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 1
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('concentration') || h.includes('65') || h.includes('contributor') || h.includes('bus') || h.includes('risk') || h.includes('one person') || h.includes('single') || h.includes('depend'); })()",
                "description": "Headline mentions work concentration or risk"
              }
            }
          ]
        },
        "id": "3728c614-56c6-4612-b52a-14be4e0eb0bc",
        "latencyMs": 1761,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Engineering\\n\\n## Period: 2025-11-24 to 2025-12-24 (30 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 40 PRs merged\\n- Previous period: 35 PRs merged\\n- Change: 14.3%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 24.0 hours\\n- Previous period: 26.0 hours\\n- Change: -7.7% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 6.0 hours\\n- Previous period: 8.0 hours\\n- Change: -25.0% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 0 (0.0% of merged PRs)\\n- Hotfixes: 0 (0.0% of merged PRs)\\n- Average review rounds: 1.0\\n- Large PRs (>500 lines): 12.0%\\n\\n## Team Health\\n\\n- Active contributors: 5\\n- Top contributor share: 65.0% of PRs\\n- Work concentration: High risk\\n- Avg reviews per reviewer: 8.0\\n- Max reviews by single reviewer: 20\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 10 (25.0% adoption)\\n- Non-AI PRs: 30\\n- AI PR avg cycle time: 22.0 hours\\n- Non-AI PR avg cycle time: 25.0 hours\\n- AI HELPS: AI PRs are 12.0% FASTER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 1,
        "provider": {
          "id": "groq:openai/gpt-oss-120b",
          "label": "GPT-OSS-120B (Larger)"
        },
        "response": {
          "output": "{\n  \"headline\": \"Work concentration risk: top contributor accounts for 65% of PRs, indicating a bus factor concern.\",\n  \"detail\": \"The single developer is responsible for two‑thirds of all merged PRs, creating a high dependency risk. Throughput has risen modestly (+14%) and cycle time has improved (-8%), while AI adoption remains low (25%) and quality is excellent with zero reverts. This concentration could jeopardize delivery continuity if the key contributor becomes unavailable.\",\n  \"recommendation\": \"Implement a PR ownership rotation and require at least two reviewers per PR to spread knowledge and reduce reliance on the top contributor.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+14%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-8%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"25%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"0% reverts\", \"trend\": \"positive\"}\n  ]\n}",
          "tokenUsage": {
            "total": 1692,
            "prompt": 969,
            "completion": 723,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 491
            }
          },
          "cached": false,
          "latencyMs": 1757,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 1,
        "success": true,
        "testCase": {
          "description": "[team_health] Bus factor risk - Work concentrated on one person",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 40 PRs merged\n- Previous period: 35 PRs merged\n- Change: 14.3%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 24.0 hours\n- Previous period: 26.0 hours\n- Change: -7.7% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 6.0 hours\n- Previous period: 8.0 hours\n- Change: -25.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 0 (0.0% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.0\n- Large PRs (>500 lines): 12.0%\n\n## Team Health\n\n- Active contributors: 5\n- Top contributor share: 65.0% of PRs\n- Work concentration: High risk\n- Avg reviews per reviewer: 8.0\n- Max reviews by single reviewer: 20\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 10 (25.0% adoption)\n- Non-AI PRs: 30\n- AI PR avg cycle time: 22.0 hours\n- Non-AI PR avg cycle time: 25.0 hours\n- AI HELPS: AI PRs are 12.0% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('concentration') || h.includes('65') || h.includes('contributor') || h.includes('bus') || h.includes('risk') || h.includes('one person') || h.includes('single') || h.includes('depend'); })()",
              "description": "Headline mentions work concentration or risk"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 4,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 40 PRs merged\n- Previous period: 35 PRs merged\n- Change: 14.3%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 24.0 hours\n- Previous period: 26.0 hours\n- Change: -7.7% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 6.0 hours\n- Previous period: 8.0 hours\n- Change: -25.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 0 (0.0% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.0\n- Large PRs (>500 lines): 12.0%\n\n## Team Health\n\n- Active contributors: 5\n- Top contributor share: 65.0% of PRs\n- Work concentration: High risk\n- Avg reviews per reviewer: 8.0\n- Max reviews by single reviewer: 20\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 10 (25.0% adoption)\n- Non-AI PRs: 30\n- AI PR avg cycle time: 22.0 hours\n- Non-AI PR avg cycle time: 25.0 hours\n- AI HELPS: AI PRs are 12.0% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('8') || h.includes('throughput') || h.includes('33') || h.includes('ai'); })()",
                "description": "Headline mentions revert rate, throughput, or AI impact"
              }
            }
          ]
        },
        "id": "ed086753-e776-463f-be16-c76b7472cbd8",
        "latencyMs": 1368,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Engineering (Weekly)\\n\\n## Period: 2025-12-24 to 2025-12-31 (7 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 12 PRs merged\\n- Previous period: 9 PRs merged\\n- Change: 33.3%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 30.0 hours\\n- Previous period: 26.0 hours\\n- Change: 15.4% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 7.0 hours\\n- Previous period: 5.5 hours\\n- Change: 27.3% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 1 (8.3% of merged PRs)\\n- Hotfixes: 0 (0.0% of merged PRs)\\n- Average review rounds: 1.6\\n- Large PRs (>500 lines): 25.0%\\n\\n## Team Health\\n\\n- Active contributors: 8\\n- Top contributor share: 30.0% of PRs\\n- Work concentration: Healthy distribution\\n- Avg reviews per reviewer: 3.0\\n- Max reviews by single reviewer: 6\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 5 (41.7% adoption)\\n- Non-AI PRs: 7\\n- AI PR avg cycle time: 26.0 hours\\n- Non-AI PR avg cycle time: 33.0 hours\\n- AI HELPS: AI PRs are 21.2% FASTER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 0,
        "provider": {
          "id": "groq:openai/gpt-oss-20b",
          "label": "GPT-OSS-20B (Primary)"
        },
        "response": {
          "output": "{\n  \"headline\": \"Reverts spike to 8.3% signals quality concerns\",\n  \"detail\": \"The team merged 12 PRs this week, a 33.3% increase in throughput, but the revert rate climbed to 8.3%, exceeding the 8% threshold. Cycle time also rose by 15.4%, indicating slower delivery, while AI-assisted PRs are 41.7% of the total and are 21.2% faster than non-AI PRs.\",\n  \"recommendation\": \"Introduce stricter code review guidelines and automated tests to reduce the revert rate and improve overall quality.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+33.3%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"+15.4%\", \"trend\": \"negative\"},\n    {\"label\": \"AI Adoption\", \"value\": \"41.7%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"8.3% reverts\", \"trend\": \"warning\"}\n  ]\n}",
          "tokenUsage": {
            "total": 2118,
            "prompt": 971,
            "completion": 1147,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 909
            }
          },
          "cached": false,
          "latencyMs": 1364,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 1,
        "success": true,
        "testCase": {
          "description": "[time_range] Weekly data with 8% reverts - Should flag quality",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Engineering (Weekly)\n\n## Period: 2025-12-24 to 2025-12-31 (7 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 12 PRs merged\n- Previous period: 9 PRs merged\n- Change: 33.3%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 30.0 hours\n- Previous period: 26.0 hours\n- Change: 15.4% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 7.0 hours\n- Previous period: 5.5 hours\n- Change: 27.3% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 1 (8.3% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.6\n- Large PRs (>500 lines): 25.0%\n\n## Team Health\n\n- Active contributors: 8\n- Top contributor share: 30.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 3.0\n- Max reviews by single reviewer: 6\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 5 (41.7% adoption)\n- Non-AI PRs: 7\n- AI PR avg cycle time: 26.0 hours\n- Non-AI PR avg cycle time: 33.0 hours\n- AI HELPS: AI PRs are 21.2% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('8') || h.includes('throughput') || h.includes('33') || h.includes('ai'); })()",
              "description": "Headline mentions revert rate, throughput, or AI impact"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 5,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Engineering (Weekly)\n\n## Period: 2025-12-24 to 2025-12-31 (7 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 12 PRs merged\n- Previous period: 9 PRs merged\n- Change: 33.3%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 30.0 hours\n- Previous period: 26.0 hours\n- Change: 15.4% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 7.0 hours\n- Previous period: 5.5 hours\n- Change: 27.3% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 1 (8.3% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.6\n- Large PRs (>500 lines): 25.0%\n\n## Team Health\n\n- Active contributors: 8\n- Top contributor share: 30.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 3.0\n- Max reviews by single reviewer: 6\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 5 (41.7% adoption)\n- Non-AI PRs: 7\n- AI PR avg cycle time: 26.0 hours\n- Non-AI PR avg cycle time: 33.0 hours\n- AI HELPS: AI PRs are 21.2% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('8') || h.includes('throughput') || h.includes('33') || h.includes('ai'); })()",
                "description": "Headline mentions revert rate, throughput, or AI impact"
              }
            }
          ]
        },
        "id": "8a2bd033-28b1-4f58-93aa-8a2959b10a3e",
        "latencyMs": 1424,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Engineering (Weekly)\\n\\n## Period: 2025-12-24 to 2025-12-31 (7 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 12 PRs merged\\n- Previous period: 9 PRs merged\\n- Change: 33.3%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 30.0 hours\\n- Previous period: 26.0 hours\\n- Change: 15.4% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 7.0 hours\\n- Previous period: 5.5 hours\\n- Change: 27.3% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 1 (8.3% of merged PRs)\\n- Hotfixes: 0 (0.0% of merged PRs)\\n- Average review rounds: 1.6\\n- Large PRs (>500 lines): 25.0%\\n\\n## Team Health\\n\\n- Active contributors: 8\\n- Top contributor share: 30.0% of PRs\\n- Work concentration: Healthy distribution\\n- Avg reviews per reviewer: 3.0\\n- Max reviews by single reviewer: 6\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 5 (41.7% adoption)\\n- Non-AI PRs: 7\\n- AI PR avg cycle time: 26.0 hours\\n- Non-AI PR avg cycle time: 33.0 hours\\n- AI HELPS: AI PRs are 21.2% FASTER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 1,
        "provider": {
          "id": "groq:openai/gpt-oss-120b",
          "label": "GPT-OSS-120B (Larger)"
        },
        "response": {
          "output": "{\n  \"headline\": \"Revert rate at 8.3% signals a quality crisis.\",\n  \"detail\": \"One out of 12 merged PRs was reverted, pushing the revert rate just above the 8% warning threshold. Throughput rose sharply (+33%) but cycle time slowed by 15%, indicating faster output at the cost of quality. AI adoption is near 42% and AI‑assisted PRs are 21% faster, yet the quality dip outweighs the velocity gains.\",\n  \"recommendation\": \"Introduce stricter pre‑merge testing or a mandatory second reviewer for high‑risk PRs to curb reverts.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+33%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"+15%\", \"trend\": \"negative\"},\n    {\"label\": \"AI Adoption\", \"value\": \"42%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"8.3% reverts\", \"trend\": \"warning\"}\n  ]\n}",
          "tokenUsage": {
            "total": 1572,
            "prompt": 971,
            "completion": 601,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 367
            }
          },
          "cached": false,
          "latencyMs": 1422,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 1,
        "success": true,
        "testCase": {
          "description": "[time_range] Weekly data with 8% reverts - Should flag quality",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Engineering (Weekly)\n\n## Period: 2025-12-24 to 2025-12-31 (7 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 12 PRs merged\n- Previous period: 9 PRs merged\n- Change: 33.3%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 30.0 hours\n- Previous period: 26.0 hours\n- Change: 15.4% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 7.0 hours\n- Previous period: 5.5 hours\n- Change: 27.3% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 1 (8.3% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.6\n- Large PRs (>500 lines): 25.0%\n\n## Team Health\n\n- Active contributors: 8\n- Top contributor share: 30.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 3.0\n- Max reviews by single reviewer: 6\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 5 (41.7% adoption)\n- Non-AI PRs: 7\n- AI PR avg cycle time: 26.0 hours\n- Non-AI PR avg cycle time: 33.0 hours\n- AI HELPS: AI PRs are 21.2% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('8') || h.includes('throughput') || h.includes('33') || h.includes('ai'); })()",
              "description": "Headline mentions revert rate, throughput, or AI impact"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 5,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Engineering (Weekly)\n\n## Period: 2025-12-24 to 2025-12-31 (7 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 12 PRs merged\n- Previous period: 9 PRs merged\n- Change: 33.3%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 30.0 hours\n- Previous period: 26.0 hours\n- Change: 15.4% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 7.0 hours\n- Previous period: 5.5 hours\n- Change: 27.3% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 1 (8.3% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.6\n- Large PRs (>500 lines): 25.0%\n\n## Team Health\n\n- Active contributors: 8\n- Top contributor share: 30.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 3.0\n- Max reviews by single reviewer: 6\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 5 (41.7% adoption)\n- Non-AI PRs: 7\n- AI PR avg cycle time: 26.0 hours\n- Non-AI PR avg cycle time: 33.0 hours\n- AI HELPS: AI PRs are 21.2% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('8') || h.includes('throughput') || h.includes('33') || h.includes('ai'); })()",
                "description": "Headline mentions revert rate, throughput, or AI impact"
              }
            }
          ]
        },
        "id": "09c4d884-0481-4257-8455-ec839bff1602",
        "latencyMs": 949,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Engineering (Weekly)\\n\\n## Period: 2025-12-24 to 2025-12-31 (7 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 12 PRs merged\\n- Previous period: 9 PRs merged\\n- Change: 33.3%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 30.0 hours\\n- Previous period: 26.0 hours\\n- Change: 15.4% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 7.0 hours\\n- Previous period: 5.5 hours\\n- Change: 27.3% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 1 (8.3% of merged PRs)\\n- Hotfixes: 0 (0.0% of merged PRs)\\n- Average review rounds: 1.6\\n- Large PRs (>500 lines): 25.0%\\n\\n## Team Health\\n\\n- Active contributors: 8\\n- Top contributor share: 30.0% of PRs\\n- Work concentration: Healthy distribution\\n- Avg reviews per reviewer: 3.0\\n- Max reviews by single reviewer: 6\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 5 (41.7% adoption)\\n- Non-AI PRs: 7\\n- AI PR avg cycle time: 26.0 hours\\n- Non-AI PR avg cycle time: 33.0 hours\\n- AI HELPS: AI PRs are 21.2% FASTER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 2,
        "provider": {
          "id": "groq:llama-3.3-70b-versatile",
          "label": "Llama-3.3-70B (Fallback)"
        },
        "response": {
          "output": "{\n  \"headline\": \"AI-assisted PRs are significantly faster, with a 21.2% reduction in cycle time compared to non-AI PRs, indicating a substantial positive impact on velocity. This is accompanied by a notable 33.3% increase in throughput.\",\n  \"detail\": \"The current period saw 12 PRs merged, a 33.3% increase from the previous period, and an average cycle time of 30.0 hours, which is 15.4% slower than the previous period. However, the adoption of AI-assisted PRs at 41.7% has led to a significant reduction in cycle time, with AI PRs being 21.2% faster than non-AI PRs. The quality metrics show a revert rate of 8.3%, which is a concern and needs attention.\",\n  \"recommendation\": \"Increase investment in AI-assisted PR tools and processes to further improve velocity and reduce cycle time, while also addressing the quality concerns by implementing additional review and testing procedures.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+33.3%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"+15.4%\", \"trend\": \"negative\"},\n    {\"label\": \"AI Adoption\", \"value\": \"41.7%\", \"trend\": \"positive\"},\n    {\"label\": \"Quality\", \"value\": \"8.3% reverts\", \"trend\": \"warning\"}\n  ]\n}",
          "tokenUsage": {
            "total": 1256,
            "prompt": 939,
            "completion": 317,
            "numRequests": 1
          },
          "cached": false,
          "latencyMs": 946,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 1,
        "success": true,
        "testCase": {
          "description": "[time_range] Weekly data with 8% reverts - Should flag quality",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Engineering (Weekly)\n\n## Period: 2025-12-24 to 2025-12-31 (7 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 12 PRs merged\n- Previous period: 9 PRs merged\n- Change: 33.3%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 30.0 hours\n- Previous period: 26.0 hours\n- Change: 15.4% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 7.0 hours\n- Previous period: 5.5 hours\n- Change: 27.3% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 1 (8.3% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.6\n- Large PRs (>500 lines): 25.0%\n\n## Team Health\n\n- Active contributors: 8\n- Top contributor share: 30.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 3.0\n- Max reviews by single reviewer: 6\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 5 (41.7% adoption)\n- Non-AI PRs: 7\n- AI PR avg cycle time: 26.0 hours\n- Non-AI PR avg cycle time: 33.0 hours\n- AI HELPS: AI PRs are 21.2% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('8') || h.includes('throughput') || h.includes('33') || h.includes('ai'); })()",
              "description": "Headline mentions revert rate, throughput, or AI impact"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 5,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Engineering (Weekly)\n\n## Period: 2025-12-24 to 2025-12-31 (7 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 12 PRs merged\n- Previous period: 9 PRs merged\n- Change: 33.3%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 30.0 hours\n- Previous period: 26.0 hours\n- Change: 15.4% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 7.0 hours\n- Previous period: 5.5 hours\n- Change: 27.3% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 1 (8.3% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.6\n- Large PRs (>500 lines): 25.0%\n\n## Team Health\n\n- Active contributors: 8\n- Top contributor share: 30.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 3.0\n- Max reviews by single reviewer: 6\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 5 (41.7% adoption)\n- Non-AI PRs: 7\n- AI PR avg cycle time: 26.0 hours\n- Non-AI PR avg cycle time: 33.0 hours\n- AI HELPS: AI PRs are 21.2% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('60') || h.includes('throughput') || h.includes('surge') || h.includes('jump') || h.includes('increase') || h.includes('grew') || h.includes('improv') || h.includes('ai'); })()",
                "description": "Headline mentions throughput surge or AI impact"
              }
            }
          ]
        },
        "id": "a6f7d051-f6af-417d-8538-4a42a6a0e8db",
        "latencyMs": 1511,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Engineering\\n\\n## Period: 2025-11-24 to 2025-12-24 (30 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 72 PRs merged\\n- Previous period: 45 PRs merged\\n- Change: 60.0%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 28.0 hours\\n- Previous period: 65.0 hours\\n- Change: -56.9% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 6.0 hours\\n- Previous period: 20.0 hours\\n- Change: -70.0% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 2 (2.8% of merged PRs)\\n- Hotfixes: 1 (1.4% of merged PRs)\\n- Average review rounds: 1.3\\n- Large PRs (>500 lines): 15.0%\\n\\n## Team Health\\n\\n- Active contributors: 11\\n- Top contributor share: 20.0% of PRs\\n- Work concentration: Healthy distribution\\n- Avg reviews per reviewer: 6.5\\n- Max reviews by single reviewer: 12\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 30 (41.7% adoption)\\n- Non-AI PRs: 42\\n- AI PR avg cycle time: 24.0 hours\\n- Non-AI PR avg cycle time: 31.0 hours\\n- AI HELPS: AI PRs are 22.6% FASTER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 0,
        "provider": {
          "id": "groq:openai/gpt-oss-20b",
          "label": "GPT-OSS-20B (Primary)"
        },
        "response": {
          "output": "{\n  \"headline\": \"Throughput surged 60% over the last month.\",\n  \"detail\": \"The team merged 72 PRs compared to 45 in the prior period, while the average cycle time dropped 57% from 65 to 28 hours. AI-assisted PRs, which now make up 41.7% of merges, are 22.6% faster than non-AI PRs, helping drive the faster cycle time. Revert rate remains low at 2.8%, indicating quality is not being compromised.\",\n  \"recommendation\": \"Encourage developers to submit more AI-assisted PRs, targeting 60% adoption, to sustain the 57% cycle time reduction.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+60%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-56.9%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"41.7%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2.8% reverts\", \"trend\": \"positive\"}\n  ]\n}",
          "tokenUsage": {
            "total": 1964,
            "prompt": 969,
            "completion": 995,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 745
            }
          },
          "cached": false,
          "latencyMs": 1488,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 1,
        "success": true,
        "testCase": {
          "description": "[velocity_good] Recovery period - Major improvements",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 72 PRs merged\n- Previous period: 45 PRs merged\n- Change: 60.0%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 28.0 hours\n- Previous period: 65.0 hours\n- Change: -56.9% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 6.0 hours\n- Previous period: 20.0 hours\n- Change: -70.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 2 (2.8% of merged PRs)\n- Hotfixes: 1 (1.4% of merged PRs)\n- Average review rounds: 1.3\n- Large PRs (>500 lines): 15.0%\n\n## Team Health\n\n- Active contributors: 11\n- Top contributor share: 20.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 6.5\n- Max reviews by single reviewer: 12\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 30 (41.7% adoption)\n- Non-AI PRs: 42\n- AI PR avg cycle time: 24.0 hours\n- Non-AI PR avg cycle time: 31.0 hours\n- AI HELPS: AI PRs are 22.6% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('60') || h.includes('throughput') || h.includes('surge') || h.includes('jump') || h.includes('increase') || h.includes('grew') || h.includes('improv') || h.includes('ai'); })()",
              "description": "Headline mentions throughput surge or AI impact"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 6,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 72 PRs merged\n- Previous period: 45 PRs merged\n- Change: 60.0%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 28.0 hours\n- Previous period: 65.0 hours\n- Change: -56.9% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 6.0 hours\n- Previous period: 20.0 hours\n- Change: -70.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 2 (2.8% of merged PRs)\n- Hotfixes: 1 (1.4% of merged PRs)\n- Average review rounds: 1.3\n- Large PRs (>500 lines): 15.0%\n\n## Team Health\n\n- Active contributors: 11\n- Top contributor share: 20.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 6.5\n- Max reviews by single reviewer: 12\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 30 (41.7% adoption)\n- Non-AI PRs: 42\n- AI PR avg cycle time: 24.0 hours\n- Non-AI PR avg cycle time: 31.0 hours\n- AI HELPS: AI PRs are 22.6% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('60') || h.includes('throughput') || h.includes('surge') || h.includes('jump') || h.includes('increase') || h.includes('grew') || h.includes('improv') || h.includes('ai'); })()",
                "description": "Headline mentions throughput surge or AI impact"
              }
            }
          ]
        },
        "id": "584fadb1-be1d-4643-8a48-70565c94321a",
        "latencyMs": 895,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Engineering\\n\\n## Period: 2025-11-24 to 2025-12-24 (30 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 72 PRs merged\\n- Previous period: 45 PRs merged\\n- Change: 60.0%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 28.0 hours\\n- Previous period: 65.0 hours\\n- Change: -56.9% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 6.0 hours\\n- Previous period: 20.0 hours\\n- Change: -70.0% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 2 (2.8% of merged PRs)\\n- Hotfixes: 1 (1.4% of merged PRs)\\n- Average review rounds: 1.3\\n- Large PRs (>500 lines): 15.0%\\n\\n## Team Health\\n\\n- Active contributors: 11\\n- Top contributor share: 20.0% of PRs\\n- Work concentration: Healthy distribution\\n- Avg reviews per reviewer: 6.5\\n- Max reviews by single reviewer: 12\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 30 (41.7% adoption)\\n- Non-AI PRs: 42\\n- AI PR avg cycle time: 24.0 hours\\n- Non-AI PR avg cycle time: 31.0 hours\\n- AI HELPS: AI PRs are 22.6% FASTER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 2,
        "provider": {
          "id": "groq:llama-3.3-70b-versatile",
          "label": "Llama-3.3-70B (Fallback)"
        },
        "response": {
          "output": "{\n  \"headline\": \"AI-assisted PRs are significantly improving velocity, with a 22.6% faster cycle time compared to non-AI PRs, and overall throughput has increased by 60%.\",\n  \"detail\": \"The current period has seen a substantial increase in throughput, with 72 PRs merged, and a notable reduction in cycle time, down to 28 hours. AI adoption has reached 41.7%, and its impact is clearly positive, with AI-assisted PRs being 22.6% faster than non-AI PRs. Quality remains stable, with a revert rate of 2.8%.\",\n  \"recommendation\": \"Continue to invest in AI-assisted development tools and processes to further improve velocity and efficiency.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+60%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-56.9%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"41.7%\", \"trend\": \"positive\"},\n    {\"label\": \"Quality\", \"value\": \"2.8% reverts\", \"trend\": \"warning\"}\n  ]\n}",
          "tokenUsage": {
            "total": 1195,
            "prompt": 937,
            "completion": 258,
            "numRequests": 1
          },
          "cached": false,
          "latencyMs": 893,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 1,
        "success": true,
        "testCase": {
          "description": "[velocity_good] Recovery period - Major improvements",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 72 PRs merged\n- Previous period: 45 PRs merged\n- Change: 60.0%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 28.0 hours\n- Previous period: 65.0 hours\n- Change: -56.9% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 6.0 hours\n- Previous period: 20.0 hours\n- Change: -70.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 2 (2.8% of merged PRs)\n- Hotfixes: 1 (1.4% of merged PRs)\n- Average review rounds: 1.3\n- Large PRs (>500 lines): 15.0%\n\n## Team Health\n\n- Active contributors: 11\n- Top contributor share: 20.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 6.5\n- Max reviews by single reviewer: 12\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 30 (41.7% adoption)\n- Non-AI PRs: 42\n- AI PR avg cycle time: 24.0 hours\n- Non-AI PR avg cycle time: 31.0 hours\n- AI HELPS: AI PRs are 22.6% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('60') || h.includes('throughput') || h.includes('surge') || h.includes('jump') || h.includes('increase') || h.includes('grew') || h.includes('improv') || h.includes('ai'); })()",
              "description": "Headline mentions throughput surge or AI impact"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 6,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 72 PRs merged\n- Previous period: 45 PRs merged\n- Change: 60.0%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 28.0 hours\n- Previous period: 65.0 hours\n- Change: -56.9% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 6.0 hours\n- Previous period: 20.0 hours\n- Change: -70.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 2 (2.8% of merged PRs)\n- Hotfixes: 1 (1.4% of merged PRs)\n- Average review rounds: 1.3\n- Large PRs (>500 lines): 15.0%\n\n## Team Health\n\n- Active contributors: 11\n- Top contributor share: 20.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 6.5\n- Max reviews by single reviewer: 12\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 30 (41.7% adoption)\n- Non-AI PRs: 42\n- AI PR avg cycle time: 24.0 hours\n- Non-AI PR avg cycle time: 31.0 hours\n- AI HELPS: AI PRs are 22.6% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('60') || h.includes('throughput') || h.includes('surge') || h.includes('jump') || h.includes('increase') || h.includes('grew') || h.includes('improv') || h.includes('ai'); })()",
                "description": "Headline mentions throughput surge or AI impact"
              }
            }
          ]
        },
        "id": "4e4527e9-ba77-4b62-a4e5-a20784e1a586",
        "latencyMs": 1672,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Engineering\\n\\n## Period: 2025-11-24 to 2025-12-24 (30 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 72 PRs merged\\n- Previous period: 45 PRs merged\\n- Change: 60.0%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 28.0 hours\\n- Previous period: 65.0 hours\\n- Change: -56.9% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 6.0 hours\\n- Previous period: 20.0 hours\\n- Change: -70.0% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 2 (2.8% of merged PRs)\\n- Hotfixes: 1 (1.4% of merged PRs)\\n- Average review rounds: 1.3\\n- Large PRs (>500 lines): 15.0%\\n\\n## Team Health\\n\\n- Active contributors: 11\\n- Top contributor share: 20.0% of PRs\\n- Work concentration: Healthy distribution\\n- Avg reviews per reviewer: 6.5\\n- Max reviews by single reviewer: 12\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 30 (41.7% adoption)\\n- Non-AI PRs: 42\\n- AI PR avg cycle time: 24.0 hours\\n- Non-AI PR avg cycle time: 31.0 hours\\n- AI HELPS: AI PRs are 22.6% FASTER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 1,
        "provider": {
          "id": "groq:openai/gpt-oss-120b",
          "label": "GPT-OSS-120B (Larger)"
        },
        "response": {
          "output": "{\n  \"headline\": \"Throughput surged 60%, marking a major increase in PR output.\",\n  \"detail\": \"PR merges jumped from 45 to 72, while cycle time fell dramatically from 65 to 28 hours, indicating faster delivery. AI adoption sits at 42% with AI‑assisted PRs 22.6% faster than non‑AI ones, and quality remains solid with a 2.8% revert rate. The team handled the higher volume without bottlenecks, but the rapid pace warrants monitoring.\",\n  \"recommendation\": \"Scale review capacity by adding a lightweight triage step to keep review turnaround fast as throughput continues to rise.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+60%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-57%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"42%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2.8% reverts\", \"trend\": \"warning\"}\n  ]\n}",
          "tokenUsage": {
            "total": 1631,
            "prompt": 969,
            "completion": 662,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 423
            }
          },
          "cached": false,
          "latencyMs": 1668,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 1,
        "success": true,
        "testCase": {
          "description": "[velocity_good] Recovery period - Major improvements",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 72 PRs merged\n- Previous period: 45 PRs merged\n- Change: 60.0%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 28.0 hours\n- Previous period: 65.0 hours\n- Change: -56.9% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 6.0 hours\n- Previous period: 20.0 hours\n- Change: -70.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 2 (2.8% of merged PRs)\n- Hotfixes: 1 (1.4% of merged PRs)\n- Average review rounds: 1.3\n- Large PRs (>500 lines): 15.0%\n\n## Team Health\n\n- Active contributors: 11\n- Top contributor share: 20.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 6.5\n- Max reviews by single reviewer: 12\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 30 (41.7% adoption)\n- Non-AI PRs: 42\n- AI PR avg cycle time: 24.0 hours\n- Non-AI PR avg cycle time: 31.0 hours\n- AI HELPS: AI PRs are 22.6% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('60') || h.includes('throughput') || h.includes('surge') || h.includes('jump') || h.includes('increase') || h.includes('grew') || h.includes('improv') || h.includes('ai'); })()",
              "description": "Headline mentions throughput surge or AI impact"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 6,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 72 PRs merged\n- Previous period: 45 PRs merged\n- Change: 60.0%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 28.0 hours\n- Previous period: 65.0 hours\n- Change: -56.9% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 6.0 hours\n- Previous period: 20.0 hours\n- Change: -70.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 2 (2.8% of merged PRs)\n- Hotfixes: 1 (1.4% of merged PRs)\n- Average review rounds: 1.3\n- Large PRs (>500 lines): 15.0%\n\n## Team Health\n\n- Active contributors: 11\n- Top contributor share: 20.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 6.5\n- Max reviews by single reviewer: 12\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 30 (41.7% adoption)\n- Non-AI PRs: 42\n- AI PR avg cycle time: 24.0 hours\n- Non-AI PR avg cycle time: 31.0 hours\n- AI HELPS: AI PRs are 22.6% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('throughput') || h.includes('63') || h.includes('64') || h.includes('drop') || h.includes('fell') || h.includes('decreas') || h.includes('decline') || h.includes('ai'); })()",
                "description": "Headline mentions throughput drop or AI impact"
              }
            }
          ]
        },
        "id": "45a27cef-9057-4112-9024-c05b97fac601",
        "latencyMs": 1250,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Engineering\\n\\n## Period: 2025-11-24 to 2025-12-24 (30 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 8 PRs merged\\n- Previous period: 22 PRs merged\\n- Change: -63.6%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 18.0 hours\\n- Previous period: 24.0 hours\\n- Change: -25.0% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 4.0 hours\\n- Previous period: 6.0 hours\\n- Change: -33.3% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 0 (0.0% of merged PRs)\\n- Hotfixes: 0 (0.0% of merged PRs)\\n- Average review rounds: 1.0\\n- Large PRs (>500 lines): 12.5%\\n\\n## Team Health\\n\\n- Active contributors: 3\\n- Top contributor share: 50.0% of PRs\\n- Work concentration: Healthy distribution\\n- Avg reviews per reviewer: 2.7\\n- Max reviews by single reviewer: 5\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 3 (37.5% adoption)\\n- Non-AI PRs: 5\\n- AI PR avg cycle time: 16.0 hours\\n- Non-AI PR avg cycle time: 19.0 hours\\n- AI HELPS: AI PRs are 15.8% FASTER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 0,
        "provider": {
          "id": "groq:openai/gpt-oss-20b",
          "label": "GPT-OSS-20B (Primary)"
        },
        "response": {
          "output": "{\n  \"headline\": \"Throughput dropped 63.6% in the last month\",\n  \"detail\": \"Merged PRs fell from 22 to 8, a 63.6% decline, while cycle time improved from 24.0 to 18.0 hours, a 25% reduction. AI-assisted PRs, at 37.5% adoption, are 15.8% faster than non-AI PRs, and quality remains strong with 0% reverts.\",\n  \"recommendation\": \"Add a dedicated reviewer or pair programming slot to the review process to increase throughput without compromising quality.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"-63.6%\", \"trend\": \"negative\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-25.0%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"37.5%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"0% reverts\", \"trend\": \"neutral\"}\n  ]\n}",
          "tokenUsage": {
            "total": 1973,
            "prompt": 969,
            "completion": 1004,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 770
            }
          },
          "cached": false,
          "latencyMs": 1247,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 1,
        "success": true,
        "testCase": {
          "description": "[velocity_bad] Low activity - Major throughput drop",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 8 PRs merged\n- Previous period: 22 PRs merged\n- Change: -63.6%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 18.0 hours\n- Previous period: 24.0 hours\n- Change: -25.0% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 4.0 hours\n- Previous period: 6.0 hours\n- Change: -33.3% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 0 (0.0% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.0\n- Large PRs (>500 lines): 12.5%\n\n## Team Health\n\n- Active contributors: 3\n- Top contributor share: 50.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 2.7\n- Max reviews by single reviewer: 5\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 3 (37.5% adoption)\n- Non-AI PRs: 5\n- AI PR avg cycle time: 16.0 hours\n- Non-AI PR avg cycle time: 19.0 hours\n- AI HELPS: AI PRs are 15.8% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('throughput') || h.includes('63') || h.includes('64') || h.includes('drop') || h.includes('fell') || h.includes('decreas') || h.includes('decline') || h.includes('ai'); })()",
              "description": "Headline mentions throughput drop or AI impact"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 7,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 8 PRs merged\n- Previous period: 22 PRs merged\n- Change: -63.6%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 18.0 hours\n- Previous period: 24.0 hours\n- Change: -25.0% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 4.0 hours\n- Previous period: 6.0 hours\n- Change: -33.3% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 0 (0.0% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.0\n- Large PRs (>500 lines): 12.5%\n\n## Team Health\n\n- Active contributors: 3\n- Top contributor share: 50.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 2.7\n- Max reviews by single reviewer: 5\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 3 (37.5% adoption)\n- Non-AI PRs: 5\n- AI PR avg cycle time: 16.0 hours\n- Non-AI PR avg cycle time: 19.0 hours\n- AI HELPS: AI PRs are 15.8% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('throughput') || h.includes('63') || h.includes('64') || h.includes('drop') || h.includes('fell') || h.includes('decreas') || h.includes('decline') || h.includes('ai'); })()",
                "description": "Headline mentions throughput drop or AI impact"
              }
            }
          ]
        },
        "id": "5314256f-e66c-4a52-a023-4f18072e3b66",
        "latencyMs": 964,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Engineering\\n\\n## Period: 2025-11-24 to 2025-12-24 (30 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 8 PRs merged\\n- Previous period: 22 PRs merged\\n- Change: -63.6%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 18.0 hours\\n- Previous period: 24.0 hours\\n- Change: -25.0% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 4.0 hours\\n- Previous period: 6.0 hours\\n- Change: -33.3% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 0 (0.0% of merged PRs)\\n- Hotfixes: 0 (0.0% of merged PRs)\\n- Average review rounds: 1.0\\n- Large PRs (>500 lines): 12.5%\\n\\n## Team Health\\n\\n- Active contributors: 3\\n- Top contributor share: 50.0% of PRs\\n- Work concentration: Healthy distribution\\n- Avg reviews per reviewer: 2.7\\n- Max reviews by single reviewer: 5\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 3 (37.5% adoption)\\n- Non-AI PRs: 5\\n- AI PR avg cycle time: 16.0 hours\\n- Non-AI PR avg cycle time: 19.0 hours\\n- AI HELPS: AI PRs are 15.8% FASTER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 2,
        "provider": {
          "id": "groq:llama-3.3-70b-versatile",
          "label": "Llama-3.3-70B (Fallback)"
        },
        "response": {
          "output": "{\n  \"headline\": \"The adoption of AI has significantly improved cycle time, with AI-assisted PRs being 15.8% faster than non-AI PRs, while the team's overall throughput has decreased by 63.6%.\",\n  \"detail\": \"The decrease in throughput is a concern, but the positive impact of AI on cycle time is a notable finding, with AI-assisted PRs averaging 16.0 hours compared to 19.0 hours for non-AI PRs. The quality of the PRs remains high, with no reverts or hotfixes, and a healthy distribution of work among contributors. However, the team should investigate the cause of the decreased throughput to mitigate any potential risks.\",\n  \"recommendation\": \"Investigate the cause of the 63.6% decrease in throughput to identify areas for improvement and potential bottlenecks in the development process.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"-63.6%\", \"trend\": \"negative\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-25.0%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"37.5%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"0% reverts\", \"trend\": \"positive\"}\n  ]\n}",
          "tokenUsage": {
            "total": 1223,
            "prompt": 937,
            "completion": 286,
            "numRequests": 1
          },
          "cached": false,
          "latencyMs": 960,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 1,
        "success": true,
        "testCase": {
          "description": "[velocity_bad] Low activity - Major throughput drop",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 8 PRs merged\n- Previous period: 22 PRs merged\n- Change: -63.6%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 18.0 hours\n- Previous period: 24.0 hours\n- Change: -25.0% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 4.0 hours\n- Previous period: 6.0 hours\n- Change: -33.3% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 0 (0.0% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.0\n- Large PRs (>500 lines): 12.5%\n\n## Team Health\n\n- Active contributors: 3\n- Top contributor share: 50.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 2.7\n- Max reviews by single reviewer: 5\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 3 (37.5% adoption)\n- Non-AI PRs: 5\n- AI PR avg cycle time: 16.0 hours\n- Non-AI PR avg cycle time: 19.0 hours\n- AI HELPS: AI PRs are 15.8% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('throughput') || h.includes('63') || h.includes('64') || h.includes('drop') || h.includes('fell') || h.includes('decreas') || h.includes('decline') || h.includes('ai'); })()",
              "description": "Headline mentions throughput drop or AI impact"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 7,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 8 PRs merged\n- Previous period: 22 PRs merged\n- Change: -63.6%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 18.0 hours\n- Previous period: 24.0 hours\n- Change: -25.0% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 4.0 hours\n- Previous period: 6.0 hours\n- Change: -33.3% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 0 (0.0% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.0\n- Large PRs (>500 lines): 12.5%\n\n## Team Health\n\n- Active contributors: 3\n- Top contributor share: 50.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 2.7\n- Max reviews by single reviewer: 5\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 3 (37.5% adoption)\n- Non-AI PRs: 5\n- AI PR avg cycle time: 16.0 hours\n- Non-AI PR avg cycle time: 19.0 hours\n- AI HELPS: AI PRs are 15.8% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      },
      {
        "cost": 0,
        "gradingResult": {
          "pass": true,
          "score": 1,
          "reason": "All assertions passed",
          "namedScores": {},
          "tokensUsed": {
            "total": 0,
            "prompt": 0,
            "completion": 0,
            "cached": 0,
            "numRequests": 0
          },
          "componentResults": [
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "is-json"
              }
            },
            {
              "pass": true,
              "score": 1,
              "reason": "Assertion passed",
              "assertion": {
                "type": "javascript",
                "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('throughput') || h.includes('63') || h.includes('64') || h.includes('drop') || h.includes('fell') || h.includes('decreas') || h.includes('decline') || h.includes('ai'); })()",
                "description": "Headline mentions throughput drop or AI impact"
              }
            }
          ]
        },
        "id": "4607550d-e343-4894-8495-31a76baca700",
        "latencyMs": 2263,
        "namedScores": {},
        "prompt": {
          "raw": "[\n  {\n    \"role\": \"system\",\n    \"content\": \"You are an engineering metrics analyst for CTOs.\\n\\nAnalyze the metrics and return a JSON object with these exact fields:\\n\\n{\\n  \\\"headline\\\": \\\"Most significant finding in 1-2 sentences.\\\",\\n  \\\"detail\\\": \\\"2-3 sentences explaining key numbers and implications.\\\",\\n  \\\"recommendation\\\": \\\"One specific, actionable step.\\\",\\n  \\\"metric_cards\\\": [\\n    {\\\"label\\\": \\\"Throughput\\\", \\\"value\\\": \\\"+25%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"Cycle Time\\\", \\\"value\\\": \\\"-15%\\\", \\\"trend\\\": \\\"positive\\\"},\\n    {\\\"label\\\": \\\"AI Adoption\\\", \\\"value\\\": \\\"45%\\\", \\\"trend\\\": \\\"neutral\\\"},\\n    {\\\"label\\\": \\\"Quality\\\", \\\"value\\\": \\\"2% reverts\\\", \\\"trend\\\": \\\"warning\\\"}\\n  ]\\n}\\n\\nPRIORITY ORDER for headline (pick the first that applies):\\n1. Quality crisis: revert_rate > 8% → Lead with \\\"reverts\\\" and quality concern\\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \\\"cycle time\\\" slowing down\\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\\n7. Otherwise: Summarize the most notable change\\n\\nAI IMPACT INTERPRETATION:\\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\\n- NEGATIVE value = AI PRs are faster (good) → \\\"AI-assisted PRs are X% faster\\\"\\n- POSITIVE value = AI PRs are slower (bad) → \\\"AI-assisted PRs take X% longer\\\"\\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\\n\\nGENERAL:\\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\\n- trend: \\\"positive\\\"=good, \\\"negative\\\"=bad, \\\"neutral\\\"=stable, \\\"warning\\\"=needs attention\\n\\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.\"\n  },\n  {\n    \"role\": \"user\",\n    \"content\": \"# Engineering Metrics Analysis for Engineering\\n\\n## Period: 2025-11-24 to 2025-12-24 (30 days)\\n\\n## Velocity Metrics\\n\\n### Throughput\\n- Current period: 8 PRs merged\\n- Previous period: 22 PRs merged\\n- Change: -63.6%\\n\\n### Cycle Time (hours from PR open to merge)\\n- Current period: 18.0 hours\\n- Previous period: 24.0 hours\\n- Change: -25.0% (negative = faster)\\n\\n### Review Time (hours to first review)\\n- Current period: 4.0 hours\\n- Previous period: 6.0 hours\\n- Change: -33.3% (negative = faster)\\n\\n## Quality Metrics\\n\\n- Reverts: 0 (0.0% of merged PRs)\\n- Hotfixes: 0 (0.0% of merged PRs)\\n- Average review rounds: 1.0\\n- Large PRs (>500 lines): 12.5%\\n\\n## Team Health\\n\\n- Active contributors: 3\\n- Top contributor share: 50.0% of PRs\\n- Work concentration: Healthy distribution\\n- Avg reviews per reviewer: 2.7\\n- Max reviews by single reviewer: 5\\n- No review bottleneck detected\\n\\n## AI Impact\\n\\n- AI-assisted PRs: 3 (37.5% adoption)\\n- Non-AI PRs: 5\\n- AI PR avg cycle time: 16.0 hours\\n- Non-AI PR avg cycle time: 19.0 hours\\n- AI HELPS: AI PRs are 15.8% FASTER than non-AI PRs\\n\\n---\\n\\nAnalyze these metrics and provide:\\n1. A 1-2 sentence headline insight (most important finding)\\n2. 2-3 sentences of context and detail\\n3. One actionable recommendation\\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator\"\n  }\n]",
          "label": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
        },
        "promptId": "4cdd7eafe3c9942225d0cf7b391374a4e41f44a24b38ae65a5cdc6fb3b55c0df",
        "promptIdx": 1,
        "provider": {
          "id": "groq:openai/gpt-oss-120b",
          "label": "GPT-OSS-120B (Larger)"
        },
        "response": {
          "output": "{\n  \"headline\": \"Throughput plummeted 64% this period, raising capacity concerns.\",\n  \"detail\": \"PR merges dropped from 22 to 8, a 63.6% decline, while cycle time improved 25% (18 h vs 24 h) indicating faster processing. AI adoption is modest at 38%, with AI‑assisted PRs completing 16% faster than non‑AI PRs. Quality remains strong with zero reverts.\",\n  \"recommendation\": \"Conduct a root‑cause analysis of the throughput drop and adjust staffing or review processes to restore merge velocity.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"-64%\", \"trend\": \"negative\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-25%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"38%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"0% reverts\", \"trend\": \"positive\"}\n  ]\n}",
          "tokenUsage": {
            "total": 1790,
            "prompt": 969,
            "completion": 821,
            "numRequests": 1,
            "completionDetails": {
              "reasoning": 594
            }
          },
          "cached": false,
          "latencyMs": 2260,
          "finishReason": "stop",
          "guardrails": {
            "flagged": false
          }
        },
        "score": 1,
        "success": true,
        "testCase": {
          "description": "[velocity_bad] Low activity - Major throughput drop",
          "vars": {
            "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
            "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 8 PRs merged\n- Previous period: 22 PRs merged\n- Change: -63.6%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 18.0 hours\n- Previous period: 24.0 hours\n- Change: -25.0% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 4.0 hours\n- Previous period: 6.0 hours\n- Change: -33.3% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 0 (0.0% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.0\n- Large PRs (>500 lines): 12.5%\n\n## Team Health\n\n- Active contributors: 3\n- Top contributor share: 50.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 2.7\n- Max reviews by single reviewer: 5\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 3 (37.5% adoption)\n- Non-AI PRs: 5\n- AI PR avg cycle time: 16.0 hours\n- Non-AI PR avg cycle time: 19.0 hours\n- AI HELPS: AI PRs are 15.8% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
          },
          "assert": [
            {
              "type": "is-json"
            },
            {
              "type": "javascript",
              "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('throughput') || h.includes('63') || h.includes('64') || h.includes('drop') || h.includes('fell') || h.includes('decreas') || h.includes('decline') || h.includes('ai'); })()",
              "description": "Headline mentions throughput drop or AI impact"
            }
          ],
          "options": {
            "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
          },
          "metadata": {}
        },
        "testIdx": 7,
        "vars": {
          "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {.",
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 8 PRs merged\n- Previous period: 22 PRs merged\n- Change: -63.6%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 18.0 hours\n- Previous period: 24.0 hours\n- Change: -25.0% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 4.0 hours\n- Previous period: 6.0 hours\n- Change: -33.3% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 0 (0.0% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.0\n- Large PRs (>500 lines): 12.5%\n\n## Team Health\n\n- Active contributors: 3\n- Top contributor share: 50.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 2.7\n- Max reviews by single reviewer: 5\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 3 (37.5% adoption)\n- Non-AI PRs: 5\n- AI PR avg cycle time: 16.0 hours\n- Non-AI PR avg cycle time: 19.0 hours\n- AI HELPS: AI PRs are 15.8% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "metadata": {
          "_promptfooFileMetadata": {}
        },
        "failureReason": 0
      }
    ],
    "stats": {
      "successes": 18,
      "failures": 6,
      "errors": 0,
      "tokenUsage": {
        "prompt": 23019,
        "completion": 16757,
        "cached": 0,
        "total": 39776,
        "numRequests": 24,
        "completionDetails": {
          "reasoning": 10630,
          "acceptedPrediction": 0,
          "rejectedPrediction": 0
        },
        "assertions": {
          "total": 0,
          "prompt": 0,
          "completion": 0,
          "cached": 0,
          "numRequests": 0,
          "completionDetails": {
            "reasoning": 0,
            "acceptedPrediction": 0,
            "rejectedPrediction": 0
          }
        }
      },
      "durationMs": 12961
    }
  },
  "config": {
    "tags": {},
    "description": "Dashboard Insight Generation Evaluation (v1.0.3)",
    "prompts": [
      {
        "id": "v1.0.2",
        "raw": "[\n  {\"role\": \"system\", \"content\": \"{{system_prompt}}\"},\n  {\"role\": \"user\", \"content\": \"{{user_prompt}}\"}\n]"
      }
    ],
    "providers": [
      {
        "id": "groq:openai/gpt-oss-20b",
        "label": "GPT-OSS-20B (Primary)",
        "config": {
          "temperature": 0.3,
          "max_tokens": 2000
        }
      },
      {
        "id": "groq:openai/gpt-oss-120b",
        "label": "GPT-OSS-120B (Larger)",
        "config": {
          "temperature": 0.3,
          "max_tokens": 2000
        }
      },
      {
        "id": "groq:llama-3.3-70b-versatile",
        "label": "Llama-3.3-70B (Fallback)",
        "config": {
          "temperature": 0.3,
          "max_tokens": 2000
        }
      }
    ],
    "tests": [
      {
        "description": "[velocity_bad] Cycle time regression - Real Antiwork data",
        "vars": {
          "user_prompt": "# Engineering Metrics Analysis for Antiwork\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 123 PRs merged\n- Previous period: 98 PRs merged\n- Change: 25.5%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 169.4 hours\n- Previous period: 71.8 hours\n- Change: 135.8% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 72.5 hours\n- Previous period: 22.2 hours\n- Change: 226.5% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 1 (0.8% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 0.8\n- Large PRs (>500 lines): 17.9%\n\n## Team Health\n\n- Active contributors: 25\n- Top contributor share: 17.1% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 19.9\n- Max reviews by single reviewer: 72\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 42 (34.1% adoption)\n- Non-AI PRs: 81\n- AI PR avg cycle time: 214.6 hours\n- Non-AI PR avg cycle time: 145.9 hours\n- AI HURTS: AI PRs are 47.1% SLOWER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "(() => { const r = JSON.parse(output); return !!(r.headline && r.detail && r.recommendation && r.metric_cards); })()",
            "description": "Has all required fields"
          },
          {
            "type": "javascript",
            "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('cycle') || h.includes('slow') || h.includes('135') || h.includes('time') || h.includes('ai'); })()",
            "description": "Headline mentions cycle time, slowdown, or AI impact"
          }
        ]
      },
      {
        "description": "[quality_issue] High revert rate - Quality crisis priority #1",
        "vars": {
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 100 PRs merged\n- Previous period: 90 PRs merged\n- Change: 11.1%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 20.0 hours\n- Previous period: 22.0 hours\n- Change: -9.1% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 4.0 hours\n- Previous period: 5.0 hours\n- Change: -20.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 12 (12.0% of merged PRs)\n- Hotfixes: 5 (5.0% of merged PRs)\n- Average review rounds: 1.8\n- Large PRs (>500 lines): 30.0%\n\n## Team Health\n\n- Active contributors: 15\n- Top contributor share: 18.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 7.0\n- Max reviews by single reviewer: 20\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 40 (40.0% adoption)\n- Non-AI PRs: 60\n- AI PR avg cycle time: 19.0 hours\n- Non-AI PR avg cycle time: 21.0 hours\n- AI HELPS: AI PRs are 9.5% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('12') || h.includes('hotfix'); })()",
            "description": "Headline mentions reverts or quality (priority #1)"
          }
        ]
      },
      {
        "description": "[ai_positive] AI-assisted PRs are faster - Lead with AI impact",
        "vars": {
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 80 PRs merged\n- Previous period: 70 PRs merged\n- Change: 14.3%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 18.0 hours\n- Previous period: 28.0 hours\n- Change: -35.7% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 3.0 hours\n- Previous period: 6.0 hours\n- Change: -50.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 1 (1.3% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.1\n- Large PRs (>500 lines): 10.0%\n\n## Team Health\n\n- Active contributors: 12\n- Top contributor share: 20.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 8.0\n- Max reviews by single reviewer: 15\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 56 (70.0% adoption)\n- Non-AI PRs: 24\n- AI PR avg cycle time: 14.0 hours\n- Non-AI PR avg cycle time: 26.0 hours\n- AI HELPS: AI PRs are 46.2% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('ai') && (h.includes('fast') || h.includes('boost') || h.includes('improv') || h.includes('help') || h.includes('46') || h.includes('70') || h.includes('velocity')); })()",
            "description": "Headline mentions AI with positive impact"
          }
        ]
      },
      {
        "description": "[ai_negative] AI-assisted PRs are slower - Flag concern",
        "vars": {
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 60 PRs merged\n- Previous period: 55 PRs merged\n- Change: 9.1%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 40.0 hours\n- Previous period: 30.0 hours\n- Change: 33.3% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 12.0 hours\n- Previous period: 8.0 hours\n- Change: 50.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 3 (5.0% of merged PRs)\n- Hotfixes: 1 (1.7% of merged PRs)\n- Average review rounds: 2.5\n- Large PRs (>500 lines): 25.0%\n\n## Team Health\n\n- Active contributors: 10\n- Top contributor share: 22.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 6.0\n- Max reviews by single reviewer: 18\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 42 (70.0% adoption)\n- Non-AI PRs: 18\n- AI PR avg cycle time: 48.0 hours\n- Non-AI PR avg cycle time: 24.0 hours\n- AI HURTS: AI PRs are 100.0% SLOWER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('ai') && (h.includes('slow') || h.includes('100') || h.includes('longer') || h.includes('hurt') || h.includes('twice') || h.includes('double') || h.includes('impact')); })()",
            "description": "Headline mentions AI with negative impact"
          }
        ]
      },
      {
        "description": "[team_health] Bus factor risk - Work concentrated on one person",
        "vars": {
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 40 PRs merged\n- Previous period: 35 PRs merged\n- Change: 14.3%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 24.0 hours\n- Previous period: 26.0 hours\n- Change: -7.7% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 6.0 hours\n- Previous period: 8.0 hours\n- Change: -25.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 0 (0.0% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.0\n- Large PRs (>500 lines): 12.0%\n\n## Team Health\n\n- Active contributors: 5\n- Top contributor share: 65.0% of PRs\n- Work concentration: High risk\n- Avg reviews per reviewer: 8.0\n- Max reviews by single reviewer: 20\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 10 (25.0% adoption)\n- Non-AI PRs: 30\n- AI PR avg cycle time: 22.0 hours\n- Non-AI PR avg cycle time: 25.0 hours\n- AI HELPS: AI PRs are 12.0% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('concentration') || h.includes('65') || h.includes('contributor') || h.includes('bus') || h.includes('risk') || h.includes('one person') || h.includes('single') || h.includes('depend'); })()",
            "description": "Headline mentions work concentration or risk"
          }
        ]
      },
      {
        "description": "[time_range] Weekly data with 8% reverts - Should flag quality",
        "vars": {
          "user_prompt": "# Engineering Metrics Analysis for Engineering (Weekly)\n\n## Period: 2025-12-24 to 2025-12-31 (7 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 12 PRs merged\n- Previous period: 9 PRs merged\n- Change: 33.3%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 30.0 hours\n- Previous period: 26.0 hours\n- Change: 15.4% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 7.0 hours\n- Previous period: 5.5 hours\n- Change: 27.3% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 1 (8.3% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.6\n- Large PRs (>500 lines): 25.0%\n\n## Team Health\n\n- Active contributors: 8\n- Top contributor share: 30.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 3.0\n- Max reviews by single reviewer: 6\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 5 (41.7% adoption)\n- Non-AI PRs: 7\n- AI PR avg cycle time: 26.0 hours\n- Non-AI PR avg cycle time: 33.0 hours\n- AI HELPS: AI PRs are 21.2% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('8') || h.includes('throughput') || h.includes('33') || h.includes('ai'); })()",
            "description": "Headline mentions revert rate, throughput, or AI impact"
          }
        ]
      },
      {
        "description": "[velocity_good] Recovery period - Major improvements",
        "vars": {
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 72 PRs merged\n- Previous period: 45 PRs merged\n- Change: 60.0%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 28.0 hours\n- Previous period: 65.0 hours\n- Change: -56.9% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 6.0 hours\n- Previous period: 20.0 hours\n- Change: -70.0% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 2 (2.8% of merged PRs)\n- Hotfixes: 1 (1.4% of merged PRs)\n- Average review rounds: 1.3\n- Large PRs (>500 lines): 15.0%\n\n## Team Health\n\n- Active contributors: 11\n- Top contributor share: 20.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 6.5\n- Max reviews by single reviewer: 12\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 30 (41.7% adoption)\n- Non-AI PRs: 42\n- AI PR avg cycle time: 24.0 hours\n- Non-AI PR avg cycle time: 31.0 hours\n- AI HELPS: AI PRs are 22.6% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('60') || h.includes('throughput') || h.includes('surge') || h.includes('jump') || h.includes('increase') || h.includes('grew') || h.includes('improv') || h.includes('ai'); })()",
            "description": "Headline mentions throughput surge or AI impact"
          }
        ]
      },
      {
        "description": "[velocity_bad] Low activity - Major throughput drop",
        "vars": {
          "user_prompt": "# Engineering Metrics Analysis for Engineering\n\n## Period: 2025-11-24 to 2025-12-24 (30 days)\n\n## Velocity Metrics\n\n### Throughput\n- Current period: 8 PRs merged\n- Previous period: 22 PRs merged\n- Change: -63.6%\n\n### Cycle Time (hours from PR open to merge)\n- Current period: 18.0 hours\n- Previous period: 24.0 hours\n- Change: -25.0% (negative = faster)\n\n### Review Time (hours to first review)\n- Current period: 4.0 hours\n- Previous period: 6.0 hours\n- Change: -33.3% (negative = faster)\n\n## Quality Metrics\n\n- Reverts: 0 (0.0% of merged PRs)\n- Hotfixes: 0 (0.0% of merged PRs)\n- Average review rounds: 1.0\n- Large PRs (>500 lines): 12.5%\n\n## Team Health\n\n- Active contributors: 3\n- Top contributor share: 50.0% of PRs\n- Work concentration: Healthy distribution\n- Avg reviews per reviewer: 2.7\n- Max reviews by single reviewer: 5\n- No review bottleneck detected\n\n## AI Impact\n\n- AI-assisted PRs: 3 (37.5% adoption)\n- Non-AI PRs: 5\n- AI PR avg cycle time: 16.0 hours\n- Non-AI PR avg cycle time: 19.0 hours\n- AI HELPS: AI PRs are 15.8% FASTER than non-AI PRs\n\n---\n\nAnalyze these metrics and provide:\n1. A 1-2 sentence headline insight (most important finding)\n2. 2-3 sentences of context and detail\n3. One actionable recommendation\n4. Key metric cards for: throughput change, cycle time change, AI adoption rate, quality indicator"
        },
        "assert": [
          {
            "type": "is-json"
          },
          {
            "type": "javascript",
            "value": "(() => { const r = JSON.parse(output); const h = r.headline.toLowerCase(); return h.includes('throughput') || h.includes('63') || h.includes('64') || h.includes('drop') || h.includes('fell') || h.includes('decreas') || h.includes('decline') || h.includes('ai'); })()",
            "description": "Headline mentions throughput drop or AI impact"
          }
        ]
      }
    ],
    "scenarios": [],
    "env": {},
    "defaultTest": {
      "vars": {
        "system_prompt": "You are an engineering metrics analyst for CTOs.\n\nAnalyze the metrics and return a JSON object with these exact fields:\n\n{\n  \"headline\": \"Most significant finding in 1-2 sentences.\",\n  \"detail\": \"2-3 sentences explaining key numbers and implications.\",\n  \"recommendation\": \"One specific, actionable step.\",\n  \"metric_cards\": [\n    {\"label\": \"Throughput\", \"value\": \"+25%\", \"trend\": \"positive\"},\n    {\"label\": \"Cycle Time\", \"value\": \"-15%\", \"trend\": \"positive\"},\n    {\"label\": \"AI Adoption\", \"value\": \"45%\", \"trend\": \"neutral\"},\n    {\"label\": \"Quality\", \"value\": \"2% reverts\", \"trend\": \"warning\"}\n  ]\n}\n\nPRIORITY ORDER for headline (pick the first that applies):\n1. Quality crisis: revert_rate > 8% → Lead with \"reverts\" and quality concern\n2. AI impact significant: AI adoption > 40% AND |cycle_time_difference| > 25% → Lead with AI impact on velocity\n3. Severe slowdown: cycle_time pct_change > 50% → Lead with \"cycle time\" slowing down\n4. Major throughput change: |throughput pct_change| > 30% → Lead with throughput change\n5. Bottleneck: bottleneck detected → Lead with review bottleneck\n6. Bus factor: top_contributor_pct > 50% → Lead with work concentration risk\n7. Otherwise: Summarize the most notable change\n\nAI IMPACT INTERPRETATION:\n- cycle_time_difference_pct shows (AI_cycle - NonAI_cycle) / NonAI_cycle * 100\n- NEGATIVE value = AI PRs are faster (good) → \"AI-assisted PRs are X% faster\"\n- POSITIVE value = AI PRs are slower (bad) → \"AI-assisted PRs take X% longer\"\n- Example: +100% means AI PRs take TWICE as long as non-AI PRs\n\nGENERAL:\n- Lower cycle time = BETTER (faster). Higher throughput = BETTER.\n- trend: \"positive\"=good, \"negative\"=bad, \"neutral\"=stable, \"warning\"=needs attention\n\nReturn ONLY valid JSON. No markdown code fences, no explanation, no thinking - just the JSON object starting with {."
      },
      "options": {
        "transform": "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"
      },
      "assert": [],
      "metadata": {}
    },
    "outputPath": [
      "./results/insight-promptfoo-results.json"
    ],
    "extensions": [],
    "metadata": {},
    "evaluateOptions": {
      "maxConcurrency": 3,
      "showProgressBar": true
    }
  },
  "shareableUrl": null,
  "metadata": {
    "promptfooVersion": "0.120.8",
    "nodeVersion": "v22.17.1",
    "platform": "darwin",
    "arch": "arm64",
    "exportedAt": "2025-12-31T18:32:04.256Z",
    "evaluationCreatedAt": "2025-12-31T18:31:50.375Z"
  }
}