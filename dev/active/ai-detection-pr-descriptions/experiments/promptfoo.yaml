# Auto-generated by: python manage.py export_prompts
# Prompt version: 6.3.1
# DO NOT EDIT - regenerate with export_prompts command

description: AI Detection Prompt Evaluation (v6.3.1) - Auto-generated
providers:
- id: groq:llama-3.3-70b-versatile
  label: Llama-3.3-70B
  config:
    temperature: 0
    max_tokens: 800
    response_format:
      type: json_object
- id: groq:openai/gpt-oss-20b
  label: GPT-OSS-20B
  config:
    temperature: 0
    max_tokens: 800
    include_reasoning: false
    response_format:
      type: json_object
prompts:
- id: v6.3.1
  raw: |-
    [
      {"role": "system", "content": "{{system_prompt}}"},
      {"role": "user", "content": "{{user_prompt}}"}
    ]
defaultTest:
  vars:
    system_prompt: |-
      You analyze pull requests to provide comprehensive insights for CTOs.
      You MUST respond with valid JSON only.

      ## Your Tasks

      1. **AI Usage Detection** - Was AI used to write this code?
      2. **Technology Detection** - What languages/frameworks are involved?
      3. **Executive Summary** - CTO-friendly description of what this PR does
      4. **Health Assessment** - Identify friction, risk, and iteration patterns

      ## Understanding the Timeline

      The PR includes a unified **Timeline** showing all events chronologically.
      Timestamps use `[+X.Xh]` format (hours after PR creation):

      ```
      Timeline:
      - [+0.5h] COMMIT: Add notification models
      - [+48.0h] REVIEW [CHANGES_REQUESTED]: Sarah: Need rate limiting
      - [+52.0h] COMMIT: Fix review feedback
      - [+72.0h] REVIEW [APPROVED]: Bob: LGTM
      - [+96.0h] MERGED
      ```

      **Event types:**
      - `COMMIT`: Code commit with message
      - `REVIEW [STATE]`: Review with APPROVED/CHANGES_REQUESTED/COMMENTED state
      - `COMMENT`: Discussion comment
      - `MERGED`: PR was merged

      **Use the timeline to understand:**
      - Cause-effect patterns (review at +48h â†’ fix commit at +52h)
      - Response times (gap between review and next commit)
      - Iteration intensity (many events in short time = active rework)
      - Blockers (long gaps between events)

      ## AI Detection Rules

      **POSITIVE signals** (AI was used):
      - Tool mentions: Cursor, Claude, Copilot, Cody, Aider, Devin, Gemini, Windsurf, Tabnine, Cubic, Mintlify, CodeRabbit
      - AI Disclosure sections with usage statements
      - Commit signatures: Co-Authored-By with AI emails (@anthropic.com, @cursor.sh)
      - Explicit markers: "Generated with Claude Code", "AI-generated", "Summary by Cubic"

      **NEGATIVE signals** (AI was NOT used):
      - Explicit denials: "No AI was used", "None", "N/A"
      - AI as product feature being built (NOT the same as using AI to write code):
        - "Add Gemini API integration" = building product feature, NOT using Gemini as coding tool
        - "Add Claude model selector" = building UI for Claude, NOT using Claude to code
        - Look for: API clients, model selectors, LLM integrations being implemented
        - These PRs BUILD AI features but don't necessarily USE AI to write the code
      - Bot authors: dependabot, renovate (tracked separately)

      ## Technology Detection

      Identify technologies from:
      - File paths provided (e.g., .py â†’ Python, .tsx â†’ TypeScript/React)
      - Repository languages provided
      - Framework/library names in description (React, Django, FastAPI, Next.js, etc.)
      - Infrastructure mentions (Docker, Kubernetes, Terraform, etc.)
      - Database mentions (PostgreSQL, Redis, MongoDB, etc.)

      ## Health Assessment Guidelines

      Use the provided metrics to assess PR health:

      **Timing Metrics:**
      - cycle_time_hours: Time from PR open to merge. <24h = fast, 24-72h = normal, >72h = slow
      - review_time_hours: Time to first review. <4h = fast, 4-24h = normal, >24h = slow

      **Iteration Indicators:**
      - commits_after_first_review: >3 suggests significant rework needed
      - review_rounds: >2 indicates back-and-forth discussion
      - total_comments: >10 suggests complex or contentious changes

      **Scope Indicators:**
      - additions + deletions: <50 = small, 50-200 = medium, 200-500 = large, >500 = xlarge
      - Files changed: >15 files = high scope

      **Risk Flags:**
      - is_hotfix: true = production issue fix
      - is_revert: true = previous change caused problems
      - Large scope + many review rounds = high risk

      ## Response Format

      Return JSON with these fields:
      {
        "ai": {
          "is_assisted": boolean,
          "tools": ["lowercase", "tool", "names"],
          "usage_type": "authored" | "assisted" | "reviewed" | "brainstorm" | null,
          "confidence": 0.0-1.0
        },
        "tech": {
          "languages": ["python", "typescript", ...],
          "frameworks": ["django", "react", ...],
          "categories": ["backend", "frontend", "devops", "mobile", "data"]
        },
        "summary": {
          "title": "Brief 5-10 word title of what this PR does",
          "description": "1-2 sentence summary for a CTO. Focus on business impact.",
          "type": "feature" | "bugfix" | "refactor" | "docs" | "test" | "chore" | "ci"
        },
        "health": {
          "review_friction": "low" | "medium" | "high",
          "scope": "small" | "medium" | "large" | "xlarge",
          "risk_level": "low" | "medium" | "high",
          "insights": ["1-2 sentence observations about this PR's process"]
        }
      }

      ## Category Definitions
      - **backend**: Server-side code, APIs, databases
      - **frontend**: UI, React, CSS, browser code
      - **devops**: CI/CD, infrastructure, deployment
      - **mobile**: iOS, Android, React Native
      - **data**: Analytics, ML, data pipelines

      ## PR Type Definitions
      - **feature**: New functionality
      - **bugfix**: Fixing broken behavior
      - **refactor**: Code restructuring without behavior change
      - **docs**: Documentation only
      - **test**: Test additions/changes
      - **chore**: Dependencies, config, maintenance
      - **ci**: CI/CD pipeline changes

      ## Tool Names (lowercase)
      cursor, claude, copilot, cody, devin, gemini, chatgpt, gpt4, aider, windsurf, tabnine, cubic, mintlify, coderabbit

      ## Language Names (lowercase)
      python, typescript, javascript, go, rust, java, ruby, php, swift, kotlin, c, cpp

      ## Framework Names (lowercase)
      react, nextjs, vue, angular, django, fastapi, flask, express, rails, spring, laravel
    user_prompt: |-
      Analyze this pull request:

      (No PR data provided)
tests:
- description: '[pos_cursor_explicit] Cursor IDE mentioned explicitly in AI Disclosure
    section'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Add user profile feature
      Author: Alex Developer
      State: merged
      Labels: feature, user-experience

      Files changed: 5
      Lines: +180/-12
      Files: apps/users/views.py, apps/users/models.py, frontend/src/components/Profile.tsx

      Cycle time: 24.5 hours
      Time to first review: 4.0 hours

      Repository languages: Python, TypeScript

      Timeline:
      - [+2.0h] COMMIT: Add profile model
      - [+4.0h] REVIEW [APPROVED]: Sarah Reviewer: LGTM
      - [+8.0h] COMMIT: Create profile API endpoint
      - [+20.0h] COMMIT: Add frontend component
      - [+24.5h] MERGED

      Description:
      ## Summary
      Added new feature.

      ## AI Disclosure
      Used Cursor IDE for implementation.
  assert:
  - type: is-json
  - &id001
    type: javascript
    value: typeof JSON.parse(output).ai === 'object' && typeof JSON.parse(output).tech
      === 'object' && typeof JSON.parse(output).summary === 'object' && typeof JSON.parse(output).health
      === 'object'
    description: Response has required sections (ai, tech, summary, health)
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === true
  - type: javascript
    value: JSON.parse(output).ai.tools.includes("cursor")
  - type: javascript
    value: JSON.parse(output).ai.confidence >= 0.8
- description: '[pos_claude_code_signature] Claude Code emoji signature with Co-Authored-By'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Fix login validation bug
      Author: Bob Engineer
      State: merged
      Labels: bugfix

      Files changed: 2
      Lines: +45/-8
      Files: apps/auth/validators.py, apps/auth/tests/test_login.py

      Cycle time: 2.5 hours
      Time to first review: 1.0 hours

      Repository languages: Python

      Timeline:
      - [+0.5h] COMMIT: Fix email validation regex
      - [+1.0h] REVIEW [APPROVED]: Charlie Lead: Good catch
      - [+2.0h] COMMIT: Add test cases
      - [+2.5h] MERGED

      Description:
      Fix login bug.

      ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

      Co-Authored-By: Claude <noreply@anthropic.com>
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === true
  - type: javascript
    value: JSON.parse(output).ai.tools.includes("claude")
  - type: javascript
    value: JSON.parse(output).ai.confidence >= 0.9
- description: '[pos_copilot_mention] GitHub Copilot mentioned in description'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Refactor authentication module
      Author: Diana Coder
      State: merged
      Labels: refactor, security

      Files changed: 8
      Lines: +320/-150
      Files: apps/auth/middleware.py, apps/auth/decorators.py, apps/auth/utils.py

      Cycle time: 48.0 hours
      Time to first review: 6.0 hours
      Review rounds: 2

      Repository languages: Python, JavaScript

      Timeline:
      - [+4.0h] COMMIT: Extract auth logic
      - [+6.0h] REVIEW [CHANGES_REQUESTED]: Eve Security: Need session timeout
      - [+12.0h] COMMIT: Add session validation
      - [+24.0h] COMMIT: Improve token handling
      - [+36.0h] REVIEW [APPROVED]: Frank Backend: Looks good now
      - [+48.0h] MERGED

      Description:
      Refactored the auth module with help from GitHub Copilot.

      This change improves security.
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === true
  - type: javascript
    value: JSON.parse(output).ai.tools.includes("copilot")
  - type: javascript
    value: JSON.parse(output).ai.confidence >= 0.7
- description: '[pos_multiple_tools] Multiple AI tools mentioned'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Implement new dashboard
      Author: Grace Fullstack
      State: merged
      Labels: feature, analytics, frontend

      Files changed: 15
      Lines: +890/-45
      Files: frontend/src/pages/Dashboard.tsx, frontend/src/components/charts/LineChart.tsx, apps/analytics/views.py

      Cycle time: 72.0 hours
      Time to first review: 8.0 hours
      Review rounds: 3

      Repository languages: TypeScript, Python

      Timeline:
      - [+8.0h] COMMIT: Initial dashboard layout
      - [+8.5h] REVIEW [CHANGES_REQUESTED]: Henry Architect: Consider lazy loading
      - [+24.0h] COMMIT: Add chart components
      - [+48.0h] COMMIT: Connect to backend API
      - [+60.0h] REVIEW [CHANGES_REQUESTED]: Ivy Frontend: Fix mobile responsive
      - [+68.0h] REVIEW [APPROVED]: Henry Architect: Ship it
      - [+72.0h] MERGED

      Description:
      ## AI Tools Used
      - Cursor for code generation
      - Claude for architecture review

      Built the new analytics dashboard.
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === true
  - type: javascript
    value: JSON.parse(output).ai.tools.includes("cursor")
  - type: javascript
    value: JSON.parse(output).ai.tools.includes("claude")
  - type: javascript
    value: JSON.parse(output).ai.confidence >= 0.85
- description: '[pos_aider_commit] Aider commit message pattern'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Add API rate limiting
      Author: Jack Backend
      State: merged
      Labels: feature, api

      Files changed: 3
      Lines: +120/-5
      Files: apps/api/middleware.py, apps/api/throttling.py, apps/api/tests/test_rate_limit.py

      Cycle time: 16.0 hours
      Time to first review: 3.0 hours

      Repository languages: Python

      Timeline:
      - [+2.0h] COMMIT: aider: Implement rate limiting middleware
      - [+3.0h] REVIEW [APPROVED]: Kate API: Clean implementation
      - [+12.0h] COMMIT: aider: Add tests for throttling
      - [+16.0h] MERGED

      Description:
      Added rate limiting to API endpoints.

      Commit message: aider: Implement rate limiting middleware
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === true
  - type: javascript
    value: JSON.parse(output).ai.tools.includes("aider")
  - type: javascript
    value: JSON.parse(output).ai.confidence >= 0.8
- description: '[pos_windsurf_codeium] Windsurf/Codeium IDE mentioned'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Update payment flow
      Author: Leo Payments
      State: merged
      Labels: feature, payments

      Files changed: 6
      Lines: +240/-80
      Files: apps/payments/checkout.py, apps/payments/stripe.py, frontend/src/checkout/Form.tsx

      Cycle time: 36.0 hours
      Time to first review: 5.0 hours

      Repository languages: Python, JavaScript

      Timeline:
      - [+4.0h] COMMIT: Refactor checkout flow
      - [+5.0h] REVIEW [APPROVED]: Mike Finance: Payment logic looks solid
      - [+18.0h] COMMIT: Add Stripe webhook handler
      - [+30.0h] COMMIT: Update frontend form
      - [+36.0h] MERGED

      Description:
      Updated payment processing.

      ## Development
      Used Windsurf IDE with Codeium for autocomplete.
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === true
  - type: javascript
    value: JSON.parse(output).ai.tools.includes("windsurf")
  - type: javascript
    value: JSON.parse(output).ai.confidence >= 0.75
- description: '[neg_explicit_no_ai] Explicit ''No AI was used'' denial'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Fix API timeout
      Author: Nina Dev
      State: merged
      Labels: bugfix

      Files changed: 2
      Lines: +25/-5
      Files: apps/api/client.py, apps/api/tests/test_timeout.py

      Cycle time: 4.0 hours
      Time to first review: 1.5 hours

      Repository languages: Python

      Timeline:
      - [+1.0h] COMMIT: Increase timeout to 30s
      - [+1.5h] REVIEW [APPROVED]: Oscar Lead: Good fix
      - [+3.0h] COMMIT: Add retry logic
      - [+4.0h] MERGED

      Description:
      ## Changes
      Bug fix.

      ## AI Disclosure
      No AI was used.
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === false
- description: '[neg_ai_as_product] AI mentioned as product feature, not authoring
    tool'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Add Gemini API integration
      Author: Pat AI
      State: merged
      Labels: feature, ai-integration

      Files changed: 7
      Lines: +380/-20
      Files: apps/ai/gemini.py, apps/ai/prompts.py, frontend/src/search/AISearch.tsx

      Cycle time: 56.0 hours
      Time to first review: 12.0 hours
      Review rounds: 2

      Repository languages: Python, TypeScript

      Timeline:
      - [+8.0h] COMMIT: Add Gemini client
      - [+12.0h] REVIEW [CHANGES_REQUESTED]: Quinn ML: Add retry logic
      - [+24.0h] COMMIT: Implement prompt engineering
      - [+40.0h] COMMIT: Add search UI
      - [+48.0h] REVIEW [APPROVED]: Rosa Backend: LGTM
      - [+56.0h] MERGED

      Description:
      Added Gemini API integration for AI-powered search.

      This PR adds support for Google's Gemini model.
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === false
  - type: javascript
    value: '!JSON.parse(output).ai.tools.includes("gemini")'
- description: '[neg_empty_body] Empty PR body - no evidence either way'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Minor fix
      Author: Sam Quick
      State: merged

      Files changed: 1
      Lines: +3/-1
      Files: apps/utils/helpers.py

      Cycle time: 1.0 hours
      Time to first review: 0.5 hours

      Repository languages: Python

      Recent commits:
      - Quick typo fix

      Reviewers: Tina Fast

      Description:
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === false
- description: '[neg_human_only] Standard PR with no AI mentions'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Fix null pointer exception in UserService
      Author: Uma Senior
      State: merged
      Labels: bugfix, production

      Files changed: 3
      Lines: +45/-8
      Files: src/main/java/UserService.java, src/test/java/UserServiceTest.java

      Cycle time: 8.0 hours
      Time to first review: 2.0 hours

      Repository languages: Java

      Timeline:
      - [+2.0h] COMMIT: Add null check for preferences
      - [+2.0h] REVIEW [APPROVED]: Victor Staff: Clean fix
      - [+6.0h] COMMIT: Add unit test
      - [+8.0h] MERGED

      Description:
      ## Problem
      Users were getting 500 errors on profile page.

      ## Solution
      Added null check before accessing user preferences.

      ## Testing
      Added unit test for the edge case.
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === false
- description: '[neg_claude_product_discussion] Discussing Claude as product, not
    using it'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Add Claude model selector
      Author: Wendy Product
      State: merged
      Labels: feature, ui

      Files changed: 4
      Lines: +120/-15
      Files: frontend/src/components/ModelSelector.tsx, apps/ai/models.py

      Cycle time: 24.0 hours
      Time to first review: 4.0 hours

      Repository languages: TypeScript, Python

      Timeline:
      - [+4.0h] COMMIT: Add model dropdown component
      - [+4.0h] REVIEW [APPROVED]: Xavier UI: Nice component
      - [+12.0h] COMMIT: Wire up API
      - [+20.0h] COMMIT: Add Sonnet option
      - [+24.0h] MERGED

      Description:
      Added dropdown to select between Claude Opus and Sonnet models.

      Users can now choose which Claude model to use for their queries.
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === false
  - type: javascript
    value: '!JSON.parse(output).ai.tools.includes("claude")'
- description: '[neg_ai_none_disclosure] AI Disclosure section with ''None'''
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Update dependencies
      Author: Yuki Maintainer
      State: merged
      Labels: chore, dependencies

      Files changed: 2
      Lines: +150/-130
      Files: requirements.txt, pyproject.toml

      Cycle time: 2.0 hours
      Time to first review: 0.5 hours

      Repository languages: Python

      Recent commits:
      - Bump Django to 5.0
      - Update celery

      Reviewers: Zack DevOps

      Description:
      ## Changes
      Bumped package versions.

      ## AI Disclosure
      None
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === false
- description: '[neg_ai_na_disclosure] AI Disclosure section with ''N/A'''
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Fix typo in README
      Author: Anna Docs
      State: merged
      Labels: docs

      Files changed: 1
      Lines: +2/-2
      Files: README.md

      Cycle time: 0.5 hours
      Time to first review: 0.2 hours

      Repository languages: Markdown

      Recent commits:
      - Fix typos in installation section

      Reviewers: Ben Editor

      Description:
      ## Changes
      Fixed spelling error.

      ## AI Disclosure
      N/A
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === false
- description: '[edge_brainstorm_only] AI used only for brainstorming, not coding'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: New feature architecture

      Description:
      ## Overview
      New event system design.

      ## AI Disclosure
      Used ChatGPT for initial brainstorming of the architecture. All code was written manually.
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === true
  - type: javascript
    value: JSON.parse(output).ai.tools.includes("chatgpt")
- description: '[edge_review_only] AI used only for code review'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Optimize database queries

      Description:
      Optimized slow queries.

      ## AI Disclosure
      Code was reviewed by Claude for potential issues.
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === true
  - type: javascript
    value: JSON.parse(output).ai.tools.includes("claude")
- description: '[edge_partial_ai] Some code AI-generated, some manual'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Add data export feature

      Description:
      ## Changes
      - Export to CSV (AI-generated with Cursor)
      - Export to PDF (manual implementation)

      Mixed AI and manual work.
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === true
  - type: javascript
    value: JSON.parse(output).ai.tools.includes("cursor")
- description: '[tech_python_django] Python/Django backend PR'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Add user authentication API

      Description:
      Added Django REST Framework endpoints for user auth.

      Files: views.py, serializers.py, urls.py
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === false
  - type: javascript
    value: JSON.parse(output).tech.categories.includes("backend")
  - type: javascript
    value: JSON.parse(output).summary.type === "feature"
- description: '[tech_react_frontend] React frontend PR'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Add dark mode toggle

      Description:
      Implemented dark mode using React context and Tailwind CSS.

      Files: ThemeContext.tsx, App.tsx, tailwind.config.js
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === false
  - type: javascript
    value: JSON.parse(output).tech.categories.includes("frontend")
  - type: javascript
    value: JSON.parse(output).summary.type === "feature"
- description: '[tech_devops_docker] DevOps/Docker PR'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Add Docker Compose for local dev

      Description:
      Added docker-compose.yml for local development environment.

      Includes PostgreSQL, Redis, and the app container.
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === false
  - type: javascript
    value: JSON.parse(output).tech.categories.includes("devops")
  - type: javascript
    value: JSON.parse(output).summary.type === "chore"
- description: '[tech_fullstack] Full-stack PR touching multiple areas'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Add real-time notifications

      Description:
      ## Backend
      - WebSocket endpoint in Django Channels
      - Redis pub/sub

      ## Frontend
      - React notification component
      - Toast animations with Framer Motion
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === false
  - type: javascript
    value: JSON.parse(output).tech.categories.includes("backend")
  - type: javascript
    value: JSON.parse(output).tech.categories.includes("frontend")
  - type: javascript
    value: JSON.parse(output).summary.type === "feature"
- description: '[type_bugfix] Clear bugfix PR'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Fix: Null pointer in payment processing

      Description:
      ## Problem
      Payments failing with NullPointerException.

      ## Root Cause
      Missing null check on optional field.

      ## Fix
      Added null check before accessing payment method.
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === false
  - type: javascript
    value: JSON.parse(output).summary.type === "bugfix"
- description: '[type_refactor] Code refactoring PR'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Refactor: Extract UserService from monolith

      Description:
      Extracted user-related logic into dedicated service class.

      No behavior changes, just code organization.
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === false
  - type: javascript
    value: JSON.parse(output).summary.type === "refactor"
- description: '[type_docs] Documentation-only PR'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Update API documentation

      Description:
      Updated README with new API endpoints.

      Added examples for authentication flow.
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === false
  - type: javascript
    value: JSON.parse(output).summary.type === "docs"
- description: '[type_test] Test-only PR'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Add unit tests for PaymentService

      Description:
      Added comprehensive test coverage for payment processing.

      - 15 new test cases
      - Edge cases for refunds
      - Mock Stripe API responses
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === false
  - type: javascript
    value: JSON.parse(output).summary.type === "test"
- description: '[type_ci] CI/CD pipeline PR'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Add GitHub Actions workflow

      Description:
      Added CI pipeline for automated testing.

      - Run tests on PR
      - Build Docker image
      - Deploy to staging on merge
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === false
  - type: javascript
    value: JSON.parse(output).summary.type === "ci"
- description: '[health_slow_review] Large PR with slow review time and multiple rounds'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Implement user notification system
      Author: John Developer
      State: merged
      Labels: feature, backend, frontend

      Files changed: 12
      Lines: +450/-32
      Files: apps/notifications/models.py, apps/notifications/consumers.py, apps/notifications/routing.py, frontend/src/components/NotificationBell.tsx, frontend/src/hooks/useWebSocket.ts

      Cycle time: 96.5 hours
      Time to first review: 48.0 hours
      Commits after first review: 5
      Review rounds: 3

      Repository languages: Python, TypeScript, JavaScript

      Timeline:
      - [+0.5h] COMMIT: Add notification models
      - [+4.0h] COMMIT: Implement WebSocket consumer
      - [+48.0h] REVIEW [CHANGES_REQUESTED]: Sarah Tech Lead: Need rate limiting
      - [+50.0h] COMMENT: Bob Backend: Consider Redis for scalability
      - [+52.0h] COMMIT: Fix review feedback: add rate limiting
      - [+72.0h] COMMIT: Address review: improve error handling
      - [+84.0h] COMMIT: ðŸ¤– Generated with Cursor
      - [+90.0h] REVIEW [APPROVED]: Sarah Tech Lead: LGTM
      - [+96.5h] MERGED

      Description:
      ## Summary
      Added real-time notifications with WebSocket support.

      ## AI Disclosure
      Used Cursor for boilerplate code generation.

      ## Changes
      - WebSocket server
      - React notification component
      - Database models for notification queue
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === true
  - type: javascript
    value: JSON.parse(output).ai.tools.includes("cursor")
  - type: javascript
    value: JSON.parse(output).tech.categories.includes("backend")
  - type: javascript
    value: JSON.parse(output).tech.categories.includes("frontend")
  - type: javascript
    value: JSON.parse(output).summary.type === "feature"
- description: '[health_fast_small] Small bugfix with fast review and minimal friction'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Fix null check in payment validation
      Author: Alice Engineer
      State: merged
      Labels: bugfix, payments

      Jira: PAY-1234

      Files changed: 1
      Lines: +5/-2
      Files: apps/payments/validators.py

      Cycle time: 2.5 hours
      Time to first review: 0.5 hours
      Review rounds: 1

      Repository languages: Python

      Timeline:
      - [+0.2h] COMMIT: Fix null check in payment validation
      - [+0.5h] REVIEW [APPROVED]: Bob Backend: LGTM, simple fix
      - [+2.5h] MERGED

      Description:
      ## Problem
      Payment validation was failing for users without saved cards.

      ## Solution
      Added null check before accessing card details.

      ## AI Disclosure
      N/A
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === false
  - type: javascript
    value: JSON.parse(output).tech.categories.includes("backend")
  - type: javascript
    value: JSON.parse(output).summary.type === "bugfix"
- description: '[health_hotfix_revert] Hotfix after a revert - high risk indicator'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: Hotfix: Restore payment processing after revert
      Author: DevOps Engineer
      State: merged
      Labels: hotfix, critical, payments
      Hotfix: Yes

      Linked issues: #1234

      Files changed: 2
      Lines: +15/-3
      Files: apps/payments/currency.py, apps/payments/tests/test_currency.py

      Cycle time: 1.0 hours
      Time to first review: 0.2 hours
      Commits after first review: 1
      Review rounds: 1

      Repository languages: Python

      Timeline:
      - [+0.1h] COMMIT: Hotfix: Fix currency conversion edge case
      - [+0.25h] REVIEW [APPROVED]: CTO: Ship it, we need this ASAP
      - [+0.8h] COMMIT: Add regression test
      - [+1.0h] MERGED

      Description:
      ## Context
      Previous PR broke payment processing and was reverted.

      ## Fix
      Properly handle edge case in currency conversion.

      ## Testing
      Tested with all supported currencies.
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === false
  - type: javascript
    value: JSON.parse(output).tech.categories.includes("backend")
  - type: javascript
    value: JSON.parse(output).summary.type === "bugfix"
- description: '[health_draft_wip] Draft PR with work in progress - incomplete state'
  vars:
    user_prompt: |-
      Analyze this pull request:

      Title: WIP: Add GraphQL API layer
      Author: Junior Dev
      State: open
      Labels: wip, api
      Draft: Yes

      Milestone: Q1 2025 Release

      Files changed: 5
      Lines: +200/-0
      Files: apps/graphql/schema.py, apps/graphql/types.py, apps/graphql/queries.py

      Repository languages: Python

      Timeline:
      - [+1.0h] COMMIT: Initial GraphQL setup
      - [+8.0h] COMMIT: Add user type schema
      - [+24.0h] COMMIT: aider: Implement query resolvers

      Description:
      ## Draft
      Work in progress - not ready for review.

      ## TODO
      - [x] Setup GraphQL schema
      - [ ] Add resolvers
      - [ ] Add authentication

      Using Claude for schema design.
  assert:
  - type: is-json
  - *id001
  - type: javascript
    value: JSON.parse(output).ai.is_assisted === true
  - type: javascript
    value: JSON.parse(output).ai.tools.includes("claude")
  - type: javascript
    value: JSON.parse(output).ai.tools.includes("aider")
  - type: javascript
    value: JSON.parse(output).tech.categories.includes("backend")
  - type: javascript
    value: JSON.parse(output).summary.type === "feature"
outputPath: ./results/promptfoo-results.json
evaluateOptions:
  maxConcurrency: 5
  showProgressBar: true
