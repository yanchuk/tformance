{% load i18n %}
{# Wide Trend Chart Partial - Loaded via HTMX #}
{# Supports single metric (backward compat) and multi-metric comparison #}

{# Store chart data as JSON in script tags for safe JavaScript access #}
{{ chart_data|json_script:"trend-chart-data" }}
{% if comparison_data %}{{ comparison_data|json_script:"trend-comparison-data" }}{% endif %}

<div class="p-6">
  <!-- Chart Header -->
  <div class="flex justify-between items-center mb-4">
    <div>
      <h2 class="text-lg font-semibold text-base-content">{{ metric_display }}</h2>
      <p class="text-sm text-base-content/60">
        {{ start_date|date:"M j, Y" }} - {{ end_date|date:"M j, Y" }}
        <span class="ml-2 badge badge-ghost badge-sm">{{ granularity }}</span>
        {% if is_multi_metric %}
        <span class="ml-1 badge badge-primary badge-sm">{% trans "Comparing" %}</span>
        {% endif %}
      </p>
    </div>
  </div>

  <!-- Chart Container (wide aspect ratio) -->
  <div class="relative w-full">
    <div style="height: 360px;">
      <canvas id="trend-chart"
              data-trend-chart
              data-metric="{{ metric }}"
              data-multi-metric="{{ is_multi_metric|yesno:'true,false' }}">
      </canvas>
    </div>
  </div>

</div>
