{% load i18n %}

{% if chart_data %}
<div class="space-y-4">
  {% regroup chart_data by category as category_list %}
  {% for category in category_list %}
  <div class="space-y-2">
    <!-- Category Header -->
    <div class="flex items-center gap-2 mb-2">
      {% if category.grouper == "code" %}
        <span class="badge badge-primary badge-sm">{% trans "Code AI" %}</span>
      {% elif category.grouper == "review" %}
        <span class="badge badge-secondary badge-sm">{% trans "Review AI" %}</span>
      {% else %}
        <span class="badge badge-ghost badge-sm">{% trans "Other" %}</span>
      {% endif %}
    </div>
    <!-- Tools in this category -->
    {% for item in category.list %}
    <div class="flex items-center gap-3">
      <div class="w-28 text-sm text-base-content/80 truncate" title="{{ item.tool }}">
        {% if item.tool == "claude_code" %}
          Claude Code
        {% elif item.tool == "claude" %}
          Claude
        {% elif item.tool == "copilot" %}
          GitHub Copilot
        {% elif item.tool == "cursor" %}
          Cursor
        {% elif item.tool == "cody" %}
          Sourcegraph Cody
        {% elif item.tool == "windsurf" %}
          Windsurf
        {% elif item.tool == "aider" %}
          Aider
        {% elif item.tool == "tabnine" %}
          Tabnine
        {% elif item.tool == "codewhisperer" %}
          CodeWhisperer
        {% elif item.tool == "amazon_q" %}
          Amazon Q
        {% elif item.tool == "ai_generic" %}
          Generic AI
        {% elif item.tool == "coderabbit" %}
          CodeRabbit
        {% elif item.tool == "cubic" %}
          Cubic
        {% elif item.tool == "greptile" %}
          Greptile
        {% elif item.tool == "sourcery" %}
          Sourcery
        {% elif item.tool == "devin" %}
          Devin
        {% elif item.tool == "chatgpt" %}
          ChatGPT
        {% elif item.tool == "gemini" %}
          Gemini
        {% else %}
          {{ item.tool }}
        {% endif %}
      </div>
      <div class="flex-1">
        {% if item.category == "code" %}
          <progress class="progress progress-primary w-full" value="{{ item.count }}" max="{{ chart_data.0.count }}"></progress>
        {% elif item.category == "review" %}
          <progress class="progress progress-secondary w-full" value="{{ item.count }}" max="{{ chart_data.0.count }}"></progress>
        {% else %}
          <progress class="progress w-full" value="{{ item.count }}" max="{{ chart_data.0.count }}"></progress>
        {% endif %}
      </div>
      <div class="w-12 text-right text-sm font-mono text-base-content">
        {{ item.count }}
      </div>
    </div>
    {% endfor %}
  </div>
  {% endfor %}
</div>
{% else %}
<div class="text-center text-base-content/60 py-8">
  <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto mb-3 opacity-40" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
  </svg>
  <p class="text-sm">{% trans "No AI tools detected in PRs yet" %}</p>
  <p class="text-xs mt-1">{% trans "AI signatures are detected from PR descriptions and commit messages" %}</p>
</div>
{% endif %}
