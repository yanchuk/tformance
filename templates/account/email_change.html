{% extends "account/base_manage_email.html" %}
{% load i18n %}
{% load allauth %}
{% load form_tags %}
{% block head_title %}
  {% trans "Email Address" %}
{% endblock head_title %}
{% block content %}
<div class="app-card">
  <h2 class="text-xl font-bold text-slate-100 mb-4">{% translate "Email Address" %}</h2>
  {% if not emailaddresses %}
    {% include "account/snippets/warn_no_email.html" %}
  {% endif %}
  {% url 'account_email' as action_url %}
  <form method="post" action="{{ action_url }}" class="space-y-4">
    {% csrf_token %}
    {% if current_emailaddress %}
      <div class="app-form-group">
        <label class="app-label" for="current_email">
          {% translate "Current email" %}
        </label>
        <input id="current_email" type="email" value="{{ current_emailaddress.email }}" disabled class="app-input opacity-70" />
      </div>
    {% endif %}
    {% if new_emailaddress %}
      <div class="app-form-group">
        <label class="app-label" for="new_email">
          {% if not current_emailaddress %}
            {% translate "Current email" %}
          {% else %}
            {% translate "Changing to" %}
          {% endif %}
        </label>
        <input id="new_email" type="email" value="{{ new_emailaddress.email }}" disabled class="app-input opacity-70" />
        <p class="app-helper">{% blocktranslate %}Your email address is still pending verification.{% endblocktranslate %}</p>
        <div class="flex gap-2 mt-2">
          <button form="pending-email" type="submit" name="action_send" class="app-btn-secondary app-btn-sm">
            {% trans 'Re-send Verification' %}
          </button>
          {% if current_emailaddress %}
            <button form="pending-email" type="submit" name="action_remove" class="app-btn-danger app-btn-sm">
              {% trans 'Cancel Change' %}
            </button>
          {% endif %}
        </div>
      </div>
    {% endif %}
    {% render_text_input form.email %}
    <div class="pt-2">
      <button name="action_add" type="submit" class="app-btn-primary">
        {% trans "Change Email" %}
      </button>
    </div>
  </form>
  {% if new_emailaddress %}
    <form style="display: none" id="pending-email" method="post" action="{% url 'account_email' %}">
      {% csrf_token %}
      <input type="hidden" name="email" value="{{ new_emailaddress.email }}">
    </form>
  {% endif %}
</div>
{% endblock content %}
