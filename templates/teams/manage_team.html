{% extends "web/app/app_base.html" %}
{% load static %}
{% load i18n %}
{% load form_tags %}
{% load django_vite %}
{% block page_head %}
  <style>
    /* Adds fade out effect when invitations are canceled */
    tr.htmx-swapping td {
      opacity: 0;
      transition: opacity 1s ease-out;
    }
  </style>
{% endblock %}
{% block app %}
<section class="app-card">
  <h3 class="pg-subtitle">
    {% translate "Team Details" %}
  </h3>
  <form method="post">
    {% csrf_token %}
    {% render_form_fields team_form %}
    {% if create or request.team_membership.role == 'admin' %}
      <div class="mt-2 pg-inline-buttons">
        <input class="btn btn-primary" type="submit" value="{% translate 'Save Details' %}">
      </div>
    {% endif %}
  </form>
  {% if not create %}
  <div class="mt-6 pt-4 border-t border-base-300">
    <h4 class="text-sm font-medium text-base-content/60 uppercase tracking-wide mb-4">{% translate "Account Information" %}</h4>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      <div class="flex items-center justify-between p-3 bg-base-200/50 rounded-lg border border-base-300">
        <div>
          <span class="text-xs font-medium text-base-content/60 uppercase tracking-wide">{% translate "Account ID" %}</span>
          <div class="font-mono text-sm text-base-content mt-1">{{ team.id }}</div>
        </div>
      </div>
      <div class="flex items-center justify-between p-3 bg-base-200/50 rounded-lg border border-base-300">
        <div>
          <span class="text-xs font-medium text-base-content/60 uppercase tracking-wide">{% translate "Account Slug" %}</span>
          <div class="font-mono text-sm text-base-content mt-1">{{ team.slug }}</div>
          <span class="text-xs text-base-content/50">{% translate "Used in URLs" %}</span>
        </div>
      </div>
    </div>
  </div>
  {% endif %}
</section>
{% if not create %}
<section class="app-card">
  <h3 class="pg-subtitle">{% translate "Team Members" %}</h3>
  <div class='table-responsive'>
    <table class="table pg-table">
      <thead>
      <tr>
        <th>{% translate "Member" %}</th>
        <th>{% translate "Role" %}</th>
      </tr>
      </thead>
      <tbody>
      {% for membership in team.sorted_memberships.all %}
        <tr>
          <td>
            {% if request.team_membership.is_admin or request.team_membership == membership %}
              <a class="link" href="{% url 'single_team:team_membership_details' membership.pk %}">{{ membership.user }}</a>
            {% else %}
              {{ membership.user }}
            {% endif %}
          </td>
          <td>{{ membership.get_role_display }}</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</section>
{% include 'teams/components/team_invitations.html' %}
{% if request.team_membership.role == 'admin' %}
  <section class="app-card">
    <h3 class="pg-subtitle text-error">
      {% translate "Danger Zone" %}
    </h3>
    <p class="text-base-content/70 mb-4">{% translate "Permanently delete this team and all associated data." %}</p>
    <label for="delete-modal" class="btn btn-error modal-button">{% translate 'Delete Team' %}</label>
  </section>
  {% include 'teams/components/delete_team_modal.html' %}
{% endif %}
{% endif %}
{% endblock %}
