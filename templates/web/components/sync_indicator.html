{% comment %}
Sync Indicator Widget Component
Shows a floating progress widget in the bottom-right when repositories are actively syncing.
A-009/A-010: Unified to use bottom-right widget pattern (consistent with onboarding).
A-023: Added HTMX polling for auto-updates during sync.

Required context:
- sync_in_progress: boolean indicating if any repos are syncing
- sync_progress_percent: overall sync progress percentage (0-100)
- repos_synced: number of repos that have completed syncing
- repos_total: total number of tracked repos
- repos_syncing: list of repo names currently syncing (optional)

Usage:
  {% include "web/components/sync_indicator.html" %}
{% endcomment %}
{% load i18n %}

{# Wrap in div for HTMX polling - A-023 #}
<div id="sync-indicator-wrapper"
     {% if sync_in_progress %}
     hx-get="{% url 'web_team:sync_indicator' %}"
     hx-trigger="every 3s"
     hx-swap="outerHTML"
     {% endif %}>
{% if sync_in_progress %}
<div id="sync-indicator"
     class="fixed bottom-4 right-4 z-50 animate-bounce-in"
     role="status"
     aria-live="polite">
  <div class="flex items-center gap-3 bg-base-200 border border-primary/30 rounded-lg px-4 py-3 shadow-lg">
    <div class="relative">
      <i class="fa-solid fa-sync fa-spin text-primary" aria-hidden="true"></i>
    </div>
    <div class="text-sm">
      <div class="font-medium text-base-content">{% trans "Syncing" %} {{ sync_progress_percent }}%</div>
      <div class="text-base-content/70">
        {{ repos_synced }} {% trans "of" %} {{ repos_total }} {% trans "repos" %}
        {% if repos_syncing and repos_syncing|length <= 2 %}
          ({% for repo in repos_syncing %}{{ repo|truncatechars:20 }}{% if not forloop.last %}, {% endif %}{% endfor %})
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endif %}
</div>
