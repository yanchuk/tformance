{% extends "onboarding/base.html" %}
{% load i18n %}

{% block onboarding_content %}
<div class="text-center">
  <div class="mb-8">
    <div class="w-20 h-20 bg-base-200 rounded-full flex items-center justify-center mx-auto mb-4 border border-base-300">
      <i class="fa-brands fa-github text-4xl text-base-content"></i>
    </div>
    {% if has_github_social %}
    <h1 class="text-3xl font-bold text-base-content mb-2">{% translate "Grant Repository Access" %}</h1>
    <p class="text-base-content/70 max-w-md mx-auto">
      {% translate "You signed in with GitHub. We need additional permissions to access your repositories and track engineering metrics." %}
    </p>
    {% else %}
    <h1 class="text-3xl font-bold text-base-content mb-2">{% translate "Connect Your GitHub Organization" %}</h1>
    <p class="text-base-content/70 max-w-md mx-auto">
      {% translate "We'll import your team from GitHub and start tracking engineering metrics. This only takes a minute." %}
    </p>
    {% endif %}
  </div>

  <div class="app-card max-w-md mx-auto">
    <h2 class="app-card-title text-center mb-4">{% translate "What we'll access and why:" %}</h2>
    <ul class="text-left space-y-4">
      <li class="flex items-start gap-3">
        <i class="fa-solid fa-users text-accent mt-1"></i>
        <div>
          <span class="text-base-content font-medium">{% translate "Organization members" %}</span>
          <p class="text-xs text-base-content/60 mt-0.5">{% translate "Auto-discover your team — no manual setup required" %}</p>
        </div>
      </li>
      <li class="flex items-start gap-3">
        <i class="fa-solid fa-code-pull-request text-accent mt-1"></i>
        <div>
          <span class="text-base-content font-medium">{% translate "Pull requests & reviews" %}</span>
          <p class="text-xs text-base-content/60 mt-0.5">{% translate "Track cycle time, review time, and throughput metrics" %}</p>
        </div>
      </li>
      <li class="flex items-start gap-3">
        <i class="fa-solid fa-robot text-accent mt-1"></i>
        <div>
          <span class="text-base-content font-medium">
            {% translate "Copilot usage metrics" %}
            <span class="text-base-content/50 text-sm">({% translate "coming soon" %})</span>
          </span>
          <p class="text-xs text-base-content/60 mt-0.5">{% translate "Correlate AI tool usage with delivery outcomes" %}</p>
        </div>
      </li>
    </ul>

    <div class="flex justify-center mt-6" x-data="{ loading: false }">
      <a href="{% url 'onboarding:github_connect' %}"
         @click="loading = true"
         class="app-btn-primary app-btn-lg gap-2"
         :class="{ 'opacity-75 cursor-wait': loading }">
        <i class="fa-brands fa-github" x-show="!loading"></i>
        <i class="fa-solid fa-spinner fa-spin" x-show="loading" x-cloak></i>
        <span x-show="!loading">{% if has_github_social %}{% translate "Grant Access" %}{% else %}{% translate "Connect GitHub" %}{% endif %}</span>
        <span x-show="loading" x-cloak>{% translate "Connecting..." %}</span>
      </a>
    </div>

    {# A-003: Privacy callout box with better visual emphasis #}
    <div class="mt-6 pt-4 border-t border-base-300">
      <div class="bg-accent/5 border border-accent/20 rounded-lg p-4 flex items-start gap-3">
        <i class="fa-solid fa-shield-halved text-accent text-xl mt-0.5"></i>
        <div class="text-left">
          <p class="text-sm font-medium text-base-content mb-1">{% translate "Privacy First" %}</p>
          <p class="text-xs text-base-content/70">
            {% translate "We never see your code — only PR metadata like titles, timestamps, and review counts." %}
          </p>
        </div>
      </div>
    </div>
  </div>

  {# Skip option for users who want to explore first #}
  <div class="mt-8 text-center">
    <a href="{% url 'onboarding:skip' %}" class="text-sm text-base-content/60 hover:text-base-content underline transition-colors">
      {% translate "Skip for now" %}
    </a>
    <p class="text-xs text-base-content/50 mt-1">
      {% translate "Create a team without GitHub — you can connect later from Integrations" %}
    </p>
  </div>
</div>
{% endblock %}
