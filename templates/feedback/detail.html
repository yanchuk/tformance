{% extends "web/app/app_base.html" %}
{% load static %}
{% load i18n %}

{% block app %}
<div class="space-y-6">
  <!-- Header -->
  <div class="flex items-center gap-4">
    <a href="{% url 'feedback:dashboard' %}" class="btn btn-ghost btn-sm">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
      </svg>
      {% trans "Back" %}
    </a>
    <h1 class="text-2xl font-bold text-base-content">{% trans "Feedback Detail" %}</h1>
  </div>

  <!-- Feedback Details -->
  <div class="card bg-base-200">
    <div class="card-body">
      <div class="flex justify-between items-start">
        <div>
          <span class="badge badge-lg {% if feedback.status == 'open' %}badge-warning{% elif feedback.status == 'resolved' %}badge-success{% else %}badge-info{% endif %}">
            {{ feedback.get_status_display }}
          </span>
          <h2 class="text-xl font-semibold mt-2">{{ feedback.get_category_display }}</h2>
        </div>
        {% if feedback.status != 'resolved' %}
        <form method="post" action="{% url 'feedback:resolve' pk=feedback.pk %}">
          {% csrf_token %}
          <button type="submit" class="btn btn-success btn-sm">{% trans "Mark Resolved" %}</button>
        </form>
        {% endif %}
      </div>

      {% if feedback.description %}
      <div class="mt-4">
        <h3 class="font-semibold text-base-content/80">{% trans "Description" %}</h3>
        <p class="mt-2 text-base-content">{{ feedback.description }}</p>
      </div>
      {% endif %}

      {% if feedback.pull_request %}
      <div class="mt-4">
        <h3 class="font-semibold text-base-content/80">{% trans "Pull Request" %}</h3>
        <p class="mt-2">{{ feedback.pull_request.title }}</p>
      </div>
      {% endif %}

      {% if feedback.file_path %}
      <div class="mt-4">
        <h3 class="font-semibold text-base-content/80">{% trans "File" %}</h3>
        <code class="mt-2 block bg-base-300 px-3 py-2 rounded">{{ feedback.file_path }}</code>
      </div>
      {% endif %}

      <div class="mt-6 pt-4 border-t border-base-300 text-sm text-base-content/70">
        <p>{% trans "Reported by" %}: {{ feedback.reported_by.display_name|default:"Unknown" }}</p>
        <p>{% trans "Created" %}: {{ feedback.created_at|date:"M d, Y H:i" }}</p>
        {% if feedback.resolved_at %}
        <p>{% trans "Resolved" %}: {{ feedback.resolved_at|date:"M d, Y H:i" }}</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
