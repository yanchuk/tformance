# Promptfoo config v3.0 - OpenAI Structure (Identity → Instructions → Examples)
# Run: npx promptfoo eval -c apps/metrics/prompts/insight_promptfoo_v3.yaml --no-cache

description: Dashboard Insight v3.0 (OpenAI + Anthropic Best Practices)

providers:
  - id: groq:openai/gpt-oss-20b
    label: GPT-OSS-20B
    config:
      temperature: 0.3
      max_tokens: 2000

  - id: groq:openai/gpt-oss-120b
    label: GPT-OSS-120B
    config:
      temperature: 0.3
      max_tokens: 2000

  - id: groq:llama-3.3-70b-versatile
    label: Llama-3.3-70B
    config:
      temperature: 0.3
      max_tokens: 2000

prompts:
  - id: v3.0-openai-structure
    raw: |-
      [
        {"role": "system", "content": "{{system_prompt}}"},
        {"role": "user", "content": "{{user_prompt}}"}
      ]

defaultTest:
  vars:
    system_prompt: |-
      # Identity

      You are an engineering metrics analyst helping CTOs understand their team's performance and make data-driven decisions.

      Your goal is to surface the single most important insight from the metrics data and provide an actionable recommendation.

      # Instructions

      ## Task

      Analyze the provided engineering metrics and generate an executive insight with:
      1. A headline addressing the most critical finding (based on priority rules)
      2. Detail providing context with specific numbers
      3. One actionable recommendation
      4. Four metric cards summarizing key indicators

      ## Priority Rules

      Check these conditions IN ORDER. Use the FIRST that matches, then STOP.

      1. **Quality Crisis**: revert_rate > 8%
         - Headline must address: reverts, quality concerns, stability
         - Why: Quality problems affect customers and indicate process failures

      2. **AI Impact (significant)**: ai_adoption >= 40% AND |cycle_time_difference| >= 25%
         - Headline must address: AI tool impact on velocity (positive or negative)
         - Why: At meaningful adoption with clear impact, CTOs need visibility into AI ROI

      3. **Severe Slowdown**: cycle_time_pct_change > 50%
         - Headline must address: cycle time increase, delivery delays
         - Why: Major slowdowns indicate systemic delivery issues

      4. **Major Throughput Change**: |throughput_pct_change| > 30%
         - Headline must address: throughput increase or decrease
         - Why: Significant output changes require investigation

      5. **Review Bottleneck**: bottleneck_detected = true
         - Headline must address: review delays, blocked work
         - Why: Bottlenecks slow the entire team

      6. **Bus Factor Risk**: team_size > 3 AND top_contributor_pct > 50%
         - Headline must address: work concentration, dependency risk
         - Why: Heavy reliance on one person creates continuity risk

      7. **General Summary**: None of the above apply
         - Headline must address: Most notable positive or negative trend

      ## Output Format

      Return a JSON object with exactly these fields:

      {
        "headline": "1-2 sentence executive summary based on highest priority",
        "detail": "2-3 sentences with key numbers and context",
        "recommendation": "One specific, actionable next step",
        "metric_cards": [
          {"label": "Throughput", "value": "% or count", "trend": "positive|negative|neutral|warning"},
          {"label": "Cycle Time", "value": "hours or %", "trend": "positive|negative|neutral|warning"},
          {"label": "AI Adoption", "value": "%", "trend": "positive|negative|neutral|warning"},
          {"label": "Quality", "value": "revert rate", "trend": "positive|negative|neutral|warning"}
        ]
      }

      Trend meanings: positive=good, negative=bad, neutral=stable, warning=needs attention

      CRITICAL OUTPUT RULES:
      - Start your response with the { character
      - End your response with the } character
      - No markdown code fences
      - No text before or after the JSON

      # Examples

      <example id="quality-crisis">
      <input>revert_rate: 12%, ai_adoption: 45%, ai_cycle_diff: -10%, throughput: +20%</input>
      <output>
      {
        "headline": "Quality alert: 12% of PRs were reverted this period, exceeding the 8% threshold.",
        "detail": "Despite 20% throughput growth and 45% AI adoption, the 12% revert rate indicates quality issues.",
        "recommendation": "Investigate reverted PRs for root causes.",
        "metric_cards": [
          {"label": "Throughput", "value": "+20%", "trend": "positive"},
          {"label": "Cycle Time", "value": "stable", "trend": "neutral"},
          {"label": "AI Adoption", "value": "45%", "trend": "positive"},
          {"label": "Quality", "value": "12% reverts", "trend": "warning"}
        ]
      }
      </output>
      <reasoning>Quality crisis (12% > 8%) takes priority over AI benefits.</reasoning>
      </example>

      <example id="bus-factor">
      <input>team_size: 5, top_contributor: 65%, revert_rate: 2%, ai_adoption: 25%</input>
      <output>
      {
        "headline": "Team dependency risk: One contributor owns 65% of merged PRs.",
        "detail": "Work concentration at 65% creates continuity risk. Quality healthy at 2% reverts.",
        "recommendation": "Distribute ownership through pair programming.",
        "metric_cards": [
          {"label": "Throughput", "value": "stable", "trend": "neutral"},
          {"label": "Cycle Time", "value": "-5%", "trend": "positive"},
          {"label": "AI Adoption", "value": "25%", "trend": "neutral"},
          {"label": "Team Health", "value": "65% concentration", "trend": "warning"}
        ]
      }
      </output>
      <reasoning>Bus factor (65% > 50%, team > 3) applies. AI below threshold.</reasoning>
      </example>

      <example id="ai-negative">
      <input>revert_rate: 3%, ai_adoption: 55%, ai_cycle_diff: +100%</input>
      <output>
      {
        "headline": "AI adoption concern: AI-assisted PRs take 100% longer than non-AI PRs.",
        "detail": "At 55% AI adoption, AI PRs average 48h vs 24h for non-AI PRs.",
        "recommendation": "Analyze AI PRs to understand complexity differences.",
        "metric_cards": [
          {"label": "Throughput", "value": "stable", "trend": "neutral"},
          {"label": "Cycle Time", "value": "+100% AI", "trend": "warning"},
          {"label": "AI Adoption", "value": "55%", "trend": "neutral"},
          {"label": "Quality", "value": "3% reverts", "trend": "positive"}
        ]
      }
      </output>
      <reasoning>AI impact significant (55% > 40%, 100% > 25%). Quality fine.</reasoning>
      </example>
  options:
    transform: "(() => { const m = output.match(/\\{\\s*\"headline\"/); return m ? output.slice(m.index).replace(/```[\\s\\S]*$/, '').trim() : output.slice(output.indexOf('{')).replace(/```[\\s\\S]*$/, '').trim(); })()"

tests:
  # ==========================================================================
  # PRIORITY 1: Quality Crisis
  # ==========================================================================
  - description: "[P1] Quality crisis 12% reverts - must address quality"
    vars:
      user_prompt: |-
        # Engineering Metrics Analysis for Acme Corp

        ## Period: 2024-12-01 to 2024-12-31 (30 days)

        ## Velocity Metrics

        ### Throughput
        - Current period: 100 PRs merged
        - Previous period: 83 PRs merged
        - Change: +20.5%

        ### Cycle Time (hours from PR open to merge)
        - Current period: 28.5 hours
        - Previous period: 29.2 hours
        - Change: -2.4% (negative = faster)

        ### Review Time (hours to first review)
        - Current period: 4.2 hours
        - Previous period: 4.8 hours
        - Change: -12.5% (negative = faster)

        ## Quality Metrics

        - Reverts: 12 (12.0% of merged PRs) [CRITICAL: Above 8% threshold]
        - Hotfixes: 3 (3.0% of merged PRs)
        - Average review rounds: 1.8
        - Large PRs (>500 lines): 8.0%

        ## Team Health

        - Active contributors: 8
        - Top contributor share: 18.0% of PRs
        - Work concentration: Healthy distribution
        - Avg reviews per reviewer: 12.5
        - Max reviews by single reviewer: 22
        - No review bottleneck detected

        ## AI Impact

        - AI-assisted PRs: 45 (45.0% adoption)
        - Non-AI PRs: 55
        - AI PR avg cycle time: 25.6 hours
        - Non-AI PR avg cycle time: 28.5 hours
        - AI HELPS: AI PRs are 10.2% FASTER than non-AI PRs

        ---

        Analyze these metrics and provide your insight.
    assert:
      - type: is-json
      - type: javascript
        value: "(() => { const r = JSON.parse(output); return r.headline && r.detail && r.recommendation && Array.isArray(r.metric_cards) && r.metric_cards.length === 4; })()"
        description: "Valid JSON structure with 4 metric cards"
      - type: javascript
        value: "(() => { const h = JSON.parse(output).headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('12'); })()"
        description: "P1: Headline addresses quality"

  - description: "[P1] Quality crisis 9% reverts"
    vars:
      user_prompt: |-
        # Engineering Metrics Analysis for Beta Inc

        ## Period: 2024-11-15 to 2024-12-15 (30 days)

        ## Velocity Metrics

        ### Throughput
        - Current period: 45 PRs merged
        - Previous period: 44 PRs merged
        - Change: +2.3%

        ### Cycle Time (hours from PR open to merge)
        - Current period: 18.2 hours
        - Previous period: 21.4 hours
        - Change: -15.0% (negative = faster)

        ### Review Time (hours to first review)
        - Current period: 3.1 hours
        - Previous period: 3.8 hours
        - Change: -18.4% (negative = faster)

        ## Quality Metrics

        - Reverts: 9 (9.0% of merged PRs) [CRITICAL: Above 8% threshold]
        - Hotfixes: 1 (2.2% of merged PRs)
        - Average review rounds: 1.5
        - Large PRs (>500 lines): 6.7%

        ## Team Health

        - Active contributors: 6
        - Top contributor share: 25.0% of PRs
        - Work concentration: Healthy distribution
        - Avg reviews per reviewer: 7.5
        - Max reviews by single reviewer: 14
        - No review bottleneck detected

        ## AI Impact

        - AI-assisted PRs: 14 (31.1% adoption)
        - Non-AI PRs: 31
        - AI PR avg cycle time: 17.8 hours
        - Non-AI PR avg cycle time: 18.4 hours
        - AI HELPS: AI PRs are 3.3% FASTER than non-AI PRs

        ---

        Analyze these metrics and provide your insight.
    assert:
      - type: is-json
      - type: javascript
        value: "(() => { const h = JSON.parse(output).headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('9'); })()"

  # ==========================================================================
  # PRIORITY 2: AI Impact
  # ==========================================================================
  - description: "[P2] AI positive - 70% adoption, 46% faster"
    vars:
      user_prompt: |-
        # Engineering Metrics Analysis for TechStartup

        ## Period: 2024-12-01 to 2024-12-31 (30 days)

        ## Velocity Metrics

        ### Throughput
        - Current period: 78 PRs merged
        - Previous period: 68 PRs merged
        - Change: +14.7%

        ### Cycle Time (hours from PR open to merge)
        - Current period: 16.2 hours
        - Previous period: 25.3 hours
        - Change: -36.0% (negative = faster)

        ### Review Time (hours to first review)
        - Current period: 2.8 hours
        - Previous period: 4.1 hours
        - Change: -31.7% (negative = faster)

        ## Quality Metrics

        - Reverts: 1 (1.3% of merged PRs)
        - Hotfixes: 2 (2.6% of merged PRs)
        - Average review rounds: 1.4
        - Large PRs (>500 lines): 5.1%

        ## Team Health

        - Active contributors: 12
        - Top contributor share: 20.0% of PRs
        - Work concentration: Healthy distribution
        - Avg reviews per reviewer: 6.5
        - Max reviews by single reviewer: 15
        - No review bottleneck detected

        ## AI Impact

        - AI-assisted PRs: 55 (70.5% adoption)
        - Non-AI PRs: 23
        - AI PR avg cycle time: 12.4 hours
        - Non-AI PR avg cycle time: 23.0 hours
        - AI HELPS: AI PRs are 46.1% FASTER than non-AI PRs

        ---

        Analyze these metrics and provide your insight.
    assert:
      - type: is-json
      - type: javascript
        value: "(() => { const h = JSON.parse(output).headline.toLowerCase(); return h.includes('ai') && (h.includes('fast') || h.includes('46') || h.includes('70') || h.includes('velocity') || h.includes('boost')); })()"
        description: "P2: AI positive impact"

  - description: "[P2] AI negative - 70% adoption, 100% slower"
    vars:
      user_prompt: |-
        # Engineering Metrics Analysis for SlowCorp

        ## Period: 2024-12-01 to 2024-12-31 (30 days)

        ## Velocity Metrics

        ### Throughput
        - Current period: 60 PRs merged
        - Previous period: 55 PRs merged
        - Change: +9.1%

        ### Cycle Time (hours from PR open to merge)
        - Current period: 40.5 hours
        - Previous period: 30.5 hours
        - Change: +32.8% (negative = faster)

        ### Review Time (hours to first review)
        - Current period: 8.2 hours
        - Previous period: 6.5 hours
        - Change: +26.2% (negative = faster)

        ## Quality Metrics

        - Reverts: 3 (5.0% of merged PRs)
        - Hotfixes: 2 (3.3% of merged PRs)
        - Average review rounds: 2.1
        - Large PRs (>500 lines): 12.0%

        ## Team Health

        - Active contributors: 10
        - Top contributor share: 22.0% of PRs
        - Work concentration: Healthy distribution
        - Avg reviews per reviewer: 6.0
        - Max reviews by single reviewer: 12
        - No review bottleneck detected

        ## AI Impact

        - AI-assisted PRs: 42 (70.0% adoption)
        - Non-AI PRs: 18
        - AI PR avg cycle time: 48.0 hours
        - Non-AI PR avg cycle time: 24.0 hours
        - AI HURTS: AI PRs are 100.0% SLOWER than non-AI PRs

        ---

        Analyze these metrics and provide your insight.
    assert:
      - type: is-json
      - type: javascript
        value: "(() => { const h = JSON.parse(output).headline.toLowerCase(); return h.includes('ai') && (h.includes('slow') || h.includes('100') || h.includes('twice') || h.includes('longer') || h.includes('concern')); })()"
        description: "P2: AI negative impact"

  # ==========================================================================
  # PRIORITY 3: Severe Slowdown
  # ==========================================================================
  - description: "[P3] Severe slowdown - 136% cycle time increase"
    vars:
      user_prompt: |-
        # Engineering Metrics Analysis for BigTech Enterprise

        ## Period: 2024-12-01 to 2024-12-31 (30 days)

        ## Velocity Metrics

        ### Throughput
        - Current period: 125 PRs merged
        - Previous period: 100 PRs merged
        - Change: +25.0%

        ### Cycle Time (hours from PR open to merge)
        - Current period: 169.2 hours
        - Previous period: 71.7 hours
        - Change: +136.0% (negative = faster) [SEVERE SLOWDOWN]

        ### Review Time (hours to first review)
        - Current period: 32.5 hours
        - Previous period: 12.8 hours
        - Change: +153.9% (negative = faster)

        ## Quality Metrics

        - Reverts: 1 (0.8% of merged PRs)
        - Hotfixes: 2 (1.6% of merged PRs)
        - Average review rounds: 2.8
        - Large PRs (>500 lines): 18.0%

        ## Team Health

        - Active contributors: 25
        - Top contributor share: 17.0% of PRs
        - Work concentration: Healthy distribution
        - Avg reviews per reviewer: 5.0
        - Max reviews by single reviewer: 18
        - No review bottleneck detected

        ## AI Impact

        - AI-assisted PRs: 43 (34.4% adoption)
        - Non-AI PRs: 82
        - AI PR avg cycle time: 155.0 hours
        - Non-AI PR avg cycle time: 176.5 hours
        - AI HELPS: AI PRs are 12.2% FASTER than non-AI PRs

        ---

        Analyze these metrics and provide your insight.
    assert:
      - type: is-json
      - type: javascript
        value: "(() => { const h = JSON.parse(output).headline.toLowerCase(); return h.includes('cycle') || h.includes('slow') || h.includes('136') || h.includes('delay'); })()"
        description: "P3: Addresses slowdown"

  # ==========================================================================
  # PRIORITY 4: Throughput Change
  # ==========================================================================
  - description: "[P4] Throughput surge +60%"
    vars:
      user_prompt: |-
        # Engineering Metrics Analysis for RocketShip Inc

        ## Period: 2024-12-01 to 2024-12-31 (30 days)

        ## Velocity Metrics

        ### Throughput
        - Current period: 72 PRs merged
        - Previous period: 45 PRs merged
        - Change: +60.0%

        ### Cycle Time (hours from PR open to merge)
        - Current period: 12.8 hours
        - Previous period: 29.8 hours
        - Change: -57.0% (negative = faster)

        ### Review Time (hours to first review)
        - Current period: 2.1 hours
        - Previous period: 5.2 hours
        - Change: -59.6% (negative = faster)

        ## Quality Metrics

        - Reverts: 2 (2.8% of merged PRs)
        - Hotfixes: 1 (1.4% of merged PRs)
        - Average review rounds: 1.3
        - Large PRs (>500 lines): 4.2%

        ## Team Health

        - Active contributors: 11
        - Top contributor share: 20.0% of PRs
        - Work concentration: Healthy distribution
        - Avg reviews per reviewer: 6.5
        - Max reviews by single reviewer: 14
        - No review bottleneck detected

        ## AI Impact

        - AI-assisted PRs: 30 (41.7% adoption)
        - Non-AI PRs: 42
        - AI PR avg cycle time: 10.8 hours
        - Non-AI PR avg cycle time: 14.0 hours
        - AI HELPS: AI PRs are 22.9% FASTER than non-AI PRs

        ---

        Analyze these metrics and provide your insight.
    assert:
      - type: is-json
      - type: javascript
        value: "(() => { const h = JSON.parse(output).headline.toLowerCase(); return h.includes('throughput') || h.includes('60') || h.includes('surge') || h.includes('increase') || h.includes('ai'); })()"

  - description: "[P4] Throughput drop -64%"
    vars:
      user_prompt: |-
        # Engineering Metrics Analysis for SmallTeam LLC

        ## Period: 2024-12-01 to 2024-12-31 (30 days)

        ## Velocity Metrics

        ### Throughput
        - Current period: 8 PRs merged
        - Previous period: 22 PRs merged
        - Change: -63.6%

        ### Cycle Time (hours from PR open to merge)
        - Current period: 18.5 hours
        - Previous period: 24.7 hours
        - Change: -25.1% (negative = faster)

        ### Review Time (hours to first review)
        - Current period: 3.2 hours
        - Previous period: 4.8 hours
        - Change: -33.3% (negative = faster)

        ## Quality Metrics

        - Reverts: 0 (0.0% of merged PRs)
        - Hotfixes: 0 (0.0% of merged PRs)
        - Average review rounds: 1.2
        - Large PRs (>500 lines): 0.0%

        ## Team Health

        - Active contributors: 3
        - Top contributor share: 50.0% of PRs
        - Work concentration: Healthy distribution
        - Avg reviews per reviewer: 2.7
        - Max reviews by single reviewer: 4
        - No review bottleneck detected

        ## AI Impact

        - AI-assisted PRs: 3 (37.5% adoption)
        - Non-AI PRs: 5
        - AI PR avg cycle time: 16.2 hours
        - Non-AI PR avg cycle time: 19.9 hours
        - AI HELPS: AI PRs are 18.6% FASTER than non-AI PRs

        ---

        Analyze these metrics and provide your insight.
    assert:
      - type: is-json
      - type: javascript
        value: "(() => { const h = JSON.parse(output).headline.toLowerCase(); return h.includes('throughput') || h.includes('64') || h.includes('drop') || h.includes('decline'); })()"

  # ==========================================================================
  # PRIORITY 6: Bus Factor
  # ==========================================================================
  - description: "[P6] Bus factor - 65% concentration on team of 5"
    vars:
      user_prompt: |-
        # Engineering Metrics Analysis for FocusedTeam Co

        ## Period: 2024-12-01 to 2024-12-31 (30 days)

        ## Velocity Metrics

        ### Throughput
        - Current period: 40 PRs merged
        - Previous period: 35 PRs merged
        - Change: +14.3%

        ### Cycle Time (hours from PR open to merge)
        - Current period: 15.2 hours
        - Previous period: 16.5 hours
        - Change: -7.9% (negative = faster)

        ### Review Time (hours to first review)
        - Current period: 2.8 hours
        - Previous period: 3.2 hours
        - Change: -12.5% (negative = faster)

        ## Quality Metrics

        - Reverts: 0 (0.0% of merged PRs)
        - Hotfixes: 1 (2.5% of merged PRs)
        - Average review rounds: 1.4
        - Large PRs (>500 lines): 7.5%

        ## Team Health

        - Active contributors: 5
        - Top contributor share: 65.0% of PRs [BUS FACTOR RISK: >50% on team >3]
        - Work concentration: High risk
        - Avg reviews per reviewer: 8.0
        - Max reviews by single reviewer: 28
        - No review bottleneck detected

        ## AI Impact

        - AI-assisted PRs: 10 (25.0% adoption)
        - Non-AI PRs: 30
        - AI PR avg cycle time: 13.4 hours
        - Non-AI PR avg cycle time: 15.8 hours
        - AI HELPS: AI PRs are 15.2% FASTER than non-AI PRs

        ---

        Analyze these metrics and provide your insight.
    assert:
      - type: is-json
      - type: javascript
        value: "(() => { const h = JSON.parse(output).headline.toLowerCase(); return h.includes('65') || h.includes('concentration') || h.includes('contributor') || h.includes('dependency') || h.includes('risk') || h.includes('bus'); })()"
        description: "P6: Bus factor risk"

  # ==========================================================================
  # CONFLICT: Quality vs AI (Quality must win)
  # ==========================================================================
  - description: "[CONFLICT] Quality 12% beats AI 45% positive"
    vars:
      user_prompt: |-
        # Engineering Metrics Analysis for ConflictTest Corp

        ## Period: 2024-12-01 to 2024-12-31 (30 days)

        ## Velocity Metrics

        ### Throughput
        - Current period: 90 PRs merged
        - Previous period: 81 PRs merged
        - Change: +11.1%

        ### Cycle Time (hours from PR open to merge)
        - Current period: 22.4 hours
        - Previous period: 24.6 hours
        - Change: -8.9% (negative = faster)

        ### Review Time (hours to first review)
        - Current period: 3.5 hours
        - Previous period: 4.0 hours
        - Change: -12.5% (negative = faster)

        ## Quality Metrics

        - Reverts: 12 (12.0% of merged PRs) [CRITICAL: Above 8% threshold]
        - Hotfixes: 4 (4.4% of merged PRs)
        - Average review rounds: 1.9
        - Large PRs (>500 lines): 11.0%

        ## Team Health

        - Active contributors: 15
        - Top contributor share: 18.0% of PRs
        - Work concentration: Healthy distribution
        - Avg reviews per reviewer: 6.0
        - Max reviews by single reviewer: 16
        - No review bottleneck detected

        ## AI Impact

        - AI-assisted PRs: 41 (45.6% adoption)
        - Non-AI PRs: 49
        - AI PR avg cycle time: 20.5 hours
        - Non-AI PR avg cycle time: 22.8 hours
        - AI HELPS: AI PRs are 10.1% FASTER than non-AI PRs

        ---

        Analyze these metrics and provide your insight.
    assert:
      - type: is-json
      - type: javascript
        value: "(() => { const h = JSON.parse(output).headline.toLowerCase(); return h.includes('revert') || h.includes('quality') || h.includes('12'); })()"
        description: "Quality (P1) beats AI (P2)"

  # ==========================================================================
  # EDGE: All healthy
  # ==========================================================================
  - description: "[EDGE] All metrics healthy - general summary"
    vars:
      user_prompt: |-
        # Engineering Metrics Analysis for HealthyTeam Inc

        ## Period: 2024-12-01 to 2024-12-31 (30 days)

        ## Velocity Metrics

        ### Throughput
        - Current period: 54 PRs merged
        - Previous period: 50 PRs merged
        - Change: +8.0%

        ### Cycle Time (hours from PR open to merge)
        - Current period: 22.0 hours
        - Previous period: 23.2 hours
        - Change: -5.2% (negative = faster)

        ### Review Time (hours to first review)
        - Current period: 3.8 hours
        - Previous period: 4.1 hours
        - Change: -7.3% (negative = faster)

        ## Quality Metrics

        - Reverts: 1 (1.9% of merged PRs)
        - Hotfixes: 1 (1.9% of merged PRs)
        - Average review rounds: 1.5
        - Large PRs (>500 lines): 5.6%

        ## Team Health

        - Active contributors: 10
        - Top contributor share: 18.0% of PRs
        - Work concentration: Healthy distribution
        - Avg reviews per reviewer: 5.4
        - Max reviews by single reviewer: 12
        - No review bottleneck detected

        ## AI Impact

        - AI-assisted PRs: 16 (29.6% adoption)
        - Non-AI PRs: 38
        - AI PR avg cycle time: 20.4 hours
        - Non-AI PR avg cycle time: 22.2 hours
        - AI HELPS: AI PRs are 8.1% FASTER than non-AI PRs

        ---

        Analyze these metrics and provide your insight.
    assert:
      - type: is-json
      - type: javascript
        value: "(() => { const r = JSON.parse(output); return r.headline && r.detail && r.recommendation && Array.isArray(r.metric_cards) && r.metric_cards.length === 4; })()"
        description: "Valid response with 4 metric cards"

outputPath: ./results/insight-promptfoo-v3-results.json

evaluateOptions:
  maxConcurrency: 3
  showProgressBar: true
