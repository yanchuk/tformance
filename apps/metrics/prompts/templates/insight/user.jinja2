# Engineering Metrics Analysis for {{ metadata.team_name }}
# Period: {{ metadata.start_date }} to {{ metadata.end_date }} ({{ metadata.days }} days)

---

## PRE-COMPUTED METRIC CARDS (USE THESE EXACT VALUES)

You MUST use these exact values for metric_cards. Do NOT recalculate.

{% set throughput_change = velocity.throughput.pct_change %}
{% set cycle_time_change = velocity.cycle_time.pct_change %}
{% set ai_adoption = ai_impact.ai_adoption_pct %}
{% set revert_rate = quality.revert_rate %}

1. **Throughput**
   - value: "{% if throughput_change is not none %}{{ "%+.1f"|format(throughput_change) }}%{% else %}{{ velocity.throughput.current }} PRs{% endif %}"
   - trend: {% if throughput_change is not none %}{% if throughput_change > 10 %}"positive"{% elif throughput_change < -10 %}"negative"{% else %}"neutral"{% endif %}{% else %}"neutral"{% endif %}

2. **Cycle Time**
   - value: "{% if cycle_time_change is not none %}{{ "%+.1f"|format(cycle_time_change) }}%{% elif velocity.cycle_time.current is not none %}{{ "%.1f"|format(velocity.cycle_time.current) }}h{% else %}N/A{% endif %}"
   - trend: {% if cycle_time_change is not none %}{% if cycle_time_change < -10 %}"positive"{% elif cycle_time_change > 20 %}"negative"{% elif cycle_time_change > 10 %}"warning"{% else %}"neutral"{% endif %}{% else %}"neutral"{% endif %}

3. **AI Adoption**
   - value: "{{ "%.1f"|format(ai_adoption) }}%"
   - trend: {% if ai_adoption >= 40 %}"positive"{% elif ai_adoption >= 20 %}"neutral"{% else %}"warning"{% endif %}

4. **Quality**
   - value: "{{ "%.1f"|format(revert_rate) }}% reverts"
   - trend: {% if revert_rate <= 2 %}"positive"{% elif revert_rate <= 5 %}"warning"{% else %}"negative"{% endif %}

---

## RAW METRICS DATA

### Velocity

**Throughput (PRs merged)**
- Current: {{ velocity.throughput.current }} PRs
- Previous: {{ velocity.throughput.previous }} PRs
- Change: {% if velocity.throughput.pct_change is not none %}{{ "%.1f"|format(velocity.throughput.pct_change) }}%{% else %}N/A{% endif %}

**Cycle Time (hours from PR open to merge)**
- Current: {% if velocity.cycle_time.current is not none %}{{ "%.1f"|format(velocity.cycle_time.current) }}h{% else %}N/A{% endif %}
- Previous: {% if velocity.cycle_time.previous is not none %}{{ "%.1f"|format(velocity.cycle_time.previous) }}h{% else %}N/A{% endif %}
- Change: {% if velocity.cycle_time.pct_change is not none %}{{ "%.1f"|format(velocity.cycle_time.pct_change) }}% (positive = slower){% else %}N/A{% endif %}

**Review Time (hours to first review)**
- Current: {% if velocity.review_time.current is not none %}{{ "%.1f"|format(velocity.review_time.current) }}h{% else %}N/A{% endif %}
- Previous: {% if velocity.review_time.previous is not none %}{{ "%.1f"|format(velocity.review_time.previous) }}h{% else %}N/A{% endif %}
- Change: {% if velocity.review_time.pct_change is not none %}{{ "%.1f"|format(velocity.review_time.pct_change) }}%{% else %}N/A{% endif %}

### Quality

- Reverts: {{ quality.revert_count }} ({{ "%.1f"|format(quality.revert_rate) }}% rate) {% if quality.revert_rate > 5 %}‚ö†Ô∏è ABOVE THRESHOLD{% endif %}
- Hotfixes: {{ quality.hotfix_count }} ({{ "%.1f"|format(quality.hotfix_rate) }}% rate)
- Avg review rounds: {% if quality.avg_review_rounds is not none %}{{ "%.1f"|format(quality.avg_review_rounds) }}{% else %}N/A{% endif %}
- Large PRs (>500 lines): {{ "%.1f"|format(quality.large_pr_pct) }}% {% if quality.large_pr_pct > 30 %}‚ö†Ô∏è HIGH{% endif %}

### Team Health

- Active contributors: {{ team_health.active_contributors }}
- Top contributor share: {{ "%.1f"|format(team_health.pr_distribution.top_contributor_pct) }}% {% if team_health.pr_distribution.top_contributor_pct > 50 %}‚ö†Ô∏è BUS FACTOR RISK{% endif %}
- Work concentration: {{ "HIGH RISK" if team_health.pr_distribution.is_concentrated else "Healthy" }}
{% if team_health.review_distribution.avg_reviews_per_reviewer is not none %}
- Avg reviews per reviewer: {{ "%.1f"|format(team_health.review_distribution.avg_reviews_per_reviewer) }}
{% endif %}
- Max reviews (single person): {{ team_health.review_distribution.max_reviews }}
{% if team_health.bottleneck %}
- ‚ö†Ô∏è BOTTLENECK: {{ team_health.bottleneck.reviewer_name }} has {{ team_health.bottleneck.pending_count }} pending reviews (team avg: {{ team_health.bottleneck.team_avg }})
{% else %}
- No review bottleneck detected
{% endif %}

### AI Impact

- AI-assisted PRs: {{ ai_impact.ai_pr_count }} ({{ "%.1f"|format(ai_impact.ai_adoption_pct) }}% adoption)
- Non-AI PRs: {{ ai_impact.non_ai_pr_count }}
{% if ai_impact.ai_avg_cycle_time is not none and ai_impact.non_ai_avg_cycle_time is not none %}
- AI PR cycle time: {{ "%.1f"|format(ai_impact.ai_avg_cycle_time) }}h
- Non-AI PR cycle time: {{ "%.1f"|format(ai_impact.non_ai_avg_cycle_time) }}h
{% set ai_diff_pct = ((ai_impact.ai_avg_cycle_time - ai_impact.non_ai_avg_cycle_time) / ai_impact.non_ai_avg_cycle_time * 100) if ai_impact.non_ai_avg_cycle_time > 0 else 0 %}
{% if ai_diff_pct < -10 %}
- ‚úÖ AI HELPS: AI PRs are {{ "%.1f"|format(ai_diff_pct|abs) }}% FASTER
{% elif ai_diff_pct > 10 %}
- ‚ö†Ô∏è AI HURTS: AI PRs are {{ "%.1f"|format(ai_diff_pct) }}% SLOWER
{% else %}
- AI PRs have similar cycle time to non-AI PRs
{% endif %}
{% endif %}

---

## BENCHMARK CONTEXT

| Metric | Current | Benchmark | Status |
|--------|---------|-----------|--------|
| Cycle Time | {% if velocity.cycle_time.current is not none %}{{ "%.0f"|format(velocity.cycle_time.current) }}h{% else %}N/A{% endif %} | <48h healthy, >120h critical | {% if velocity.cycle_time.current is not none %}{% if velocity.cycle_time.current < 48 %}‚úÖ Healthy{% elif velocity.cycle_time.current < 120 %}‚ö†Ô∏è Warning{% else %}üî¥ Critical{% endif %}{% else %}N/A{% endif %} |
| Revert Rate | {{ "%.1f"|format(quality.revert_rate) }}% | <2% healthy, >5% critical | {% if quality.revert_rate < 2 %}‚úÖ Healthy{% elif quality.revert_rate < 5 %}‚ö†Ô∏è Warning{% else %}üî¥ Critical{% endif %} |
| AI Adoption | {{ "%.0f"|format(ai_impact.ai_adoption_pct) }}% | >40% healthy, <20% low | {% if ai_impact.ai_adoption_pct >= 40 %}‚úÖ Healthy{% elif ai_impact.ai_adoption_pct >= 20 %}‚ö†Ô∏è Moderate{% else %}üìä Low{% endif %} |
| Top Contributor | {{ "%.0f"|format(team_health.pr_distribution.top_contributor_pct) }}% | <30% healthy, >50% risk | {% if team_health.pr_distribution.top_contributor_pct < 30 %}‚úÖ Healthy{% elif team_health.pr_distribution.top_contributor_pct < 50 %}‚ö†Ô∏è Warning{% else %}üî¥ Bus Factor{% endif %} |

---

## YOUR TASK

Based on this data:
1. Write a headline identifying the MOST SIGNIFICANT issue (use priority order from system prompt)
2. Provide 2-3 sentences of detail with SPECIFIC numbers from the data
3. List 1-2 possible causes (hypothesize WHY based on data patterns)
4. Give ONE actionable recommendation that addresses an issue from your detail
5. Use the PRE-COMPUTED METRIC CARDS exactly as shown above
6. Select 1-3 actions that match the issues you discussed
